import{r as g,j as e,$ as M,Y as p}from"./app-DDOxwmA9.js";import{B as n}from"./button-pFfP4m4I.js";import{C as x,a as d,b as S,c as T}from"./card-CUJ6-_Nq.js";import{B as h}from"./badge-Bwee8h8x.js";import{I as L}from"./input-8UcNh2NX.js";import{A as k,C as w,X as U}from"./app-layout-CGCqwk4U.js";import{M as $}from"./mail-CPbl48if.js";import{M as y}from"./message-circle-BRHGSQ96.js";import{C as f}from"./clock-v5XTTl4t.js";import{C as b}from"./circle-check-big-yt5gleS_.js";import{T as z}from"./workflow-5bgfWcbK.js";import{S as B}from"./search-CZ5GElVz.js";import{F}from"./filter-CxpDqdXx.js";import{U as D}from"./user-D6gISc9j.js";import{C as E}from"./calendar-BoTz84l-.js";import{E as I}from"./eye-BQCut4rY.js";import"./index-B8TENVID.js";import"./index-ZOo0SAp5.js";import"./video-Ra3jV7c9.js";function re({conversations:t,stats:i}){const[c,u]=g.useState(""),[l,o]=g.useState("all"),[j,v]=g.useState(t.data);g.useEffect(()=>{let s=t.data;l!=="all"&&(s=s.filter(a=>a.status===l)),c&&(s=s.filter(a=>{var m;return a.user.name.toLowerCase().includes(c.toLowerCase())||a.user.email.toLowerCase().includes(c.toLowerCase())||((m=a.latest_message)==null?void 0:m.message.toLowerCase().includes(c.toLowerCase()))})),v(s)},[c,l,t.data]);const C=(s,a=0)=>{const m=a>0;switch(s){case"waiting":return e.jsxs(h,{className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Waiting ",m&&e.jsx("span",{className:"ml-1 bg-yellow-600 text-white rounded-full px-1 text-xs",children:a})]});case"active":return e.jsxs(h,{className:"bg-green-100 text-green-800 border-green-300",children:[e.jsx(b,{className:"w-3 h-3 mr-1"}),"Active ",m&&e.jsx("span",{className:"ml-1 bg-green-600 text-white rounded-full px-1 text-xs",children:a})]});case"closed":return e.jsxs(h,{className:"bg-gray-100 text-gray-800 border-gray-300",children:[e.jsx(w,{className:"w-3 h-3 mr-1"}),"Closed"]});default:return e.jsx(h,{className:"bg-gray-100 text-gray-800",children:"Unknown"})}},N=s=>{const a=new Date(s),r=Math.floor((new Date().getTime()-a.getTime())/(1e3*60));return r<1?"Just now":r<60?`${r}m ago`:r<1440?`${Math.floor(r/60)}h ago`:`${Math.floor(r/1440)}d ago`},_=s=>{if(s.status==="waiting"){const a=new Date(s.created_at),r=(new Date().getTime()-a.getTime())/(1e3*60);if(r>30)return"high";if(r>15)return"medium"}return"normal"},A=[{title:"Admin",href:"/admin"},{title:"Chat Management",href:"/admin/chat"}];return e.jsxs(k,{breadcrumbs:A,children:[e.jsx(M,{title:"Chat Management - Admin Dashboard"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Chat Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage customer conversations and support requests"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(p,{href:route("admin.contact-messages.index"),children:e.jsxs(n,{variant:"outline",children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Contact Forms"]})}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Live"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[e.jsx(x,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(y,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:i.total}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Total Chats"})]})]})})}),e.jsx(x,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"w-8 h-8 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:i.waiting}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Waiting"})]})]})})}),e.jsx(x,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(b,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-green-600",children:i.active}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Active"})]})]})})}),e.jsx(x,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:"w-8 h-8 text-gray-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-600",children:i.closed}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Closed"})]})]})})}),e.jsx(x,{children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:i.unread_messages}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Unread"})]})]})})})]}),e.jsx(x,{className:"mb-6",children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(B,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx(L,{type:"text",placeholder:"Search conversations by user name, email, or message...",value:c,onChange:s=>u(s.target.value),className:"pl-10"})]})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Filter:"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{variant:l==="all"?"default":"outline",size:"sm",onClick:()=>o("all"),children:"All"}),e.jsxs(n,{variant:l==="waiting"?"default":"outline",size:"sm",onClick:()=>o("waiting"),className:l==="waiting"?"bg-yellow-600 hover:bg-yellow-700":"",children:["Waiting (",i.waiting,")"]}),e.jsxs(n,{variant:l==="active"?"default":"outline",size:"sm",onClick:()=>o("active"),className:l==="active"?"bg-green-600 hover:bg-green-700":"",children:["Active (",i.active,")"]}),e.jsxs(n,{variant:l==="closed"?"default":"outline",size:"sm",onClick:()=>o("closed"),className:l==="closed"?"bg-gray-600 hover:bg-gray-700":"",children:["Closed (",i.closed,")"]})]})]})]})})}),e.jsxs(x,{children:[e.jsx(S,{children:e.jsxs(T,{className:"flex items-center justify-between",children:[e.jsxs("span",{children:["Recent Conversations (",j.length,")"]}),c&&e.jsxs(n,{variant:"outline",size:"sm",onClick:()=>u(""),children:[e.jsx(U,{className:"w-4 h-4 mr-1"}),"Clear Search"]})]})}),e.jsx(d,{className:"p-0",children:j.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(y,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No conversations found"}),e.jsx("p",{className:"text-gray-600",children:c?"Try adjusting your search terms.":"No conversations match the current filter."})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:j.map(s=>{const a=_(s);return e.jsx("div",{className:`p-6 hover:bg-gray-50 transition-colors ${a==="high"?"border-l-4 border-red-500":a==="medium"?"border-l-4 border-yellow-500":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start space-x-4 flex-1",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(D,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:s.user.name}),e.jsx("span",{className:"text-xs text-gray-500",children:s.user.email}),C(s.status,s.unread_count_admin),a==="high"&&e.jsx(h,{className:"bg-red-100 text-red-800 border-red-300",children:"Urgent"})]}),s.latest_message&&e.jsxs("p",{className:"text-sm text-gray-600 truncate mb-2",children:[e.jsx("span",{className:s.latest_message.is_from_admin?"text-blue-600":"text-gray-900",children:s.latest_message.is_from_admin?"You: ":`${s.user.name}: `}),s.latest_message.message]}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(E,{className:"w-3 h-3 mr-1"}),"Started ",N(s.created_at)]}),s.last_message_at&&e.jsxs("div",{className:"flex items-center",children:[e.jsx(f,{className:"w-3 h-3 mr-1"}),"Last message ",N(s.last_message_at)]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx(p,{href:route("admin.chat.show",s.id),children:e.jsxs(n,{size:"sm",className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(I,{className:"w-4 h-4 mr-1"}),"View Chat"]})})})]})},s.id)})})})]}),t.last_page>1&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",(t.current_page-1)*t.per_page+1," to"," ",Math.min(t.current_page*t.per_page,t.total)," of"," ",t.total," conversations"]})})]})})]})}export{re as default};
