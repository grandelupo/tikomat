import{r as c,v as le,U as ie,j as e,$ as re,Y as C}from"./app-DkyWTAKM.js";import{B as _}from"./button-CiB1Kpt8.js";import{C as oe,b as ne,c as ce,d as de,a as me}from"./card-DbEI82VD.js";import{I as f}from"./input-CCQ7Owxa.js";import{L as n}from"./label-CGTITAes.js";import{T as he}from"./textarea--SI9NrAo.js";import{C as xe}from"./checkbox-RhszlX_R.js";import{R as pe,a as O}from"./radio-group-C-W2DXSO.js";import{A as k,a as w}from"./alert-CuoqG9fa.js";import{A as ue,I as fe}from"./app-layout-DuHAWXYQ.js";import{X as ge}from"./x-Dp3L2zWy.js";import{A as be}from"./arrow-left-BXzDlRBe.js";import{U as je}from"./upload-BDOr61k4.js";import{P as ve,C as Ne}from"./palette-urSGQu77.js";import{F as M}from"./facebook-Cb8whP9Y.js";import{V as ye}from"./video-D8MjNgTw.js";import{I as Ce}from"./instagram-DUihK-Oa.js";import{Y as _e}from"./youtube-LyPFKR1F.js";import{C as ke}from"./clock-Dac4ea4b.js";import{C as we}from"./calendar-CpophRGJ.js";import"./index-C-rVVtQs.js";import"./index-BTees833.js";import"./index-BAlBLnhZ.js";import"./settings-BLI_geGP.js";import"./circle-check-big-CNG-IyiF.js";import"./badge-uDMROM0K.js";const De={youtube:{name:"YouTube",icon:_e,color:"text-red-600"},instagram:{name:"Instagram",icon:Ce,color:"text-pink-600"},tiktok:{name:"TikTok",icon:ye,color:"text-black"},facebook:{name:"Facebook",icon:M,color:"text-blue-600"},snapchat:{name:"Snapchat",icon:Ne,color:"text-yellow-500"},pinterest:{name:"Pinterest",icon:ve,color:"text-red-500"},x:{name:"X",icon:ge,color:"text-black"}};function es({channel:d,availablePlatforms:p,defaultPlatforms:D,connectedPlatforms:F,allowedPlatforms:g,facebookPages:P}){var U,V;const A=Array.isArray(p)?p:[],T=Array.isArray(D)?D:[],E=Array.isArray(F)?F:[],Y=Array.isArray(g)?g:[],u=Array.isArray(P)?P:[],[h,L]=c.useState(T),[b,B]=c.useState("now"),[j,v]=c.useState(!1);c.useRef(null);const[i,S]=c.useState({}),[x,R]=c.useState(((U=u.find(s=>s.is_current_channel))==null?void 0:U.page_id)||((V=u[0])==null?void 0:V.page_id)||""),z=[{title:"My channels",href:"/dashboard"},{title:d.name,href:`/channels/${d.slug}`},{title:"Upload Video",href:`/channels/${d.slug}/videos/create`}],{data:l,setData:o,post:W,processing:I,errors:r,progress:N}=le({video:null,title:"",description:"",tags:[],platforms:T,publish_type:"now",publish_at:"",advanced_options:{},facebook_page_id:x});ie.useEffect(()=>{o("facebook_page_id",x)},[x,o]);const X=(s,t)=>{let a;t?a=[...h,s]:a=h.filter(m=>m!==s),L(a),o("platforms",a)},$=s=>{R(s),o("facebook_page_id",s)},G=s=>{B(s),o("publish_type",s),s==="now"&&o("publish_at","")},q=s=>{s.preventDefault(),S({}),ee()&&W(`/channels/${d.slug}/videos`)},H=s=>{var a;const t=(a=s.target.files)==null?void 0:a[0];t&&o("video",t)},J=c.useCallback(s=>{s.preventDefault(),v(!1);const t=s.dataTransfer.files;if(t&&t[0]){const a=t[0];a.type.startsWith("video/")?o("video",a):alert("Please select a valid video file")}},[o]),Q=c.useCallback(s=>{s.preventDefault(),v(!0)},[]),Z=c.useCallback(s=>{s.preventDefault(),v(!1)},[]),K=s=>s.size>100*1024*1024?"File size must be less than 100MB":s.type.startsWith("video/")?null:"Please select a valid video file",ee=()=>{const s={};if(l.title.trim()?l.title.length>255&&(s.title="Title must be less than 255 characters"):s.title="Title is required",l.description&&l.description.length>1e3&&(s.description="Description must be less than 1000 characters"),h.length===0&&(s.platforms="Please select at least one platform"),h.includes("facebook")&&!x&&(s.facebook_page_id="Please select a Facebook page"),b==="scheduled")if(!l.publish_at)s.publish_at="Please select a publish date and time";else{const t=new Date(l.publish_at),a=new Date,m=new Date(a.getTime()+5*6e4);t<=m&&(s.publish_at="Publish date must be at least 5 minutes from now")}if(!l.video)s.video="Please select a video file";else{const t=K(l.video);t&&(s.video=t)}return S(s),Object.keys(s).length===0};return e.jsxs(ue,{breadcrumbs:z,children:[e.jsx(re,{title:"Upload Video"}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold tracking-tight",children:["Upload Video to ",d.name]}),e.jsx("p",{className:"text-muted-foreground",children:"Upload a video to publish across your connected social media platforms"})]}),e.jsx(C,{href:`/channels/${d.slug}`,children:e.jsxs(_,{variant:"outline",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Back to Channel"]})})]}),p.length===0&&e.jsxs(k,{className:"bg-yellow-50 border-yellow-200",children:[e.jsx(fe,{className:"h-4 w-4 text-yellow-600"}),e.jsxs(w,{className:"text-yellow-800",children:[e.jsx("strong",{children:"No connected platforms:"})," You need to connect at least one social media platform to this channel before uploading videos.",e.jsx(C,{href:`/channels/${d.slug}`,className:"ml-1 underline",children:"Connect platforms now"})]})]}),g.length===1&&e.jsx(k,{className:"bg-blue-950/20 border-blue-800",children:e.jsxs(w,{className:"text-blue-200",children:[e.jsx("strong",{children:"Free Plan:"})," You currently have access to YouTube only. Upgrade to Pro to unlock Instagram and TikTok publishing."]})}),e.jsxs(oe,{className:"max-w-2xl",children:[e.jsxs(ne,{children:[e.jsx(ce,{children:"Video Details"}),e.jsx(de,{children:"Upload your video file and provide details for publishing"})]}),e.jsx(me,{children:e.jsxs("form",{onSubmit:q,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"video",children:"Video File"}),e.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center transition-colors ${j?"border-blue-400 bg-blue-950/20":"border-gray-300 hover:border-gray-400"}`,onDrop:J,onDragOver:Q,onDragLeave:Z,children:[e.jsx(je,{className:`mx-auto h-12 w-12 ${j?"text-blue-500":"text-gray-400"}`}),e.jsxs("div",{className:"mt-4",children:[e.jsxs(n,{htmlFor:"video",className:"cursor-pointer",children:[e.jsx("span",{className:"mt-2 block text-sm font-medium text-gray-900",children:j?"Drop your video here":"Click to upload or drag and drop"}),e.jsx("span",{className:"mt-1 block text-xs text-gray-500",children:"MP4, MOV, AVI, WMV, WebM up to 100MB (max 60 seconds)"})]}),e.jsx(f,{id:"video",type:"file",accept:"video/*",onChange:H,className:"hidden"})]})]}),l.video&&e.jsxs("div",{className:"text-sm text-green-600 bg-green-50 p-2 rounded border border-green-200",children:[e.jsx("strong",{children:"Selected:"})," ",l.video.name," (",(l.video.size/(1024*1024)).toFixed(2)," MB)"]}),(r.video||i.video)&&e.jsx("p",{className:"text-sm text-red-600",children:r.video||i.video}),N&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Uploading..."}),e.jsxs("span",{children:[N.percentage,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${N.percentage}%`}})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"title",children:"Title"}),e.jsx(f,{id:"title",value:l.title,onChange:s=>o("title",s.target.value),placeholder:"Enter video title"}),(r.title||i.title)&&e.jsx("p",{className:"text-sm text-red-600",children:r.title||i.title})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"description",children:"Description (Optional)"}),e.jsx(he,{id:"description",value:l.description,onChange:s=>o("description",s.target.value),placeholder:"Enter video description",rows:4}),(r.description||i.description)&&e.jsx("p",{className:"text-sm text-red-600",children:r.description||i.description})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"tags",children:"Tags (Optional)"}),e.jsx(f,{id:"tags",value:l.tags.join(", "),onChange:s=>{const t=s.target.value.split(",").map(a=>a.trim()).filter(a=>a);o("tags",t)},placeholder:"Enter tags separated by commas (e.g., video, content, viral)"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Add relevant tags to help with discoverability"}),(r.tags||i.tags)&&e.jsx("p",{className:"text-sm text-red-600",children:r.tags||i.tags})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{children:"Select Platforms"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose which platforms to publish this video to"}),e.jsx("div",{className:"grid grid-cols-1 gap-3",children:Object.entries(De).map(([s,t])=>{const a=t.icon,m=A.includes(s),se=E.includes(s),y=Y.includes(s),te=h.includes(s);return e.jsxs("div",{className:`flex items-center space-x-3 p-3 border rounded-lg ${m?"border-gray-300":"bg-muted border-border"}`,children:[e.jsx(xe,{id:s,checked:te,disabled:!m,onCheckedChange:ae=>X(s,ae)}),e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(a,{className:`h-5 w-5 ${t.color}`}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{htmlFor:s,className:`font-medium cursor-pointer ${m?"":"text-gray-400"}`,children:t.name}),!y&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-600 px-2 py-1 rounded  ",children:"Pro Only"}),y&&!se&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-600 px-2 py-1 rounded  ",children:"Not Connected"})]}),!m&&e.jsx("p",{className:"text-xs text-gray-400 ",children:y?"Connect this platform to your channel":"Upgrade to access this platform"})]})]})]},s)})}),(r.platforms||i.platforms)&&e.jsx("p",{className:"text-sm text-red-600",children:r.platforms||i.platforms}),A.length===0&&e.jsx(k,{className:"bg-yellow-50 border-yellow-200  ",children:e.jsx(w,{className:"text-yellow-800 ",children:"No platforms available for upload. Please connect at least one platform to this channel."})})]}),h.includes("facebook")&&u.length>0&&e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{children:"Select Facebook Page"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose which Facebook page to publish this video to"}),e.jsx("div",{className:"space-y-2",children:u.map(s=>e.jsxs("div",{className:`flex items-center space-x-3 p-3 border rounded-lg cursor-pointer transition-colors ${x===s.page_id?"border-blue-500 bg-blue-950/20":"border-gray-300 hover:border-gray-400"}`,onClick:()=>$(s.page_id),children:[e.jsx("input",{type:"radio",name:"facebook_page",value:s.page_id,checked:x===s.page_id,onChange:()=>$(s.page_id),className:"text-blue-600"}),e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx(M,{className:"h-5 w-5 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium",children:s.page_name}),s.is_current_channel&&e.jsx("span",{className:"text-xs bg-green-100 text-green-600 px-2 py-1 rounded  ",children:"Current Channel"})]}),e.jsxs("p",{className:"text-xs text-gray-500 ",children:["Page ID: ",s.page_id]})]})]})]},s.page_id))}),(r.facebook_page_id||i.facebook_page_id)&&e.jsx("p",{className:"text-sm text-red-600",children:r.facebook_page_id||i.facebook_page_id})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(n,{children:"Publishing Options"}),e.jsxs(pe,{value:b,onValueChange:G,children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{value:"now",id:"now"}),e.jsxs(n,{htmlFor:"now",className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(ke,{className:"h-4 w-4"}),e.jsx("span",{children:"Publish now"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{value:"scheduled",id:"scheduled"}),e.jsxs(n,{htmlFor:"scheduled",className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx(we,{className:"h-4 w-4"}),e.jsx("span",{children:"Schedule for later"})]})]})]}),b==="scheduled"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"publish_at",children:"Publish Date & Time (Your Local Time)"}),e.jsx(f,{id:"publish_at",type:"datetime-local",value:l.publish_at,onChange:s=>o("publish_at",s.target.value),min:(()=>{const s=new Date;return s.setMinutes(s.getMinutes()+5),s.toISOString().slice(0,16)})()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Time will be converted to your local timezone. Minimum: 5 minutes from now."}),(r.publish_at||i.publish_at)&&e.jsx("p",{className:"text-sm text-red-600",children:r.publish_at||i.publish_at})]})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx(C,{href:`/channels/${d.slug}`,children:e.jsx(_,{type:"button",variant:"outline",children:"Cancel"})}),e.jsx(_,{type:"submit",disabled:I||!l.video||h.length===0||p.length===0,children:I?"Uploading...":"Upload Video"})]})]})})]})]})]})}export{es as default};
