import{r as h,j as e,v as Is,$ as Vs,Y as Ds,m as Be}from"./app-CAahQOWF.js";import{c as I,a as $,B as F}from"./button-DtjNE_Ur.js";import{C as f,a as N,b as v,c as b,d as Ue}from"./card-DkmcU9A2.js";import{I as gs}from"./input-YO1E8Urj.js";import{L as js}from"./label-D-OC44O_.js";import{T as qs}from"./textarea-DN6Uzll1.js";import{T as De,a as qe,b as Y,c as Q}from"./tabs-DNGX_PS_.js";import{B as C}from"./badge-Bz4h2sTh.js";import{D as ws,b as _s,c as Ss,d as ks,e as Cs,f as Ls}from"./dialog-B9U_mH-A.js";import{B as we,X as Ke,A as Bs}from"./app-layout-BYxGvFG_.js";import{P as Ie}from"./progress-nxdswUIX.js";import{u as Ze}from"./use-toast-Bpqphnbt.js";import{V as _e}from"./video-BWJNJ6Tg.js";import{F as Us}from"./file-text-BGctk6rQ.js";import{I as Ae,T as fs}from"./tag-BUSqaRSz.js";import{a as Ne,C as ze,T as Fe}from"./workflow-BtSpyey9.js";import{R as G,E as He}from"./ErrorBoundary-BccmBN4T.js";import{C as Je}from"./circle-x-Byyli1af.js";import{C as Ts}from"./circle-check-big-CAqWUksF.js";import{E as Pe}from"./eye-BoJuPRx9.js";import{H as As}from"./heart-rXRafnCY.js";import{S as Hs,A as bs}from"./share-2-Bc_SGHqM.js";import{C as We}from"./clock-CeORDp6I.js";import{C as Ye}from"./circle-alert-k_016HSG.js";import{S as Xs,a as Gs,b as Ks,c as Js,d as $e}from"./select-CYCDHEgP.js";import{C as Ws}from"./checkbox-C_H1Ft16.js";import{C as Ys}from"./calendar-D7-yrRBj.js";import{T as ys}from"./triangle-alert-CFhA5L-d.js";import{A as Xe}from"./activity-BVh7465B.js";import{L as Qs}from"./lightbulb-CfFpJtO-.js";import{P as Zs}from"./pause-DqS_A-yR.js";import{P as Fs}from"./play-Bqq8Wkmm.js";import{C as et,P as Es}from"./palette-C6n9fPy3.js";import{D as Ns}from"./download-BjbWcjnS.js";import{U as st}from"./user-BFXCJzK_.js";import{S as Qe}from"./sparkles-D1b8NqXM.js";import{S as tt}from"./star-FFHHwiLD.js";import{A as at}from"./arrow-left-CqaI0iZN.js";import{T as rt}from"./trash-2-BIYq1I8B.js";import{Z as nt}from"./zap-Cc2bPHX-.js";import{I as lt,Y as it}from"./youtube-40v4-5Qo.js";import{U as ct}from"./upload-DdXTJgDj.js";import"./index-Blfp67ZX.js";import"./index-C2zyruRQ.js";import"./index-BqKf_aw7.js";import"./chevron-down-ChT5Vy3J.js";import"./check-CMWMhdca.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],dt=I("AlignCenter",ot);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mt=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],xt=I("AlignLeft",mt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ht=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],ut=I("AlignRight",ht);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pt=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],vs=I("ArrowDown",pt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],jt=I("Bold",gt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],bt=I("ExternalLink",ft);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],Nt=I("Film",yt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],wt=I("Italic",vt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],St=I("Languages",_t);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],Ct=I("Maximize",kt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],Ge=I("Mic",Tt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],Ft=I("Minimize",At);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],zt=I("Save",Et);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pt=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Mt=I("Settings2",Pt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ot=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],Ve=I("TestTube",Ot);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rt=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],$t=I("TrendingDown",Rt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],Vt=I("Trophy",It);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dt=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],zs=I("Type",Dt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qt=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],Lt=I("Underline",qt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bt=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Ut=I("WandSparkles",Bt);function Ht({videoId:l,videoPath:w,onAnalysisComplete:o,className:a}){var g,M,Z,O,q,B,de,re,ee,R,me,ne,xe,ye,ve,se,te,ie,le,he,ue,pe,ge,K,je,ae,fe,ce,be,d,s,n;const[c,T]=h.useState(null),[V,E]=h.useState(!1),[H,X]=h.useState("overview"),{toast:y}=Ze(),z=async()=>{var r;if(!l){y({title:"No Video Selected",description:"Please select a video first before analyzing.",variant:"destructive"});return}E(!0);try{const m=await fetch("/ai/analyze-video",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({video_id:l})}),S=await m.json();S.success?(T(S.data),o==null||o(S.data),y({title:"Analysis Complete! ðŸŽ¬",description:"AI has analyzed your video and extracted valuable insights."})):m.status===404?y({title:"Video File Not Found",description:"The video file associated with this record could not be found. Please re-upload the video.",variant:"destructive"}):y({title:"Analysis Failed",description:S.message||"Failed to analyze video. Please try again.",variant:"destructive"})}catch(m){console.error("Video analysis error:",m),y({title:"Analysis Failed",description:"Failed to analyze video. Please try again.",variant:"destructive"})}finally{E(!1)}},U=r=>{const m=Math.floor(r/60),S=Math.floor(r%60);return`${m}:${S.toString().padStart(2,"0")}`},A=r=>`${(r/1048576).toFixed(1)} MB`,W=r=>r>=80?"text-green-600 bg-green-100":r>=60?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100",D=r=>({positive:"ðŸ˜Š",energetic:"âš¡",calm:"ðŸ˜Œ",professional:"ðŸ’¼",casual:"ðŸ˜Ž",inspirational:"âœ¨",neutral:"ðŸ˜"})[r]||"ðŸ˜",j=r=>({educational:"ðŸ“š",entertainment:"ðŸŽ­",gaming:"ðŸŽ®",lifestyle:"ðŸ ",fitness:"ðŸ’ª",food:"ðŸ³",travel:"âœˆï¸",tech:"ðŸ’»",music:"ðŸŽµ",fashion:"ðŸ‘—",business:"ðŸ’¼",diy:"ðŸ”¨",general:"ðŸ“¹"})[r]||"ðŸ“¹",p=()=>{if(!(c!=null&&c.quality_score))return!1;const r=c.quality_score.resolution_score||0,m=c.quality_score.audio_score||0,S=c.quality_score.bitrate_score||0;return r<70||m<70||S<70},x=()=>{if(!(c!=null&&c.quality_score))return[];const r=[],m=c.quality_score.resolution_score||0,S=c.quality_score.audio_score||0,k=c.quality_score.bitrate_score||0;return m<70&&r.push({type:"Resolution",score:m,severity:m<40?"high":"medium"}),S<70&&r.push({type:"Audio Quality",score:S,severity:S<40?"high":"medium"}),k<70&&r.push({type:"Bitrate",score:k,severity:k<40?"high":"medium"}),r};return!c&&!V?e.jsxs(f,{className:$("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-blue-50",a),children:[e.jsxs(N,{className:"text-center pb-4",children:[e.jsx("div",{className:"mx-auto p-3 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full w-fit",children:e.jsx(we,{className:"w-8 h-8 text-white"})}),e.jsx(v,{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"AI Video Analyzer"}),e.jsx("p",{className:"text-gray-600",children:"Get comprehensive insights about your video content using advanced AI analysis"})]}),e.jsxs(b,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(_e,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Video Quality"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Us,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Transcription"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ae,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Scene Analysis"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ne,{className:"w-6 h-6 text-pink-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Engagement Prediction"})]})]}),e.jsxs(F,{onClick:z,disabled:!w,size:"lg",className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[e.jsx(we,{className:"w-5 h-5 mr-2"}),"Start AI Analysis"]}),!w&&e.jsx("p",{className:"text-sm text-gray-500",children:"Upload a video first to enable AI analysis"})]})]}):V?e.jsx(f,{className:$("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-blue-50",a),children:e.jsxs(b,{className:"p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto p-4 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full w-fit animate-pulse",children:e.jsx(we,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Analyzing Your Video..."}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Our AI is processing your video to extract valuable insights"}),e.jsx(Ie,{value:75,className:"w-full max-w-md mx-auto"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-purple-600"}),e.jsx("span",{children:"Extracting audio..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{children:"Analyzing scenes..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-green-600"}),e.jsx("span",{children:"Predicting engagement..."})]})]})]})}):!c||!c.basic_info?e.jsx(f,{className:$("border-2 border-red-200 bg-red-50",a),children:e.jsxs(b,{className:"p-8 text-center",children:[e.jsx(Je,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Analysis Error"}),e.jsx("p",{className:"text-red-600 mb-4",children:"The video analysis data is incomplete or corrupted."}),e.jsxs(F,{onClick:z,variant:"outline",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):e.jsxs(f,{className:$("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-blue-50",a),children:[e.jsx(N,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg",children:e.jsx(we,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(v,{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"AI Video Analysis Results"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Comprehensive insights powered by artificial intelligence"})]})]}),e.jsxs(F,{onClick:z,disabled:V,size:"sm",variant:"outline",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Re-analyze"]})]})}),e.jsxs(b,{children:[e.jsxs(De,{value:H,onValueChange:X,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-3",children:[e.jsx(Y,{value:"overview",children:"Overview"}),e.jsx(Y,{value:"engagement",children:"Engagement"}),e.jsx(Y,{value:"chapters",children:"Chapters"})]}),e.jsxs(Q,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(_e,{className:"w-5 h-5"}),"Video Information"]})}),e.jsxs(b,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsx("span",{className:"font-medium",children:U(((g=c.basic_info)==null?void 0:g.duration)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Resolution:"}),e.jsxs("span",{className:"font-medium",children:[((M=c.basic_info)==null?void 0:M.width)||0,"Ã—",((Z=c.basic_info)==null?void 0:Z.height)||0]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"File Size:"}),e.jsx("span",{className:"font-medium",children:A(((O=c.basic_info)==null?void 0:O.file_size)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Audio:"}),e.jsx(C,{variant:(q=c.basic_info)!=null&&q.has_audio?"default":"destructive",children:(B=c.basic_info)!=null&&B.has_audio?"Present":"Missing"})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5"}),"Content Analysis"]})}),e.jsxs(b,{className:"space-y-3",children:[c.content_category&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Category:"}),e.jsxs(C,{className:"bg-blue-100 text-blue-800",children:[j(c.content_category.primary_category)," ",c.content_category.primary_category]})]}),c.mood_analysis&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Mood:"}),e.jsxs(C,{className:"bg-green-100 text-green-800",children:[D(c.mood_analysis.dominant_mood)," ",c.mood_analysis.dominant_mood]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Transcript:"}),e.jsx(C,{variant:(de=c.transcript)!=null&&de.success?"default":"destructive",children:(re=c.transcript)!=null&&re.success?e.jsxs(e.Fragment,{children:[e.jsx(Ts,{className:"w-3 h-3 mr-1"}),"Available"]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"w-3 h-3 mr-1"}),"Failed"]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Content Tags:"}),e.jsxs("span",{className:"font-medium",children:[((ee=c.content_tags)==null?void 0:ee.length)||0," tags"]})]})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Overall Scores"]})}),e.jsx(b,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:$("text-3xl font-bold p-4 rounded-lg mb-2",W(((R=c.quality_score)==null?void 0:R.overall_score)||0)),children:[((me=c.quality_score)==null?void 0:me.overall_score)||0,"/100"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Video Quality"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:$("text-3xl font-bold p-4 rounded-lg mb-2",W(((ne=c.engagement_predictions)==null?void 0:ne.engagement_score)||0)),children:[((xe=c.engagement_predictions)==null?void 0:xe.engagement_score)||0,"/100"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Engagement Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold p-4 bg-purple-100 text-purple-800 rounded-lg mb-2",children:((ye=c.engagement_predictions)==null?void 0:ye.virality_potential)||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Virality Potential"})]})]})})]})]}),e.jsx(Q,{value:"engagement",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(N,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Engagement Predictions"]})}),e.jsxs(b,{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx(Pe,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:(((se=(ve=c.engagement_predictions)==null?void 0:ve.predicted_views)==null?void 0:se.expected)||0).toLocaleString()}),e.jsx("p",{className:"text-sm text-blue-600",children:"Expected Views"})]}),e.jsxs("div",{className:"text-center p-4 bg-pink-50 rounded-lg",children:[e.jsx(As,{className:"w-8 h-8 text-pink-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-pink-800",children:(((ie=(te=c.engagement_predictions)==null?void 0:te.predicted_likes)==null?void 0:ie.expected)||0).toLocaleString()}),e.jsx("p",{className:"text-sm text-pink-600",children:"Expected Likes"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(Hs,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:(((he=(le=c.engagement_predictions)==null?void 0:le.predicted_shares)==null?void 0:he.expected)||0).toLocaleString()}),e.jsx("p",{className:"text-sm text-green-600",children:"Expected Shares"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Prediction Ranges"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Views"}),e.jsxs("span",{children:[(((pe=(ue=c.engagement_predictions)==null?void 0:ue.predicted_views)==null?void 0:pe.conservative)||0).toLocaleString()," - ",(((K=(ge=c.engagement_predictions)==null?void 0:ge.predicted_views)==null?void 0:K.optimistic)||0).toLocaleString()]})]}),e.jsx(Ie,{value:60,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Likes"}),e.jsxs("span",{children:[(((ae=(je=c.engagement_predictions)==null?void 0:je.predicted_likes)==null?void 0:ae.conservative)||0).toLocaleString()," - ",(((ce=(fe=c.engagement_predictions)==null?void 0:fe.predicted_likes)==null?void 0:ce.optimistic)||0).toLocaleString()]})]}),e.jsx(Ie,{value:60,className:"h-2"})]})]})]})]})]})}),e.jsx(Q,{value:"chapters",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(N,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"w-5 h-5"}),"Auto-Generated Chapters"]})}),e.jsx(b,{children:(((be=c.auto_chapters)==null?void 0:be.length)||0)===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(We,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No chapters detected"}),e.jsx("p",{className:"text-sm",children:"Video may be too short or lack clear segment divisions"})]}):e.jsx("div",{className:"space-y-3",children:(c.auto_chapters||[]).map((r,m)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(C,{variant:"outline",className:"mt-1",children:U(r.start_time)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:r.title}),e.jsx("p",{className:"text-sm text-gray-600",children:r.description})]})]},m))})})]})})]}),p()&&e.jsxs("div",{className:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(Ye,{className:"w-5 h-5 text-orange-600"}),e.jsx("h4",{className:"font-medium text-orange-800",children:"Video Quality Suggestions"})]}),e.jsxs("div",{className:"space-y-3",children:[x().map((r,m)=>e.jsxs("div",{className:$("flex items-center justify-between p-3 rounded-lg",r.severity==="high"?"bg-red-100 border border-red-200":"bg-yellow-100 border border-yellow-200"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:$("w-2 h-2 rounded-full",r.severity==="high"?"bg-red-500":"bg-yellow-500")}),e.jsxs("span",{className:$("font-medium",r.severity==="high"?"text-red-800":"text-yellow-800"),children:[r.type," needs improvement"]})]}),e.jsxs(C,{variant:"outline",className:$(r.severity==="high"?"border-red-300 text-red-700":"border-yellow-300 text-yellow-700"),children:["Score: ",r.score,"/100"]})]},m)),(((d=c.quality_score)==null?void 0:d.suggestions)||[]).length>0&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-orange-200",children:[e.jsx("h5",{className:"font-medium text-orange-800 mb-2",children:"Recommendations:"}),e.jsx("div",{className:"space-y-2",children:(((s=c.quality_score)==null?void 0:s.suggestions)||[]).map((r,m)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm text-orange-700",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:r})]},m))})]})]})]}),c.status==="partial_analysis"&&((n=c.errors)==null?void 0:n.length)&&e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ye,{className:"w-5 h-5 text-yellow-600"}),e.jsx("h4",{className:"font-medium text-yellow-800",children:"Partial Analysis"})]}),e.jsx("div",{className:"space-y-1",children:(c.errors||[]).map((r,m)=>e.jsx("p",{className:"text-sm text-yellow-700",children:r},m))})]})]})]})}function Xt({videoId:l,className:w}){var M,Z,O,q,B,de,re,ee,R,me,ne,xe,ye,ve,se,te,ie,le,he,ue,pe,ge,K,je,ae,fe,ce,be;const[o,a]=h.useState(null),[c,T]=h.useState(!1),[V,E]=h.useState("overview"),[H,X]=h.useState(!1),[y,z]=h.useState(null),{toast:U}=Ze(),A=async()=>{var d;if(!l){U({title:"No Video Selected",description:"Please select a video to analyze performance.",variant:"destructive"});return}T(!0);try{const n=await(await fetch("/ai/analyze-video-performance",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content"))||""},body:JSON.stringify({video_id:l})})).json();if(n.success)a(n.data),U({title:"Performance Analysis Complete! ðŸ“Š",description:"AI has analyzed your video performance across all platforms."});else throw new Error(n.message||"Failed to analyze performance")}catch(s){console.error("Performance analysis error:",s),U({title:"Analysis Failed",description:"Failed to analyze video performance. Please try again.",variant:"destructive"})}finally{T(!1)}},W=async d=>{var s;try{const r=await(await fetch("/ai/create-ab-test",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({video_id:l,...d})})).json();if(r.success)U({title:"A/B Test Created! ðŸ§ª",description:"Your A/B test has been set up and will start collecting data."}),X(!1);else throw new Error(r.message||"Failed to create A/B test")}catch(n){console.error("A/B test creation error:",n),U({title:"A/B Test Failed",description:"Failed to create A/B test. Please try again.",variant:"destructive"})}},D=d=>d>=1e6?`${(d/1e6).toFixed(1)}M`:d>=1e3?`${(d/1e3).toFixed(1)}K`:d.toString(),j=d=>{switch(d){case"excellent":return"text-green-600 bg-green-100";case"good":return"text-blue-600 bg-blue-100";case"average":return"text-yellow-600 bg-yellow-100";case"needs_improvement":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},p=d=>{switch(d){case"increasing":return e.jsx(Ne,{className:"w-4 h-4 text-green-600"});case"decreasing":return e.jsx($t,{className:"w-4 h-4 text-red-600"});default:return e.jsx(Xe,{className:"w-4 h-4 text-blue-600"})}},x=d=>({youtube:"ðŸ“º",instagram:"ðŸ“·",tiktok:"ðŸŽµ",twitter:"ðŸ¦",facebook:"ðŸ‘¥"})[d]||"ðŸ“±",g=d=>{switch(d){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return!o&&!c?e.jsxs(f,{className:$("border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50",w),children:[e.jsxs(N,{className:"text-center pb-4",children:[e.jsx("div",{className:"mx-auto p-3 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full w-fit",children:e.jsx(ze,{className:"w-8 h-8 text-white"})}),e.jsx(v,{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"AI Performance Optimizer"}),e.jsx("p",{className:"text-gray-600",children:"Analyze your video performance and get AI-powered optimization recommendations"})]}),e.jsxs(b,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ne,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Performance Analysis"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Fe,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Optimization Tips"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ve,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"A/B Testing"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ys,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Timing Optimization"})]})]}),e.jsxs(F,{onClick:A,disabled:!l,size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[e.jsx(ze,{className:"w-5 h-5 mr-2"}),"Start Performance Analysis"]}),!l&&e.jsx("p",{className:"text-sm text-gray-500",children:"Select a video first to enable performance analysis"})]})]}):c?e.jsx(f,{className:$("border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50",w),children:e.jsxs(b,{className:"p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto p-4 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full w-fit animate-pulse",children:e.jsx(ze,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Analyzing Performance..."}),e.jsx("p",{className:"text-gray-600 mb-4",children:"AI is analyzing your video performance across all platforms"}),e.jsx(Ie,{value:85,className:"w-full max-w-md mx-auto"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{children:"Analyzing metrics..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-purple-600"}),e.jsx("span",{children:"Finding opportunities..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-green-600"}),e.jsx("span",{children:"Generating recommendations..."})]})]})]})}):!o||!o.overall_performance||!o.comparative_analysis||!o.platform_breakdown||!o.trend_analysis?e.jsx(f,{className:$("border-2 border-red-200 bg-gradient-to-br from-red-50 to-orange-50",w),children:e.jsxs(b,{className:"p-8 text-center space-y-4",children:[e.jsx(ys,{className:"w-12 h-12 text-red-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Analysis Data Incomplete"}),e.jsx("p",{className:"text-red-600 mb-4",children:"The performance analysis data is incomplete or missing."}),e.jsxs(F,{onClick:A,variant:"outline",className:"border-red-300 text-red-700",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})]})}):e.jsxs(f,{className:$("border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50",w),children:[e.jsx(N,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg",children:e.jsx(ze,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(v,{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Performance Analysis Results"}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered performance insights and optimization recommendations"})]})]}),e.jsxs(F,{onClick:A,disabled:c,size:"sm",variant:"outline",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Re-analyze"]})]})}),e.jsxs(b,{children:[e.jsxs(De,{value:V,onValueChange:E,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-6",children:[e.jsx(Y,{value:"overview",children:"Overview"}),e.jsx(Y,{value:"platforms",children:"Platforms"}),e.jsx(Y,{value:"opportunities",children:"Opportunities"}),e.jsx(Y,{value:"trends",children:"Trends"}),e.jsx(Y,{value:"timing",children:"Timing"}),e.jsx(Y,{value:"testing",children:"A/B Testing"})]}),e.jsxs(Q,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Pe,{className:"w-5 h-5"}),"Total Performance"]})}),e.jsxs(b,{className:"space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[o.performance_score,"/100"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Performance Score"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Views:"}),e.jsx("span",{className:"font-medium",children:D(((M=o.overall_performance)==null?void 0:M.total_views)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Engagement Rate:"}),e.jsxs("span",{className:"font-medium",children:[((Z=o.overall_performance)==null?void 0:Z.engagement_rate)||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Performance Tier:"}),e.jsx(C,{className:j(((O=o.overall_performance)==null?void 0:O.performance_tier)||"unknown"),children:(((q=o.overall_performance)==null?void 0:q.performance_tier)||"unknown").replace("_"," ")})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Industry Comparison"]})}),e.jsxs(b,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Views vs Industry:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[(((de=(B=o.comparative_analysis)==null?void 0:B.views_vs_industry)==null?void 0:de.performance)||"below_average")==="above_average"?e.jsx(bs,{className:"w-3 h-3 text-green-600"}):e.jsx(vs,{className:"w-3 h-3 text-red-600"}),e.jsxs("span",{className:$("text-sm font-medium",(((ee=(re=o.comparative_analysis)==null?void 0:re.views_vs_industry)==null?void 0:ee.performance)||"below_average")==="above_average"?"text-green-600":"text-red-600"),children:[Math.abs(((me=(R=o.comparative_analysis)==null?void 0:R.views_vs_industry)==null?void 0:me.difference_percentage)||0),"%"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Engagement vs Industry:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[(((xe=(ne=o.comparative_analysis)==null?void 0:ne.engagement_vs_industry)==null?void 0:xe.performance)||"below_average")==="above_average"?e.jsx(bs,{className:"w-3 h-3 text-green-600"}):e.jsx(vs,{className:"w-3 h-3 text-red-600"}),e.jsxs("span",{className:$("text-sm font-medium",(((ve=(ye=o.comparative_analysis)==null?void 0:ye.engagement_vs_industry)==null?void 0:ve.performance)||"below_average")==="above_average"?"text-green-600":"text-red-600"),children:[Math.abs(((te=(se=o.comparative_analysis)==null?void 0:se.engagement_vs_industry)==null?void 0:te.difference_percentage)||0),"%"]})]})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Growth Potential:"}),e.jsxs("div",{className:"text-lg font-medium text-purple-600",children:[D(((le=(ie=o.comparative_analysis)==null?void 0:ie.growth_potential)==null?void 0:le.views_growth_potential)||0)," more views"]})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"Improvement Potential"]})}),e.jsxs(b,{className:"space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[o.improvement_potential,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Improvement Potential"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Platforms:"}),e.jsx("span",{className:"font-medium",children:((he=o.overall_performance)==null?void 0:he.platform_count)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Days Since Upload:"}),e.jsx("span",{className:"font-medium",children:((ue=o.overall_performance)==null?void 0:ue.days_since_upload)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Lifecycle Stage:"}),e.jsx(C,{variant:"outline",children:((pe=o.trend_analysis)==null?void 0:pe.lifecycle_stage)||"unknown"})]})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5"}),"Platform Performance Overview"]})}),e.jsx(b,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(o.platform_breakdown||{}).map(([d,s])=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:x(d)}),e.jsx("div",{className:"font-medium capitalize mb-1",children:d}),e.jsxs("div",{className:"text-sm text-gray-600",children:["#",(s==null?void 0:s.ranking)||0]}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[(s==null?void 0:s.performance_score)||0,"/100"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[D((s==null?void 0:s.views)||0)," views"]})]},d))})})]})]}),e.jsx(Q,{value:"platforms",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(o.platform_breakdown||{}).map(([d,s])=>e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:x(d)}),e.jsx("span",{className:"capitalize",children:d}),e.jsxs(C,{className:"ml-2",children:["#",(s==null?void 0:s.ranking)||0]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[(s==null?void 0:s.performance_score)||0,"/100"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Performance Score"})]})]})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx(Pe,{className:"w-6 h-6 text-blue-600 mx-auto mb-1"}),e.jsx("div",{className:"text-lg font-bold",children:D((s==null?void 0:s.views)||0)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Views"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx(As,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),e.jsx("div",{className:"text-lg font-bold",children:D((s==null?void 0:s.engagement)||0)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Engagement"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx(Ne,{className:"w-6 h-6 text-purple-600 mx-auto mb-1"}),e.jsxs("div",{className:"text-lg font-bold",children:[(s==null?void 0:s.engagement_rate)||0,"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Engagement Rate"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[((s==null?void 0:s.strengths)||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-green-700 mb-2 flex items-center gap-2",children:[e.jsx(Vt,{className:"w-4 h-4"}),"Strengths"]}),e.jsx("ul",{className:"space-y-1",children:((s==null?void 0:s.strengths)||[]).map((n,r)=>e.jsxs("li",{className:"text-sm text-green-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full mt-2 flex-shrink-0"}),n]},r))})]}),((s==null?void 0:s.weaknesses)||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-red-700 mb-2 flex items-center gap-2",children:[e.jsx(ys,{className:"w-4 h-4"}),"Areas for Improvement"]}),e.jsx("ul",{className:"space-y-1",children:((s==null?void 0:s.weaknesses)||[]).map((n,r)=>e.jsxs("li",{className:"text-sm text-red-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-red-400 rounded-full mt-2 flex-shrink-0"}),n]},r))})]})]}),((s==null?void 0:s.recommendations)||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-blue-700 mb-2 flex items-center gap-2",children:[e.jsx(Qs,{className:"w-4 h-4"}),"Recommendations"]}),e.jsx("div",{className:"space-y-2",children:((s==null?void 0:s.recommendations)||[]).map((n,r)=>e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx("span",{className:"text-sm text-blue-800",children:n})},r))})]})]})]},d))})}),e.jsx(Q,{value:"opportunities",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(o.optimization_opportunities||{}).map(([d,s])=>e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:x(d)}),e.jsxs("span",{className:"capitalize",children:[d," Opportunities"]})]})}),e.jsx(b,{className:"space-y-4",children:(s||[]).map((n,r)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4"}),(n==null?void 0:n.title)||"Untitled"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(n==null?void 0:n.description)||"No description available"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{className:g((n==null?void 0:n.priority)||"low"),children:(n==null?void 0:n.priority)||"low"}),e.jsxs(C,{variant:"outline",children:[(n==null?void 0:n.potential_impact)||"unknown"," impact"]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Action Steps:"}),e.jsx("div",{className:"space-y-1",children:((n==null?void 0:n.actions)||[]).map((m,S)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),m]},S))})]})]},r))})]},d))})}),e.jsx(Q,{value:"trends",className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Xe,{className:"w-5 h-5"}),"Trend Analysis"]})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Trend Direction:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[p(((ge=o.trend_analysis)==null?void 0:ge.trend_direction)||"stable"),e.jsx("span",{className:"font-medium capitalize",children:((K=o.trend_analysis)==null?void 0:K.trend_direction)||"stable"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Daily Avg Views:"}),e.jsx("span",{className:"font-medium",children:D(((je=o.trend_analysis)==null?void 0:je.daily_average_views)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Momentum Score:"}),e.jsxs("span",{className:"font-medium",children:[((ae=o.trend_analysis)==null?void 0:ae.momentum_score)||0,"/100"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Lifecycle Stage:"}),e.jsx(C,{variant:"outline",children:((fe=o.trend_analysis)==null?void 0:fe.lifecycle_stage)||"unknown"})]})]})]}),e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Performance Projections"]})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:D(((ce=o.trend_analysis)==null?void 0:ce.projected_30_day_views)||0)}),e.jsx("div",{className:"text-sm text-blue-600",children:"Projected 30-Day Views"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Peak Performance Day:"}),e.jsxs("span",{className:"font-medium",children:["Day ",((be=o.trend_analysis)==null?void 0:be.peak_performance_day)||0]})]})]})]})]})}),e.jsx(Q,{value:"timing",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(o.posting_time_optimization||{}).map(([d,s])=>e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:x(d)}),e.jsxs("span",{className:"capitalize",children:[d," Timing Optimization"]})]})}),e.jsx(b,{className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Current Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Posted at:"}),e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.current_posting_time)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Day type:"}),e.jsx("span",{className:"font-medium",children:(s==null?void 0:s.current_day_type)||"unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Improvement potential:"}),e.jsx(C,{className:g((s==null?void 0:s.improvement_potential)||"low"),children:(s==null?void 0:s.improvement_potential)||"low"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Optimal Times"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Best time:"}),e.jsx("span",{className:"font-medium text-green-600",children:(s==null?void 0:s.best_time)||"unknown"})]}),e.jsx("div",{className:"text-sm text-gray-600",children:"All optimal times:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:((s==null?void 0:s.optimal_times)||[]).map((n,r)=>e.jsx(C,{variant:"outline",className:"text-xs",children:n},r))})]})]})]})})]},d))})}),e.jsx(Q,{value:"testing",className:"space-y-4",children:e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"}),"A/B Testing Suggestions"]})}),e.jsx(b,{className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:(o.ab_test_suggestions||[]).map((d,s)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ve,{className:"w-4 h-4"}),(d==null?void 0:d.title)||"Untitled Test"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(d==null?void 0:d.description)||"No description available"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{className:g((d==null?void 0:d.priority)||"low"),children:(d==null?void 0:d.priority)||"low"}),e.jsx(F,{size:"sm",onClick:()=>{z(d),X(!0)},children:"Start Test"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Test Variations:"}),e.jsx("div",{className:"space-y-1",children:((d==null?void 0:d.test_variations)||[]).map((n,r)=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),n]},r))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Success Metrics:"}),e.jsx("div",{className:"space-y-1",children:((d==null?void 0:d.success_metrics)||[]).map((n,r)=>e.jsx(C,{variant:"outline",className:"text-xs mr-1",children:n.replace("_"," ")},r))}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Duration: ",(d==null?void 0:d.duration)||"Unknown"]})]})]})]},s))})})]})})]}),e.jsx(ws,{open:H,onOpenChange:X,children:e.jsxs(_s,{className:"max-w-md",children:[e.jsxs(Ss,{children:[e.jsx(ks,{children:"Create A/B Test"}),e.jsxs(Cs,{children:['Set up an A/B test for "',y==null?void 0:y.title,'"']})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Test Duration (days)"}),e.jsxs(Xs,{defaultValue:"14",children:[e.jsx(Gs,{children:e.jsx(Ks,{})}),e.jsxs(Js,{children:[e.jsx($e,{value:"7",children:"7 days"}),e.jsx($e,{value:"14",children:"14 days"}),e.jsx($e,{value:"21",children:"21 days"}),e.jsx($e,{value:"30",children:"30 days"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Success Metrics"}),e.jsx("div",{className:"space-y-2",children:((y==null?void 0:y.success_metrics)||[]).map((d,s)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ws,{id:`metric-${s}`,defaultChecked:!0}),e.jsx("label",{htmlFor:`metric-${s}`,className:"text-sm",children:d.replace("_"," ")})]},s))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(F,{variant:"outline",onClick:()=>X(!1),children:"Cancel"}),e.jsx(F,{onClick:()=>W({test_type:y==null?void 0:y.test_type,test_variations:y==null?void 0:y.test_variations,success_metrics:y==null?void 0:y.success_metrics,test_duration_days:14}),children:"Create Test"})]})]})]})})]})]})}const Gt=(l,w,o)=>{const a=document.createElement("div");a.style.position="absolute",a.style.left=`${l}px`,a.style.top=`${w}px`,a.style.width="6px",a.style.height="6px",a.style.backgroundColor=o,a.style.borderRadius="50%",a.style.pointerEvents="none",a.style.zIndex="1000";const c=(Math.random()-.5)*100,T=(Math.random()-.5)*100;return a.animate([{transform:"translate(0, 0) rotate(0deg)",opacity:1},{transform:`translate(${c}px, ${T}px) rotate(360deg)`,opacity:0}],{duration:800,easing:"ease-out"}).onfinish=()=>{a.parentNode&&a.parentNode.removeChild(a)},a},Kt=({subtitle:l,currentTime:w,position:o,onMouseDown:a,onDoubleClick:c,editingSubtitle:T,editingText:V,onTextChange:E,onSaveEdit:H,onCancelEdit:X})=>{var D,j;const y=h.useRef(null),[z,U]=h.useState(new Set);h.useEffect(()=>{if(!l.words||l.words.length===0)return;const p=new Set;l.words.forEach((x,g)=>{var M;if(w>=x.start_time&&w<=x.end_time&&(p.add(g),!z.has(g)&&((M=l.style)==null?void 0:M.preset)==="confetti"&&y.current)){const O=y.current.getBoundingClientRect(),q=["#FFD700","#FF69B4","#00CED1","#FF4500","#9370DB"];for(let B=0;B<5;B++)setTimeout(()=>{const de=q[Math.floor(Math.random()*q.length)],re=O.left+O.width*Math.random(),ee=O.top+O.height*Math.random(),R=Gt(re,ee,de);document.body.appendChild(R)},B*50)}}),U(p)},[w,l.words,z,(D=l.style)==null?void 0:D.preset]);const A=()=>!l.words||l.words.length===0?l.text:l.words.map((p,x)=>{var Z,O,q,B;const g=z.has(x),M={display:"inline-block",marginRight:"0.3em"};return((Z=l.style)==null?void 0:Z.preset)==="confetti"?e.jsx("span",{style:{...M,opacity:g?1:0,transform:g?"scale(1)":"scale(0.8)",transition:"all 0.2s ease-out"},children:p.word},x):((O=l.style)==null?void 0:O.preset)==="bubbles"?e.jsx("span",{style:{...M,color:g?"#4169E1":((q=l.style)==null?void 0:q.color)||"#FFFFFF",transform:g?"scale(1.2)":"scale(1)",transition:"all 0.3s ease-out",textShadow:g?"0 0 10px #4169E1, 0 0 20px #4169E1":((B=l.style)==null?void 0:B.textShadow)||"3px 3px 6px rgba(0, 0, 0, 0.8)"},children:p.word},x):e.jsx("span",{style:M,children:p.word},x)}),W=()=>{var x,g;const p=l.style||{};return{position:"absolute",left:`${o.x}%`,top:`${o.y}%`,transform:"translate(-50%, -50%)",fontFamily:p.fontFamily||"Arial, sans-serif",fontSize:`${p.fontSize||24}px`,fontWeight:p.fontWeight||"bold",color:p.color||"#FFFFFF",background:(x=p.backgroundColor)!=null&&x.includes("gradient")?p.backgroundColor:void 0,backgroundColor:(g=p.backgroundColor)!=null&&g.includes("gradient")?void 0:p.backgroundColor||"rgba(0, 0, 0, 0.7)",textAlign:p.textAlign||"center",borderRadius:`${p.borderRadius||4}px`,padding:`${p.padding||8}px`,textShadow:p.textShadow||"2px 2px 4px rgba(0, 0, 0, 0.5)",fontStyle:p.italic?"italic":"normal",textDecoration:p.underline?"underline":"none",cursor:"move",userSelect:"none",boxShadow:(p==null?void 0:p.preset)==="neon"?"none":void 0,whiteSpace:"nowrap",maxWidth:"80vw",overflow:"visible"}};return e.jsx("div",{ref:y,style:W(),onMouseDown:a,onDoubleClick:c,className:`subtitle-container ${((j=l.style)==null?void 0:j.preset)||""}`,children:T?e.jsx("input",{type:"text",value:V||"",onChange:p=>E==null?void 0:E(p.target.value),onKeyDown:p=>{p.key==="Enter"?H==null||H():p.key==="Escape"&&(X==null||X())},onBlur:H,className:"subtitle-editor",style:{background:"transparent",border:"none",outline:"none",textAlign:"center",color:"inherit",fontSize:"inherit",fontFamily:"inherit",fontWeight:"inherit",width:"100%",minWidth:"100px"},autoFocus:!0}):e.jsx("div",{className:"subtitle-content",children:A()})})},Jt=({videoPath:l,videoId:w,videoTitle:o})=>{var ts,as,rs,ns,ls,is,cs,os,ds,ms,xs,hs,us;const[a,c]=h.useState(null),[T,V]=h.useState(!1),[E,H]=h.useState(!1),[X,y]=h.useState(!1),[z,U]=h.useState(!1),A=h.useRef(null),[W,D]=h.useState({}),[j,p]=h.useState("en"),[x,g]=h.useState(null),[M,Z]=h.useState("standard"),[O,q]=h.useState(null),[B,de]=h.useState(null),[re,ee]=h.useState(!1),[R,me]=h.useState(0),[ne,xe]=h.useState(0),[ye,ve]=h.useState(!1),[se,te]=h.useState(null),[ie,le]=h.useState(""),[he,ue]=h.useState(null),[pe,ge]=h.useState({x:0,y:0}),K=h.useRef(null),je=h.useRef(null),ae=h.useRef(null),fe=h.useRef(null),ce={standard:{name:"Standard",style:{fontFamily:"Arial, sans-serif",fontSize:24,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"rgba(0, 0, 0, 0.7)",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:4,padding:8,textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)",preset:"standard"}},"no-background":{name:"No Background",style:{fontFamily:"Arial, sans-serif",fontSize:28,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"3px 3px 6px rgba(0, 0, 0, 0.8)",preset:"no-background"}},neon:{name:"Neon",style:{fontFamily:"Impact, Arial Black, sans-serif",fontSize:32,fontWeight:"bold",color:"#00FFFF",backgroundColor:"rgba(0, 20, 40, 0.8)",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:8,padding:12,textShadow:"0 0 10px #00FFFF, 0 0 20px #00FFFF",preset:"neon"}},confetti:{name:"Confetti",style:{fontFamily:"Comic Sans MS, cursive",fontSize:30,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"2px 2px 0px #000000, -2px -2px 0px #000000, 2px -2px 0px #000000, -2px 2px 0px #000000",preset:"confetti"}},bubbles:{name:"Bubbles",style:{fontFamily:"Trebuchet MS, sans-serif",fontSize:28,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"3px 3px 6px rgba(0, 0, 0, 0.8)",preset:"bubbles"}}},be=ce.standard.style;h.useEffect(()=>(s(),d(),()=>{O&&clearInterval(O)}),[]);const d=async()=>{var t;if(w)try{const u=await(await fetch("/ai/subtitle-check",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({video_id:w})})).json();u.success&&u.data&&u.data.processing_status==="completed"&&c({...u.data,original_video_path:l})}catch(i){console.error("Error checking existing subtitles:",i)}};h.useEffect(()=>{if(a&&a.processing_status==="processing"){const t=setInterval(()=>{r()},2e3);return q(t),()=>clearInterval(t)}else O&&(clearInterval(O),q(null))},[a==null?void 0:a.processing_status]),h.useEffect(()=>{const t=K.current;if(!t)return;const i=()=>{me(t.currentTime)},u=()=>{xe(t.duration)};return t.addEventListener("timeupdate",i),t.addEventListener("loadedmetadata",u),()=>{t.removeEventListener("timeupdate",i),t.removeEventListener("loadedmetadata",u)}},[]);const s=async()=>{try{const i=await(await fetch("/ai/subtitle-languages")).json();i.success&&D(i.data)}catch(t){console.error("Error loading languages:",t)}},n=async()=>{var t;if(!w){alert("No video ID available for subtitle generation. Please ensure the video is properly uploaded.");return}V(!0);try{const u=await(await fetch("/ai/subtitle-generate",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({video_id:w,language:j})})).json();u.success?c({...u.data,original_video_path:l}):(console.error("Generation failed:",u.message),alert(`Subtitle generation failed: ${u.message}`))}catch(i){console.error("Error starting generation:",i)}finally{V(!1)}},r=async()=>{var t;if(a!=null&&a.generation_id)try{const u=await(await fetch("/ai/subtitle-progress",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id})})).json();u.success&&c(_=>({..._,...u.data,original_video_path:(_==null?void 0:_.original_video_path)||l}))}catch(i){console.error("Error polling progress:",i)}},m=()=>{const t=K.current;t&&(re?t.pause():t.play(),ee(!re))},S=t=>{const i=K.current,u=je.current;if(!i||!u)return;const _=u.getBoundingClientRect(),P=(t.clientX-_.left)/_.width*ne;i.currentTime=P,me(P)},k=()=>a!=null&&a.subtitles&&a.subtitles.find(t=>R>=t.start_time&&R<=t.end_time)||null,Me=async()=>{var u;const t=K.current,i=fe.current;if(!t||!i||!w){alert("Unable to capture frame. Please ensure video is loaded.");return}y(!0);try{i.width=t.videoWidth,i.height=t.videoHeight;const _=i.getContext("2d");if(!_)throw new Error("Unable to get canvas context");_.drawImage(t,0,0,i.width,i.height);const L=await new Promise((Te,$s)=>{i.toBlob(ps=>{ps?Te(ps):$s(new Error("Failed to create blob from canvas"))},"image/jpeg",.8)}),P=new FormData;P.append("video_id",w.toString()),P.append("frame_id",`frame_${Date.now()}`),P.append("thumbnail",L,"thumbnail.jpg"),P.append("current_time",R.toString());const Ce=await(await fetch("/ai/set-video-thumbnail-from-frame",{method:"POST",headers:{"X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"))||""},body:P})).json();if(Ce.success){const Te=document.createElement("div");Te.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",Te.textContent="âœ“ Thumbnail set successfully!",document.body.appendChild(Te),setTimeout(()=>{document.body.removeChild(Te)},3e3)}else alert(`Failed to set thumbnail: ${Ce.message}`)}catch(_){console.error("Error setting thumbnail:",_),alert("Failed to capture and set thumbnail. Please try again.")}finally{y(!1)}},Ee=t=>{const i=a==null?void 0:a.subtitles.find(u=>u.id===t);i&&(te(t),le(i.text))},Le=async()=>{var t;if(!(!se||!a))try{if((await(await fetch("/ai/subtitle-update-text",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,subtitle_id:se,text:ie})})).json()).success){const _=a.subtitles.map(L=>L.id===se?{...L,text:ie}:L);c({...a,subtitles:_}),te(null),le("")}}catch(i){console.error("Error updating subtitle:",i)}},oe=async(t,i)=>{var u;if(a)try{if((await(await fetch("/ai/subtitle-update-style",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,subtitle_id:t,style:i})})).json()).success){const P=a.subtitles.map(J=>J.id===t?{...J,style:{...J.style,...i}}:J);c({...a,subtitles:P})}}catch(_){console.error("Error updating subtitle style:",_)}},es=async(t,i)=>{var u;if(a)try{if((await(await fetch("/ai/subtitle-update-position",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,subtitle_id:t,position:i})})).json()).success){const P=a.subtitles.map(J=>J.id===t?{...J,position:i}:J);c({...a,subtitles:P})}}catch(_){console.error("Error updating subtitle position:",_)}},Oe=async t=>{var u;if(!a)return;const i=ce[t];if(i)try{(await(await fetch("/ai/apply-style-to-all-subtitles",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,style:i.style})})).json()).success&&(c(P=>P?{...P,subtitles:P.subtitles.map(J=>({...J,style:{...i.style}}))}:null),Z(t))}catch(_){console.error("Failed to apply style to all subtitles:",_)}},Re=(t,i)=>{if(t.preventDefault(),!(a==null?void 0:a.subtitles.find(Ce=>Ce.id===i))||!ae.current)return;ue(i),ae.current.getBoundingClientRect();const L=t.target.getBoundingClientRect(),P=L.left+L.width/2,J=L.top+L.height/2;ge({x:t.clientX-P,y:t.clientY-J})},Ps=t=>{if(!he||!ae.current)return;const i=ae.current.getBoundingClientRect(),u=t.clientX-pe.x,_=t.clientY-pe.y,L=(u-i.left)/i.width*100,P=(_-i.top)/i.height*100,J=Math.max(5,Math.min(95,L)),Ce=Math.max(5,Math.min(95,P));es(he,{x:J,y:Ce})},ss=()=>{ue(null),ge({x:0,y:0})},Ms=async()=>{var t;if(a!=null&&a.generation_id)try{const u=await(await fetch("/ai/subtitle-export",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,format:"srt"})})).json();u.success&&window.open(u.data.file_url,"_blank")}catch(i){console.error("Error exporting transcript:",i)}},Os=async()=>{var t;if(a!=null&&a.generation_id){H(!0);try{const u=await(await fetch("/ai/subtitle-render-video",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,video_id:w})})).json();u.success?(de(u.data),alert("Video rendered successfully! The video with subtitles has been uploaded to all platforms.")):alert(`Failed to render video: ${u.message}`)}catch(i){console.error("Error rendering video:",i),alert("An error occurred while rendering the video. Please try again.")}finally{H(!1)}}},Se=t=>{const i=Math.floor(t/60),u=Math.floor(t%60);return`${i}:${u.toString().padStart(2,"0")}`},Rs=async()=>{var t,i,u;try{z?document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen():(t=A.current)!=null&&t.requestFullscreen?await A.current.requestFullscreen():(i=A.current)!=null&&i.webkitRequestFullscreen?await A.current.webkitRequestFullscreen():(u=A.current)!=null&&u.msRequestFullscreen&&await A.current.msRequestFullscreen()}catch(_){console.error("Error toggling fullscreen:",_)}};h.useEffect(()=>{const t=()=>{const i=!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement);U(i)};return document.addEventListener("fullscreenchange",t),document.addEventListener("webkitfullscreenchange",t),document.addEventListener("msfullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t),document.removeEventListener("webkitfullscreenchange",t),document.removeEventListener("msfullscreenchange",t)}},[]);const ke=k();return e.jsxs("div",{ref:A,className:`bg-white shadow-sm border ${z?"h-screen w-screen flex flex-col":"rounded-lg"}`,children:[e.jsx("canvas",{ref:fe,style:{display:"none"}}),e.jsx("div",{className:"p-6 border-b bg-gradient-to-r from-purple-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg",children:e.jsx(Ge,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Video Editor"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Generate and edit subtitles with real-time preview"})]})]}),e.jsxs("button",{onClick:Rs,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",title:z?"Exit fullscreen":"Enter fullscreen",children:[z?e.jsx(Ft,{className:"w-4 h-4"}):e.jsx(Ct,{className:"w-4 h-4"}),z?"Exit Fullscreen":"Fullscreen"]})]}),!a&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(St,{className:"w-4 h-4 inline mr-2"}),"Language"]}),e.jsx("select",{value:j,onChange:t=>p(t.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:T,children:Object.entries(W).map(([t,i])=>e.jsxs("option",{value:t,children:[i.name," (",i.accuracy,"% accuracy)"]},t))})]}),e.jsx("button",{onClick:n,disabled:T||!w,className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg font-medium hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:T?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ge,{className:"w-4 h-4"}),"Generate Subtitles"]})})]})]})}),e.jsxs("div",{className:`p-6 ${z?"flex-1 overflow-auto":""}`,children:[(a==null?void 0:a.processing_status)==="processing"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),e.jsxs("span",{className:"font-medium text-blue-900",children:["Processing: ",a.progress.current_step]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${a.progress.percentage}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-blue-700",children:[e.jsxs("span",{children:[a.progress.percentage,"% complete"]}),e.jsxs("span",{children:[Se(a.progress.processed_duration)," / ",Se(a.progress.total_duration)]})]})]}),l&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{ref:ae,className:"relative bg-black rounded-lg overflow-hidden",onMouseMove:Ps,onMouseUp:ss,onMouseLeave:ss,children:[e.jsx("video",{ref:K,src:(a==null?void 0:a.original_video_path)||l,className:`w-full h-auto ${z?"max-h-[70vh]":"max-h-96"}`,controls:!1,onPlay:()=>ee(!0),onPause:()=>ee(!1)}),ke&&e.jsx(Kt,{subtitle:ke,currentTime:R,position:ke.position,onMouseDown:t=>Re(t,ke.id),onDoubleClick:()=>Ee(ke.id),editingSubtitle:se===ke.id,editingText:ie,onTextChange:le,onSaveEdit:Le,onCancelEdit:()=>{te(null),le("")}})]}),e.jsx("div",{className:"mt-4 space-y-3",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:m,className:"flex items-center justify-center w-10 h-10 bg-purple-600 text-white rounded-full hover:bg-purple-700 transition-colors",children:re?e.jsx(Zs,{className:"w-5 h-5"}):e.jsx(Fs,{className:"w-5 h-5 ml-0.5"})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{ref:je,className:"h-2 bg-gray-200 rounded-full cursor-pointer",onClick:S,children:e.jsx("div",{className:"h-full bg-purple-600 rounded-full transition-all",style:{width:`${R/ne*100}%`}})})}),e.jsxs("span",{className:"text-sm text-gray-600 min-w-0",children:[Se(R)," / ",Se(ne)]}),e.jsx("button",{onClick:Me,disabled:X||!w,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",title:"Set current frame as thumbnail",children:X?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Setting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(et,{className:"w-4 h-4"}),"Set Thumbnail"]})})]})})]}),(a==null?void 0:a.processing_status)==="completed"&&a.subtitles&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Subtitle Timeline"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:a.subtitles.map(t=>e.jsxs("div",{className:`flex items-center gap-4 p-3 border rounded-lg hover:bg-white transition-colors cursor-pointer ${R>=t.start_time&&R<=t.end_time?"border-purple-300 bg-purple-50":"border-gray-200 bg-white"}`,onClick:()=>{K.current&&(K.current.currentTime=t.start_time)},children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("span",{className:"text-sm font-mono text-gray-500",children:[Se(t.start_time)," â†’ ",Se(t.end_time)]})}),e.jsx("div",{className:"flex-grow",children:e.jsx("p",{className:"text-gray-900",children:t.text})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[e.jsx("button",{onClick:i=>{i.stopPropagation(),Ee(t.id)},className:"p-1 text-gray-400 hover:text-purple-600 transition-colors",title:"Edit subtitle",children:e.jsx(zs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:i=>{i.stopPropagation(),g(t.id)},className:"p-1 text-gray-400 hover:text-purple-600 transition-colors",title:"Style subtitle",children:e.jsx(Es,{className:"w-4 h-4"})})]})]},t.id))})]}),x&&(a==null?void 0:a.subtitles)&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Subtitle Style"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Style Presets"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(ce).map(([t,i])=>{var L;const u=a.subtitles.find(P=>P.id===x),_=((L=u==null?void 0:u.style)==null?void 0:L.preset)===t;return e.jsx("button",{onClick:()=>{oe(x,{...i.style}),Z(t)},className:`p-3 border rounded-lg text-sm font-medium transition-all ${_?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 bg-white text-gray-700 hover:border-purple-300 hover:bg-purple-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs mb-1 px-2 py-1 rounded",style:{color:i.style.color,backgroundColor:i.style.backgroundColor.includes("gradient")?"#FFD700":i.style.backgroundColor,textShadow:i.style.textShadow.includes("0px")?i.style.textShadow:"none",fontFamily:i.style.fontFamily.split(",")[0]},children:"Aa"}),i.name]})},t)})}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{onClick:()=>Oe(M),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:[e.jsx(Ut,{className:"w-4 h-4"}),"Apply to All Subtitles"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Size"}),e.jsx("input",{type:"range",min:"12",max:"48",value:((as=(ts=a.subtitles.find(t=>t.id===x))==null?void 0:ts.style)==null?void 0:as.fontSize)||be.fontSize,onChange:t=>oe(x,{fontSize:parseInt(t.target.value)}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),e.jsx("input",{type:"color",value:((ns=(rs=a.subtitles.find(t=>t.id===x))==null?void 0:rs.style)==null?void 0:ns.color)||be.color,onChange:t=>oe(x,{color:t.target.value}),className:"w-full h-8 rounded border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Background"}),e.jsx("input",{type:"color",value:((cs=(is=(ls=a.subtitles.find(t=>t.id===x))==null?void 0:ls.style)==null?void 0:is.backgroundColor)==null?void 0:cs.replace("rgba(0, 0, 0, 0.7)","#000000"))||"#000000",onChange:t=>oe(x,{backgroundColor:t.target.value}),className:"w-full h-8 rounded border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alignment"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>oe(x,{textAlign:"left"}),className:"p-2 border rounded hover:bg-gray-100",children:e.jsx(xt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>oe(x,{textAlign:"center"}),className:"p-2 border rounded hover:bg-gray-100",children:e.jsx(dt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>oe(x,{textAlign:"right"}),className:"p-2 border rounded hover:bg-gray-100",children:e.jsx(ut,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{var t,i;return oe(x,{bold:!((i=(t=a.subtitles.find(u=>u.id===x))==null?void 0:t.style)!=null&&i.bold)})},className:`p-2 border rounded hover:bg-gray-100 ${(ds=(os=a.subtitles.find(t=>t.id===x))==null?void 0:os.style)!=null&&ds.bold?"bg-purple-100 border-purple-300":""}`,children:e.jsx(jt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var t,i;return oe(x,{italic:!((i=(t=a.subtitles.find(u=>u.id===x))==null?void 0:t.style)!=null&&i.italic)})},className:`p-2 border rounded hover:bg-gray-100 ${(xs=(ms=a.subtitles.find(t=>t.id===x))==null?void 0:ms.style)!=null&&xs.italic?"bg-purple-100 border-purple-300":""}`,children:e.jsx(wt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var t,i;return oe(x,{underline:!((i=(t=a.subtitles.find(u=>u.id===x))==null?void 0:t.style)!=null&&i.underline)})},className:`p-2 border rounded hover:bg-gray-100 ${(us=(hs=a.subtitles.find(t=>t.id===x))==null?void 0:hs.style)!=null&&us.underline?"bg-purple-100 border-purple-300":""}`,children:e.jsx(Lt,{className:"w-4 h-4"})})]})]}),(a==null?void 0:a.processing_status)==="completed"&&e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t",children:[e.jsxs("button",{onClick:Ms,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Export Transcript"]}),e.jsx("button",{onClick:Os,disabled:E,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Rendering Video..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Nt,{className:"w-5 h-5"}),"Render & Upload to All Platforms"]})})]}),B&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[e.jsx("h5",{className:"font-medium text-green-900 mb-2",children:"Video Rendered Successfully!"}),e.jsx("p",{className:"text-green-800 mb-3",children:"Your video with subtitles has been processed and uploaded to all platforms."}),B.rendered_video_url&&e.jsxs("a",{href:B.rendered_video_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Ns,{className:"w-4 h-4"}),"Download Rendered Video"]})]})]}),!l&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ge,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Video Available"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Upload a video to start using the subtitle generator."})]})]})]})};function Wt({videoId:l,videoPath:w,title:o,className:a,onThumbnailSet:c}){const[T,V]=h.useState(null),[E,H]=h.useState(!1),[X,y]=h.useState(null),[z,U]=h.useState("suggestions"),{toast:A}=Ze(),W=async()=>{var j,p;if(!l){A({title:"No Video ID",description:"Please provide a video ID to optimize thumbnails.",variant:"destructive"});return}H(!0);try{const g=await(await fetch("/ai/optimize-thumbnails",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((j=document.querySelector('meta[name="csrf-token"]'))==null?void 0:j.getAttribute("content"))||""},body:JSON.stringify({video_id:l,title:o||"Amazing Video",platforms:["youtube","instagram","tiktok"]})})).json();if(g.success)V(g.data),A({title:"Thumbnail Optimization Complete! ðŸŽ¨",description:`AI has analyzed your video and extracted ${((p=g.data.extracted_frames)==null?void 0:p.length)||0} thumbnail frames.`});else throw new Error(g.message||"Failed to optimize thumbnails")}catch(x){console.error("Thumbnail optimization error:",x),A({title:"Optimization Failed",description:"Failed to optimize thumbnails. Please try again.",variant:"destructive"})}finally{H(!1)}},D=async(j,p)=>{var x;if(!l){A({title:"Error",description:"Video ID is required to set thumbnail.",variant:"destructive"});return}try{const M=await(await fetch("/ai/set-video-thumbnail",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({video_id:l,frame_id:j,thumbnail_path:p})})).json();if(M.success)A({title:"Thumbnail Set Successfully! ðŸŽ¯",description:"This thumbnail has been set for all platforms."}),c&&c();else throw new Error(M.message||"Failed to set thumbnail")}catch(g){console.error("Set thumbnail error:",g),A({title:"Setting Failed",description:"Failed to set thumbnail. Please try again.",variant:"destructive"})}};return!T&&!E?e.jsxs(f,{className:$("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",a),children:[e.jsxs(N,{className:"text-center pb-4",children:[e.jsx("div",{className:"mx-auto p-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full w-fit",children:e.jsx(Ae,{className:"w-8 h-8 text-white"})}),e.jsx(v,{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"AI Thumbnail Optimizer"}),e.jsx("p",{className:"text-gray-600",children:"Generate eye-catching thumbnails with AI-powered optimization and CTR predictions"})]}),e.jsxs(b,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Pe,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"CTR Prediction"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(st,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Face Detection"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Es,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Color Analysis"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(zs,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Text Optimization"})]})]}),e.jsxs(F,{onClick:W,disabled:!l,size:"lg",className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(Qe,{className:"w-5 h-5 mr-2"}),"Analyze Video & Extract Thumbnails"]}),!l&&e.jsx("p",{className:"text-sm text-gray-500",children:"Video ID required for thumbnail analysis"})]})]}):E?e.jsx(f,{className:$("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",a),children:e.jsxs(b,{className:"p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto p-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full w-fit animate-pulse",children:e.jsx(Ae,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Optimizing Thumbnails..."}),e.jsx("p",{className:"text-gray-600 mb-4",children:"AI is analyzing frames, detecting faces, and predicting CTR"}),e.jsx("div",{className:"w-full max-w-md mx-auto bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full animate-pulse",style:{width:"75%"}})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-purple-600"}),e.jsx("span",{children:"Extracting frames..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{children:"Analyzing faces..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(G,{className:"w-4 h-4 animate-spin text-green-600"}),e.jsx("span",{children:"Predicting CTR..."})]})]})]})}):e.jsxs(f,{className:$("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",a),children:[e.jsx(N,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg",children:e.jsx(Ae,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(v,{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Thumbnail Optimization Results"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Score: ",T.overall_score,"/100 â€¢ ",T.extracted_frames.length," frames analyzed"]})]})]}),e.jsxs(F,{onClick:W,disabled:E,size:"sm",variant:"outline",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Re-analyze"]})]})}),e.jsx(b,{children:e.jsxs(De,{value:z,onValueChange:U,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-3",children:[e.jsx(Y,{value:"suggestions",children:"Suggestions"}),e.jsx(Y,{value:"platforms",children:"Platform Thumbnail Specifications"}),e.jsx(Y,{value:"testing",children:"A/B Testing"})]}),e.jsx(Q,{value:"suggestions",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:T.thumbnail_suggestions.slice(0,3).map((j,p)=>e.jsx(f,{className:p===0?"border-2 border-gold":"",children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:j.preview_url,alt:`Thumbnail at ${j.timestamp}s`,className:"w-32 h-18 object-cover rounded-lg border-2 border-gray-200",onError:x=>{var M;const g=x.target;g.style.display="none",(M=g.nextElementSibling)==null||M.classList.remove("hidden")}}),e.jsx("div",{className:"w-32 h-18 bg-gray-200 rounded-lg flex items-center justify-center hidden",children:e.jsx(Fs,{className:"w-6 h-6 text-gray-400"})}),p===0&&e.jsxs(C,{className:"absolute -top-2 -right-2 bg-yellow-500 text-black",children:[e.jsx(tt,{className:"w-3 h-3 mr-1"}),"Best"]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("h4",{className:"font-medium",children:["Frame at ",j.timestamp,"s"]}),e.jsxs(C,{variant:"outline",children:[j.predicted_ctr,"% CTR"]}),e.jsxs(C,{variant:"outline",children:[j.confidence_score,"% confidence"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Why this frame:"}),e.jsx("ul",{className:"text-sm text-gray-600",children:j.reasons.map((x,g)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),x]},g))})]}),j.design_scores&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Design Feature Scores:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(j.design_scores).map(([x,g])=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-600 capitalize",children:[x.replace("_"," "),":"]}),e.jsx(C,{variant:"outline",className:$("text-xs px-1.5 py-0.5",g>=80?"border-green-500 text-green-700 bg-green-50":g>=60?"border-yellow-500 text-yellow-700 bg-yellow-50":"border-red-500 text-red-700 bg-red-50"),children:g})]},x))})]})]})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(F,{size:"sm",onClick:()=>D(j.frame_id,j.path),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Set as Thumbnail"]})})]})})},j.frame_id))})}),e.jsx(Q,{value:"platforms",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(T.platform_optimizations).map(([j,p])=>e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs(v,{className:"text-lg capitalize flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),j]})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Specifications"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["Dimensions: ",p.specifications.width,"Ã—",p.specifications.height]}),e.jsxs("div",{children:["Aspect Ratio: ",p.specifications.aspect_ratio]}),e.jsxs("div",{children:["Max Size: ",p.specifications.max_file_size,"KB"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Optimization Focus"}),e.jsx("div",{className:"text-sm space-y-1",children:p.design_adjustments.map((x,g)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),x]},g))})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expected Improvement:"}),e.jsxs(C,{className:"bg-green-100 text-green-800",children:[e.jsx(Ne,{className:"w-3 h-3 mr-1"}),p.expected_improvement]})]})]})]},j))})}),e.jsx(Q,{value:"testing",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:T.ab_test_variants.map(j=>e.jsxs(f,{children:[e.jsx(N,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(v,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"}),j.variant_id.replace("_"," ").toUpperCase()]}),e.jsxs(C,{variant:"outline",children:[j.confidence_level,"% confidence"]})]})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Test Hypothesis"}),e.jsx("p",{className:"text-sm text-gray-600",children:j.test_hypothesis})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Planned Modifications"}),e.jsx("div",{className:"space-y-1",children:j.modifications.map((p,x)=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),p]},x))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expected CTR Increase:"}),e.jsxs(C,{className:"bg-blue-100 text-blue-800",children:["+",j.expected_outcome.expected_ctr_increase]})]})]})]},j.variant_id))})})]})})]})}const Yt=({isOpen:l,onClose:w,videoId:o,videoPath:a,title:c,onThumbnailSet:T})=>{if(!l)return null;const V=()=>{const E=document.createElement("div");E.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",E.textContent="âœ“ Thumbnail optimized successfully!",document.body.appendChild(E),setTimeout(()=>{document.body.contains(E)&&document.body.removeChild(E)},3e3),T&&T()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b bg-gradient-to-r from-purple-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg",children:e.jsx(Ae,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"AI Thumbnail Optimizer"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Create and optimize thumbnails for better engagement"})]})]}),e.jsx("button",{onClick:w,className:"flex items-center justify-center w-8 h-8 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full transition-colors",title:"Close",children:e.jsx(Ke,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx(Wt,{videoId:o,videoPath:a,title:c,onThumbnailSet:V})})]})})},Qt={youtube:it,instagram:lt,tiktok:_e,facebook:_e,snapchat:_e,pinterest:_e,twitter:_e},Zt={pending:We,processing:Ye,success:Ts,failed:Je},ea={pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",success:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"},sa=(l,w)=>{if(!l||!w)return{status:"unknown",color:"text-gray-500",label:"Unknown"};const o=l*w;return o>=1920*1080?{status:"great",color:"text-green-600",label:"1080p+"}:o>=1280*720?{status:"good",color:"text-orange-500",label:"720p"}:{status:"poor",color:"text-red-600",label:"Low Quality"}};function Ja({video:l}){const w=[{title:"My channels",href:"/dashboard"},{title:"Videos",href:"/videos"},{title:l.title,href:`/videos/${l.id}/edit`}],{data:o,setData:a,put:c,processing:T,errors:V}=Is({title:l.title||"",description:l.description||"",tags:l.tags||[],thumbnail:null}),[E,H]=h.useState("overview"),[X,y]=h.useState(!1),[z,U]=h.useState("tikomat"),[A,W]=h.useState(!1),[D,j]=h.useState(!1),[p,x]=h.useState(l.thumbnail||null),[g,M]=h.useState([0]),[Z,O]=h.useState(null),[q,B]=h.useState(null),[de,re]=h.useState([]),[ee,R]=h.useState(!1),[me,ne]=h.useState(!1),[xe,ye]=h.useState(!1),[ve]=h.useState(["youtube","instagram","tiktok","facebook","twitter","pinterest","snapchat"]),se=h.useRef(null),te=sa(l.width,l.height),ie=s=>{s.preventDefault(),c(`/videos/${l.id}`)},le=()=>{y(!0)},he=()=>{Be.delete(`/videos/${l.id}`,{data:{delete_option:z},onSuccess:()=>{Be.visit("/videos")}})},ue=(s,n)=>{confirm(`Are you sure you want to remove this video from ${n}?`)&&Be.delete(`/video-targets/${s}`,{preserveScroll:!0,onSuccess:()=>{},onError:r=>{console.error("Failed to remove video from platform:",r),alert("Failed to remove video from platform. Please try again.")}})},pe=s=>{if(s.platform_url)return s.platform_url;switch(s.platform){case"youtube":return s.platform_video_id?`https://youtube.com/watch?v=${s.platform_video_id}`:null;case"instagram":return s.platform_video_id?`https://instagram.com/p/${s.platform_video_id}`:null;case"tiktok":return s.platform_video_id?`https://tiktok.com/@username/video/${s.platform_video_id}`:null;default:return null}},ge=async()=>{var s;W(!0);try{const n=await fetch("/ai/generate-video-content",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({video_id:l.id,content_type:"title",current_title:o.title})});if(n.ok){const r=await n.json();if(r.success&&r.data.optimized_title){a("title",r.data.optimized_title);const m=r.data.analysis_summary;let S="Title generated based on video content analysis";if(m){const k=[];m.has_transcript&&k.push("audio transcription"),m.scenes_detected>0&&k.push(`${m.scenes_detected} visual scenes`),m.content_category!=="unknown"&&k.push(`${m.content_category} content`),k.length>0&&(S+=`. Analyzed: ${k.join(", ")}.`)}alert(`âœ… AI Title Generated!

${S}`)}}else{const r=await n.json();console.error("Failed to generate AI title:",r),alert(`Failed to generate title: ${r.message||"Unknown error"}`)}}catch(n){console.error("Failed to generate AI title:",n),alert("An error occurred while generating the title. Please try again.")}finally{W(!1)}},K=async()=>{var s;j(!0);try{const n=await fetch("/ai/generate-video-content",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({video_id:l.id,content_type:"description",current_description:o.description})});if(n.ok){const r=await n.json();if(r.success&&r.data.optimized_description){a("description",r.data.optimized_description);const m=r.data.analysis_summary;let S="Description generated based on video content analysis";if(m){const k=[];m.has_transcript&&k.push("audio transcription"),m.scenes_detected>0&&k.push(`${m.scenes_detected} visual scenes`),m.content_category!=="unknown"&&k.push(`${m.content_category} content`),k.length>0&&(S+=`. Analyzed: ${k.join(", ")}.`)}alert(`âœ… AI Description Generated!

${S}`)}}else{const r=await n.json();console.error("Failed to generate AI description:",r),alert(`Failed to generate description: ${r.message||"Unknown error"}`)}}catch(n){console.error("Failed to generate AI description:",n),alert("An error occurred while generating the description. Please try again.")}finally{j(!1)}},je=s=>{var r;const n=(r=s.target.files)==null?void 0:r[0];if(n){O(n);const m=new FileReader;m.onload=S=>{var k;x((k=S.target)==null?void 0:k.result)},m.readAsDataURL(n)}},ae=s=>{B(s)};h.useEffect(()=>{const s={title:l.title||"",description:l.description||"",tags:l.tags||[]},n=JSON.stringify(o)!==JSON.stringify(s);ne(n)},[o,l]);const fe=async()=>{ye(!0);const s=async(n=0)=>{var r,m,S;try{const k=((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||((m=document.querySelector('input[name="_token"]'))==null?void 0:m.getAttribute("value"))||"";if(!k)throw new Error("CSRF token not found");const Me=await fetch("/ai/analyze-video-tags",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":k,Accept:"application/json"},body:JSON.stringify({video_id:l.id,title:o.title||"",description:o.description||""})});if(Me.status===419&&n===0){console.log("CSRF token expired, refreshing...");const Ee=await fetch("/");if(Ee.ok){const Le=await Ee.text(),Oe=(S=new DOMParser().parseFromString(Le,"text/html").querySelector('meta[name="csrf-token"]'))==null?void 0:S.getAttribute("content");if(Oe){const Re=document.querySelector('meta[name="csrf-token"]');return Re&&Re.setAttribute("content",Oe),s(1)}}}return Me}catch(k){if(n===0)return console.log("Request failed, retrying once...",k),s(1);throw k}};try{const n=await s();if(n.ok){const r=await n.json();if(console.log("Tag generation response:",r),r.success&&r.data&&r.data.analysis.tags)a("tags",r.data.analysis.tags);else{console.warn("Unexpected response structure:",r);const m=document.createElement("div");m.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",m.textContent="âš ï¸ Tag generation failed - unexpected response",document.body.appendChild(m),setTimeout(()=>{document.body.contains(m)&&document.body.removeChild(m)},5e3)}}else{const r=await n.text();console.error("HTTP Error:",n.status,n.statusText,r);const m=document.createElement("div");m.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",m.textContent=`âš ï¸ Tag generation failed - Server error (${n.status})`,document.body.appendChild(m),setTimeout(()=>{document.body.contains(m)&&document.body.removeChild(m)},5e3)}}catch(n){console.error("Failed to generate tags:",n);const r=document.createElement("div");r.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",r.textContent="âš ï¸ Tag generation failed - Network error",document.body.appendChild(r),setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},5e3)}finally{ye(!1)}},ce=s=>{o.tags.includes(s)||a("tags",[...o.tags,s])},be=s=>{a("tags",o.tags.filter(n=>n!==s))},d=async()=>{var s;try{if((await fetch(`/videos/${l.id}/update-platforms`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({title:o.title,description:o.description,tags:o.tags})})).ok){ne(!1);const r=document.createElement("div");r.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",r.textContent="âœ“ All platforms updated successfully!",document.body.appendChild(r),setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},3e3)}}catch(n){console.error("Failed to update platforms:",n)}};return e.jsxs(Bs,{breadcrumbs:w,children:[e.jsx(Vs,{title:`Edit: ${l.title}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Ds,{href:"/videos",children:e.jsxs(F,{variant:"outline",size:"sm",children:[e.jsx(at,{className:"mr-2 h-4 w-4"}),"Back to Videos"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:l.title}),e.jsx("p",{className:"text-muted-foreground",children:"Edit and optimize your video with AI-powered tools"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(F,{variant:"outline",onClick:le,className:"text-red-600 hover:text-red-700",children:[e.jsx(rt,{className:"mr-2 h-4 w-4"}),"Delete"]})})]}),me&&e.jsx(f,{className:"border-blue-200 bg-blue-50",children:e.jsx(b,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-full",children:e.jsx(G,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Unsaved Changes Detected"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Update all connected platforms with your changes"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{onClick:d,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Update All Platforms"]}),e.jsxs(F,{variant:"outline",onClick:()=>{},children:[e.jsx(Mt,{className:"w-4 h-4 mr-2"}),"Manage Platforms"]})]})]})})}),e.jsxs(De,{value:E,onValueChange:H,className:"w-full",children:[e.jsxs(qe,{className:"grid w-full grid-cols-2",children:[e.jsx(Y,{value:"overview",children:"Overview/Edit"}),e.jsx(Y,{value:"performance",children:"Performance"})]}),e.jsxs(Q,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(N,{children:e.jsx(v,{className:"flex items-center gap-2",children:"Video Editor"})}),e.jsx(b,{children:e.jsx(He,{children:e.jsx(Jt,{videoPath:l.video_path||l.file_path||"",videoId:l.id,videoTitle:l.title})})})]}),e.jsxs(f,{children:[e.jsx(N,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),"AI Analysis"]})}),e.jsxs(b,{children:[e.jsx(He,{children:e.jsx(Ht,{videoId:l.id,videoPath:l.video_path||l.file_path,onAnalysisComplete:ae})}),q&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Category"}),e.jsx("p",{className:"text-lg",children:q.category||"Entertainment"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Mood"}),e.jsx("p",{className:"text-lg",children:q.mood||"Positive"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"AI Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(q.tags||["creative","engaging","trending"]).map((s,n)=>e.jsx(C,{variant:"secondary",className:"text-xs",children:s},n))})]})]})]})]}),e.jsxs(f,{children:[e.jsxs(N,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(nt,{className:"w-5 h-5"}),"AI Suggestions"]}),e.jsx(Ue,{children:"Most important optimization recommendations"})]}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 border border-orange-200 bg-orange-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ne,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-orange-900",children:"Increase Engagement"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Add a call-to-action in the first 5 seconds to boost viewer retention."})]})]})}),e.jsx("div",{className:"p-4 border border-blue-200 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Pe,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Optimize Thumbnail"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Consider adding text overlay to your thumbnail to increase click-through rate."})]})]})}),e.jsx("div",{className:"p-4 border border-green-200 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(fs,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-900",children:"Add More Tags"}),e.jsx("p",{className:"text-sm text-green-700",children:"Include platform-specific hashtags to improve discoverability."})]})]})})]})})]}),l.targets&&l.targets.length>0&&e.jsxs(f,{children:[e.jsxs(N,{children:[e.jsx(v,{children:"Publishing Status"}),e.jsx(Ue,{children:"Current status for each platform"})]}),e.jsx(b,{children:e.jsx("div",{className:"space-y-4",children:l.targets.map(s=>{const n=Zt[s.status],r=Qt[s.platform],m=pe(s);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(r,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:s.platform}),s.publish_at&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Scheduled: ",new Date(s.publish_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{className:ea[s.status],children:[e.jsx(n,{className:"w-3 h-3 mr-1"}),s.status]}),m&&s.status==="success"&&e.jsx("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:e.jsx(bt,{className:"w-4 h-4"})}),s.status==="success"&&e.jsxs(F,{size:"sm",variant:"outline",onClick:()=>ue(s.id,s.platform),className:"text-red-600 hover:text-red-700",children:[e.jsx(Ke,{className:"w-3 h-3 mr-1"}),"Remove"]})]})]},s.id)})})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:ie,className:"space-y-6",children:[e.jsxs(f,{children:[e.jsx(N,{children:e.jsx(v,{children:"Title"})}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(gs,{value:o.title,onChange:s=>a("title",s.target.value),placeholder:"Enter video title",className:"flex-1"}),e.jsx(F,{type:"button",variant:"outline",size:"sm",onClick:ge,disabled:A,children:A?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full"}):e.jsx(we,{className:"w-4 h-4"})})]}),V.title&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:V.title})]})]}),e.jsxs(f,{children:[e.jsx(N,{children:e.jsx(v,{children:"Description"})}),e.jsxs(b,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(qs,{value:o.description,onChange:s=>a("description",s.target.value),placeholder:"Enter video description",rows:4}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(F,{type:"button",variant:"outline",size:"sm",onClick:K,disabled:D,children:[D?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(we,{className:"w-4 h-4 mr-2"}),"AI Generate"]})})]}),V.description&&e.jsx("p",{className:"text-sm text-red-600",children:V.description})]})]}),e.jsxs(f,{children:[e.jsx(N,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"w-5 h-5"}),"Tags"]})}),e.jsx(b,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.tags.map((s,n)=>e.jsxs(C,{variant:"secondary",className:"flex items-center gap-1",children:[s,e.jsx("button",{type:"button",onClick:()=>be(s),className:"ml-1 text-xs hover:text-red-600",children:e.jsx(Ke,{className:"w-3 h-3"})})]},n)),o.tags.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No tags added yet"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(gs,{placeholder:"Add a tag...",onKeyDown:s=>{if(s.key==="Enter"){s.preventDefault();const n=s.currentTarget.value.trim();n&&(ce(n),s.currentTarget.value="")}},className:"flex-1"}),e.jsxs(F,{type:"button",variant:"outline",onClick:fe,disabled:xe,children:[xe?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"AI Generate"]})]}),o.tags.length>0&&e.jsx("p",{className:"text-xs text-gray-500",children:"Tags help categorize your video and improve discoverability across platforms"})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(F,{type:"submit",disabled:T,children:[T?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(zt,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]}),e.jsxs(f,{children:[e.jsx(N,{children:e.jsx(v,{children:"Video Details"})}),e.jsxs(b,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Duration"}),e.jsx("p",{className:"text-lg",children:l.formatted_duration})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Resolution"}),e.jsx("p",{className:`text-lg ${te.color}`,children:l.width&&l.height?`${l.width}x${l.height}`:"Unknown"}),e.jsx("p",{className:`text-sm ${te.color}`,children:te.label})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Upload Date"}),e.jsx("p",{className:"text-lg",children:new Date(l.created_at).toLocaleString()})]})]})]})]})]}),e.jsxs(f,{children:[e.jsxs(N,{children:[e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Thumbnail Optimization"]}),e.jsx(Ue,{children:"Set your video thumbnail using AI optimization or custom upload"})]}),e.jsxs(b,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(F,{onClick:()=>R(!0),className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"AI Optimize Thumbnail"]}),e.jsxs(F,{variant:"outline",onClick:()=>{var s;return(s=se.current)==null?void 0:s.click()},children:[e.jsx(ct,{className:"w-4 h-4 mr-2"}),"Upload Custom Thumbnail"]}),e.jsx("input",{ref:se,type:"file",accept:"image/*",onChange:je,className:"hidden"})]}),p&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-700",children:"âœ“ Thumbnail has been set for this video"})})]})]})]}),e.jsx(Q,{value:"performance",className:"space-y-6",children:e.jsx(He,{children:e.jsx(Xt,{videoId:l.id})})})]}),e.jsx(ws,{open:X,onOpenChange:y,children:e.jsxs(_s,{children:[e.jsxs(Ss,{children:[e.jsx(ks,{children:"Delete Video"}),e.jsx(Cs,{children:"This action cannot be undone. Choose what you want to delete:"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"delete-tikomat",name:"delete-option",value:"tikomat",checked:z==="tikomat",onChange:s=>U(s.target.value)}),e.jsx(js,{htmlFor:"delete-tikomat",children:"Delete only from Tikomat (keep on social platforms)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"delete-all",name:"delete-option",value:"all",checked:z==="all",onChange:s=>U(s.target.value)}),e.jsx(js,{htmlFor:"delete-all",children:"Delete from everywhere (Tikomat + all social platforms)"})]})]}),e.jsxs(Ls,{children:[e.jsx(F,{variant:"outline",onClick:()=>y(!1),children:"Cancel"}),e.jsx(F,{variant:"destructive",onClick:he,children:"Delete Video"})]})]})}),e.jsx(Yt,{isOpen:ee,onClose:()=>R(!1),videoId:l.id,videoPath:l.video_path||l.file_path||"",title:o.title,onThumbnailSet:()=>{x("optimized"),R(!1)}})]})]})}export{Ja as default};
