import{r as c,j as e,q as At,v as Ht,$ as Kt,Y as Gt,m as Ye}from"./app-CP_QQd94.js";import{c as A,a as He,B as O}from"./button-Ba3RMufU.js";import{C as B,b as G,c as J,a as U,d as St}from"./card-C1CBXOz4.js";import{I as kt}from"./input-D_n_dTgs.js";import{L as Ct}from"./label-hlaYujug.js";import{T as Jt}from"./textarea-DMMM_S3e.js";import{B as ae}from"./badge-DGODmhI0.js";import{D as Yt,b as Qt,c as Zt,d as es,e as ts,f as ss}from"./dialog-Ceyyqp8u.js";import{X as ke,A as ns,C as zt,d as rs}from"./app-layout-BNm4WRN1.js";import{P as tt}from"./play-7mvREqrW.js";import{C as as,P as $t}from"./palette-BNdDq2Aj.js";import{T as is,a as os,b as Qe,c as Ze,E as ls}from"./ErrorBoundary-ClCgkz82.js";import{E as cs}from"./eye-DPyNXcCu.js";import{U as ds}from"./user-CFVfTx3q.js";import{S as Rt,B as et}from"./sparkles-Bke0-Zui.js";import{R as Ke}from"./refresh-cw-CyMm5zGx.js";import{S as us}from"./star-BeBnv4Hw.js";import{T as Tt}from"./target-W5qrkMkj.js";import{T as ms}from"./trending-up-DTrRZzDg.js";import{T as hs}from"./test-tube-blBWX7DM.js";import{A as ps}from"./arrow-left-DH6slDnL.js";import{T as xs}from"./trash-2-C1hH5Bag.js";import{F as gs}from"./file-text-D3paSJSj.js";import{U as _t}from"./upload-D2a5B6Qh.js";import{C as fs}from"./circle-check-big-DcivBXeo.js";import{C as bs}from"./clock-BwqtwhDE.js";import{V as Ae}from"./video-ClWl8esV.js";import{I as ys}from"./instagram-CtlM0DFk.js";import{Y as js}from"./youtube-VBCh9oaF.js";import{E as vs}from"./external-link-Dy0a86_R.js";import"./index-D3mh_99j.js";import"./index-BOly8kqM.js";import"./settings-BUk1dvbS.js";import"./shield-BfEDuXSB.js";import"./triangle-alert-94XOIYO8.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Ns=A("AlignCenter",ws);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],ks=A("AlignLeft",Ss);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Ts=A("AlignRight",Cs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],Fs=A("Bold",_s);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Es=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Ms=A("Download",Es);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],zs=A("Film",As);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],ge=A("Image",$s);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],Os=A("Italic",Rs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],Is=A("Languages",Ps);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],Ls=A("Maximize",Ds);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],Ft=A("Mic",qs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],Us=A("Minimize",Bs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],Xs=A("Pause",Ws);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Hs=A("Settings2",Vs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],Et=A("Tag",Ks);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],st=A("Type",Gs);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Js=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],Ys=A("Underline",Js);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],Zs=A("WandSparkles",Qs),en=({subtitle:a,currentTime:j,position:_,onMouseDown:b,onDoubleClick:k,editingSubtitle:E,editingText:X,onTextChange:r,onSaveEdit:M,onCancelEdit:H})=>{var x;const ie=c.useRef(null),[ee,Y]=c.useState(new Set);c.useEffect(()=>{if(!a.words||a.words.length===0){Y(new Set);return}const m=new Set;a.words.forEach((v,w)=>{j>=v.start_time&&j<=v.end_time&&m.add(w)}),Y(m)},[j,a.words]);const P=()=>!a.words||a.words.length===0?e.jsx("span",{className:"subtitle-text",children:a.text}):a.words.map((m,v)=>{var oe,N,fe,le,de;const w=ee.has(v),$=v===a.words.length-1;return e.jsxs("span",{className:`subtitle-word ${w?"active":""}`,style:{color:w?((oe=a.style)==null?void 0:oe.color)||"#FFFFFF":((N=a.style)==null?void 0:N.color)||"#FFFFFF",fontWeight:w||(fe=a.style)!=null&&fe.bold?"bold":"normal",fontStyle:(le=a.style)!=null&&le.italic?"italic":"normal",textDecoration:(de=a.style)!=null&&de.underline?"underline":"none",transition:"all 0.1s ease-in-out",display:"inline-block",marginRight:$?"0":"0.1em"},children:[m.word,!$&&" "]},`${m.word}-${v}`)}),Q=()=>{const m=Math.max(15,Math.min(85,_.x)),v=Math.max(15,Math.min(85,_.y));return{x:m,y:v}},z=()=>{var $,oe;const m=a.style||{},v=Q(),w=Math.max(16,Math.min(48,m.fontSize||24));return{position:"absolute",left:`${v.x}%`,top:`${v.y}%`,transform:"translate(-50%, -50%)",fontFamily:m.fontFamily||"Arial, sans-serif",fontSize:`${w}px`,fontWeight:m.fontWeight||"bold",color:m.color||"#FFFFFF",background:($=m.backgroundColor)!=null&&$.includes("gradient")?m.backgroundColor:void 0,backgroundColor:(oe=m.backgroundColor)!=null&&oe.includes("gradient")?void 0:m.backgroundColor||"rgba(0, 0, 0, 0.7)",textAlign:m.textAlign||"center",borderRadius:`${m.borderRadius||4}px`,padding:`${m.padding||8}px`,textShadow:m.textShadow||"2px 2px 4px rgba(0, 0, 0, 0.5)",fontStyle:m.italic?"italic":"normal",textDecoration:m.underline?"underline":"none",cursor:"move",userSelect:"none",boxShadow:(m==null?void 0:m.preset)==="neon"?"none":void 0,whiteSpace:"normal",wordWrap:"break-word",maxWidth:"80vw",minWidth:"200px",lineHeight:"1.2",letterSpacing:"0.5px",backdropFilter:"blur(2px)",zIndex:1e3,border:E?"2px solid #3b82f6":"none"}};return e.jsx("div",{ref:ie,style:z(),onMouseDown:b,onDoubleClick:k,className:`subtitle-container ${((x=a.style)==null?void 0:x.preset)||""}`,children:E?e.jsx("textarea",{value:X||"",onChange:m=>r==null?void 0:r(m.target.value),onKeyDown:m=>{m.key==="Enter"&&!m.shiftKey?(m.preventDefault(),M==null||M()):m.key==="Escape"&&(H==null||H())},onBlur:M,className:"subtitle-editor",style:{background:"transparent",border:"none",outline:"none",textAlign:"center",color:"inherit",fontSize:"inherit",fontFamily:"inherit",fontWeight:"inherit",width:"100%",minWidth:"200px",resize:"none",overflow:"hidden",whiteSpace:"normal",wordWrap:"break-word",lineHeight:"inherit",letterSpacing:"inherit",padding:"0",margin:"0"},rows:2,autoFocus:!0}):e.jsx("div",{className:"subtitle-content",style:{textAlign:"inherit",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:"0.1em",lineHeight:"inherit",letterSpacing:"inherit"},children:P()})})},Mt=a=>{if(a==="transparent")return"#000000";if(a.startsWith("rgba(")){const _=a.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(_){const b=parseInt(_[1]).toString(16).padStart(2,"0"),k=parseInt(_[2]).toString(16).padStart(2,"0"),E=parseInt(_[3]).toString(16).padStart(2,"0");return`#${b}${k}${E}`}}if(a.startsWith("rgb(")){const _=a.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);if(_){const b=parseInt(_[1]).toString(16).padStart(2,"0"),k=parseInt(_[2]).toString(16).padStart(2,"0"),E=parseInt(_[3]).toString(16).padStart(2,"0");return`#${b}${k}${E}`}}const j={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#008000",blue:"#0000ff",yellow:"#ffff00",cyan:"#00ffff",magenta:"#ff00ff",silver:"#c0c0c0",gray:"#808080",maroon:"#800000",olive:"#808000",lime:"#00ff00",aqua:"#00ffff",teal:"#008080",navy:"#000080",fuchsia:"#ff00ff",purple:"#800080"};return j[a.toLowerCase()]?j[a.toLowerCase()]:a.startsWith("#")&&/^#[0-9A-Fa-f]{6}$/.test(a)?a:"#000000"},tn=({videoPath:a,videoId:j,videoTitle:_,onSubtitleGenerated:b,hideSubtitleControls:k=!1})=>{var ct,dt,ut,mt,ht,pt,xt,gt,ft,bt,yt,jt,vt,wt;const{props:E}=At(),X=((ct=E.app)==null?void 0:ct.env)==="local",[r,M]=c.useState(null),[H,ie]=c.useState(!1),[ee,Y]=c.useState(!1),[P,Q]=c.useState(!1),[z,x]=c.useState(!1),m=c.useRef(null),[v,w]=c.useState({}),[$,oe]=c.useState("en"),[N,fe]=c.useState(null),[le,de]=c.useState("standard"),[te,Ce]=c.useState(null),[se,be]=c.useState(null),[ze,nt]=c.useState(null),[ue,me]=c.useState(!1),[R,Ge]=c.useState(0),[Z,ye]=c.useState(0),[rt,Je]=c.useState(!1),[je,$e]=c.useState(new Set),[he,pe]=c.useState(null),[Te,ve]=c.useState(""),[I,_e]=c.useState(null),[Re,Oe]=c.useState({x:0,y:0}),C=c.useRef(null),Pe=c.useRef(null),Fe=c.useRef(null),Ie=c.useRef(null),[D,De]=c.useState(null),[F,we]=c.useState(null),[Ne,Le]=c.useState(!1),[qe,Be]=c.useState(null),[xe,n]=c.useState(null),[o,i]=c.useState(!1),d={standard:{name:"Standard",style:{fontFamily:"Arial, sans-serif",fontSize:32,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"rgba(0, 0, 0, 0.7)",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:4,padding:8,textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)",preset:"standard"}},"no-background":{name:"No Background",style:{fontFamily:"Arial, sans-serif",fontSize:36,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"3px 3px 6px rgba(0, 0, 0, 0.8)",preset:"no-background"}},neon:{name:"Neon",style:{fontFamily:"Impact, Arial Black, sans-serif",fontSize:40,fontWeight:"bold",color:"#00FFFF",backgroundColor:"rgba(0, 20, 40, 0.8)",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:8,padding:12,textShadow:"0 0 10px #00FFFF, 0 0 20px #00FFFF",preset:"neon"}},confetti:{name:"Confetti",style:{fontFamily:"Comic Sans MS, cursive",fontSize:38,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"2px 2px 0px #000000, -2px -2px 0px #000000, 2px -2px 0px #000000, -2px 2px 0px #000000",preset:"confetti"}},bubbles:{name:"Bubbles",style:{fontFamily:"Trebuchet MS, sans-serif",fontSize:36,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"3px 3px 6px rgba(0, 0, 0, 0.8)",preset:"bubbles"}}},y=d.standard.style;c.useEffect(()=>(S(),()=>{te&&clearInterval(te)}),[]),c.useEffect(()=>{j&&(console.log("Checking existing subtitles for video ID:",j),g())},[j]),c.useEffect(()=>{r!=null&&r.subtitles&&r.subtitles.length>0&&i(!0)},[r==null?void 0:r.subtitles]);const g=async()=>{var t,s;if(!j){console.log("No video ID available, skipping subtitle check");return}console.log("Checking for existing subtitles for video:",j);try{const h=await(await fetch("/ai/subtitle-check",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({video_id:j})})).json();if(console.log("Subtitle check response:",h),h.success&&h.data&&h.data.processing_status==="completed"){console.log("Found existing subtitles, loading them:",h.data);const f=((s=h.data.subtitles)==null?void 0:s.map(p=>({...p,style:p.style||y,position:p.position||{x:50,y:85}})))||[];M({...h.data,original_video_path:a,subtitles:f}),console.log("Loaded subtitles with styles:",f),b&&b(),h.data.generation_id&&T(h.data.generation_id)}else console.log("No existing subtitles found for this video")}catch(l){console.error("Error checking existing subtitles:",l)}},T=async t=>{try{console.log("Loading word timing data for generation:",t);const s=await fetch(`/ai/word-timing/${t}`,{method:"GET",headers:{Accept:"application/json"}});if(s.ok){const l=await s.json();l.success&&l.data?(console.log("Word timing data loaded:",l.data),nt(l.data),M(h=>{var ne,re,Ve,Me;if(!h||!h.subtitles)return h;const f=new Map;l.data.words.forEach(q=>{f.has(q.subtitle_id)||f.set(q.subtitle_id,[]),f.get(q.subtitle_id).push({word:q.word,start_time:q.start_time,end_time:q.end_time,confidence:q.confidence})});const p=h.subtitles.map(q=>{const Nt=f.get(q.id)||[];return console.log(`Merging words for subtitle ${q.id}: ${Nt.length} words`),{...q,words:Nt}});console.log("Updated subtitles with word timing:",p),console.log("First subtitle word count after merge:",((re=(ne=p[0])==null?void 0:ne.words)==null?void 0:re.length)||0),console.log("First subtitle words sample:",(Me=(Ve=p[0])==null?void 0:Ve.words)==null?void 0:Me.slice(0,3));const u=p.filter(q=>q.words&&q.words.length>0);return console.log(`Subtitles with word timing: ${u.length}/${p.length}`),{...h,subtitles:p}})):console.log("No word timing data available")}else console.log("Word timing data not found or not accessible")}catch(s){console.error("Error loading word timing data:",s)}};c.useEffect(()=>{if(r&&r.processing_status==="processing"){const t=setInterval(()=>{ce()},2e3);return Ce(t),()=>clearInterval(t)}else te&&(clearInterval(te),Ce(null))},[r==null?void 0:r.processing_status]),c.useEffect(()=>{const t=C.current;if(!t)return;const s=()=>{Ge(t.currentTime)},l=()=>{ye(t.duration)};return t.addEventListener("timeupdate",s),t.addEventListener("loadedmetadata",l),()=>{t.removeEventListener("timeupdate",s),t.removeEventListener("loadedmetadata",l)}},[]);const S=async()=>{try{const s=await(await fetch("/ai/subtitle-languages")).json();s.success&&w(s.data)}catch(t){console.error("Error loading languages:",t)}},W=async()=>{var t;if(!j){alert("No video ID available for subtitle generation. Please ensure the video is properly uploaded.");return}ie(!0);try{const l=await(await fetch("/ai/subtitle-generate",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({video_id:j,language:$})})).json();l.success?M({...l.data,original_video_path:a}):(console.error("Generation failed:",l.message),alert(`Subtitle generation failed: ${l.message}`))}catch(s){console.error("Error starting generation:",s)}finally{ie(!1)}},ce=async()=>{var t;if(r!=null&&r.generation_id)try{const l=await(await fetch("/ai/subtitle-progress",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:r.generation_id})})).json();l.success&&M(h=>{const f={...h,...l.data,original_video_path:(h==null?void 0:h.original_video_path)||a};return l.data.processing_status==="completed"&&l.data.generation_id&&!ze&&(T(l.data.generation_id),b&&b()),f})}catch(s){console.error("Error polling progress:",s)}},K=()=>{const t=C.current;t&&(ue?t.pause():t.play(),me(!ue))},Ue=t=>{const s=C.current,l=Pe.current;if(!s||!l)return;const h=l.getBoundingClientRect(),p=(t.clientX-h.left)/h.width*Z;s.currentTime=p,Ge(p)},We=()=>r!=null&&r.subtitles&&r.subtitles.find(t=>R>=t.start_time&&R<=t.end_time)||null,Ot=async()=>{var l;const t=C.current,s=Ie.current;if(!t||!s||!j){alert("Unable to capture frame. Please ensure video is loaded.");return}Q(!0);try{s.width=t.videoWidth,s.height=t.videoHeight;const h=s.getContext("2d");if(!h)throw new Error("Unable to get canvas context");h.drawImage(t,0,0,s.width,s.height);const f=await new Promise((re,Ve)=>{s.toBlob(Me=>{Me?re(Me):Ve(new Error("Failed to create blob from canvas"))},"image/jpeg",.8)}),p=new FormData;p.append("video_id",j.toString()),p.append("frame_id",`frame_${Date.now()}`),p.append("thumbnail",f,"thumbnail.jpg"),p.append("current_time",R.toString());const ne=await(await fetch("/ai/set-video-thumbnail-from-frame",{method:"POST",headers:{"X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:p})).json();if(ne.success){const re=document.createElement("div");re.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",re.textContent="✓ Thumbnail set successfully!",document.body.appendChild(re),setTimeout(()=>{document.body.removeChild(re)},3e3)}else alert(`Failed to set thumbnail: ${ne.message}`)}catch(h){console.error("Error setting thumbnail:",h),alert("Failed to capture and set thumbnail. Please try again.")}finally{Q(!1)}},at=t=>{const s=r==null?void 0:r.subtitles.find(l=>l.id===t);s&&(pe(t),ve(s.text))},Pt=async()=>{var t;if(!(!he||!r))try{if((await(await fetch("/ai/subtitle-update-text",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:r.generation_id,subtitle_id:he,text:Te})})).json()).success){const h=r.subtitles.map(f=>f.id===he?{...f,text:Te}:f);M({...r,subtitles:h}),pe(null),ve("")}}catch(s){console.error("Error updating subtitle:",s)}},V=async(t,s)=>{var l;if(r)try{if((await(await fetch("/ai/subtitle-update-style",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({generation_id:r.generation_id,subtitle_id:t,style:s})})).json()).success){const p=r.subtitles.map(u=>u.id===t?{...u,style:{...u.style,...s}}:u);M({...r,subtitles:p})}}catch(h){console.error("Error updating subtitle style:",h)}},It=async(t,s)=>{var l;if(r)try{if((await(await fetch("/ai/subtitle-update-position",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({generation_id:r.generation_id,subtitle_id:t,position:s})})).json()).success){const p=r.subtitles.map(u=>u.id===t?{...u,position:s}:u);M({...r,subtitles:p})}}catch(h){console.error("Error updating subtitle position:",h)}},Dt=async t=>{var l;if(!r)return;const s=d[t];if(s)try{(await(await fetch("/ai/apply-style-to-all-subtitles",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({generation_id:r.generation_id,style:s.style})})).json()).success&&(M(p=>p?{...p,subtitles:p.subtitles.map(u=>({...u,style:{...s.style}}))}:null),de(t))}catch(h){console.error("Failed to apply style to all subtitles:",h)}},Lt=(t,s)=>{if(t.preventDefault(),t.stopPropagation(),!(r==null?void 0:r.subtitles.find(ne=>ne.id===s))||!C.current)return;_e(s),C.current.getBoundingClientRect();const f=t.target.getBoundingClientRect(),p=f.left+f.width/2,u=f.top+f.height/2;Oe({x:t.clientX-p,y:t.clientY-u})},qt=t=>{if(!I||!C.current)return;const s=C.current.getBoundingClientRect(),l=t.clientX-Re.x,h=t.clientY-Re.y,f=(l-s.left)/s.width*100,p=(h-s.top)/s.height*100,u=Math.max(5,Math.min(95,f)),ne=Math.max(5,Math.min(95,p));It(I,{x:u,y:ne})},it=()=>{_e(null),Oe({x:0,y:0})},Bt=async()=>{var t;if(r!=null&&r.generation_id)try{const l=await(await fetch("/ai/subtitle-export",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:r.generation_id,format:"srt"})})).json();l.success&&window.open(l.data.file_url,"_blank")}catch(s){console.error("Error exporting transcript:",s)}},ot=async()=>{var t;if(j)try{const l=await(await fetch("/ai/rendered-video-status",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({video_id:j})})).json();l.success&&be({status:l.status,rendered_video_path:l.rendered_video_path})}catch{}};c.useEffect(()=>{let t=null;return(se==null?void 0:se.status)==="processing"&&(t=setInterval(ot,3e3)),()=>{t&&clearInterval(t)}},[se==null?void 0:se.status,j]),c.useEffect(()=>{ot()},[j]);const Ut=async()=>{var t;if(r!=null&&r.generation_id){Y(!0);try{const l=await(await fetch("/ai/subtitle-render-video",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((t=document.querySelector('meta[name="csrf-token"]'))==null?void 0:t.getAttribute("content"))||""},body:JSON.stringify({generation_id:r.generation_id,video_id:j})})).json();l.success?be({status:"processing",rendered_video_path:null}):alert(`Failed to render video: ${l.message}`)}catch(s){console.error("Error rendering video:",s),alert("An error occurred while rendering the video. Please try again.")}finally{Y(!1)}}},Se=t=>{const s=Math.floor(t/60),l=Math.floor(t%60);return`${s}:${l.toString().padStart(2,"0")}`},Wt=async()=>{var t,s,l;try{z?document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen():(t=m.current)!=null&&t.requestFullscreen?await m.current.requestFullscreen():(s=m.current)!=null&&s.webkitRequestFullscreen?await m.current.webkitRequestFullscreen():(l=m.current)!=null&&l.msRequestFullscreen&&await m.current.msRequestFullscreen()}catch(h){console.error("Error toggling fullscreen:",h)}};c.useEffect(()=>{const t=()=>{const s=!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement);x(s)};return document.addEventListener("fullscreenchange",t),document.addEventListener("webkitfullscreenchange",t),document.addEventListener("msfullscreenchange",t),()=>{document.removeEventListener("fullscreenchange",t),document.removeEventListener("webkitfullscreenchange",t),document.removeEventListener("msfullscreenchange",t)}},[]);const L=We(),Xe=()=>{if(C.current&&Fe.current){const t=C.current.getBoundingClientRect(),s=Fe.current.getBoundingClientRect();if(s){const l={width:t.width,height:t.height,top:t.top-s.top,left:t.left-s.left};De(F?{width:l.width*(F.width/100),height:l.height*(F.height/100),top:l.top+l.height*(F.y/100),left:l.left+l.width*(F.x/100)}:l)}}},Xt=()=>{F||we({x:10,y:20,width:80,height:60})};c.useEffect(()=>{r!=null&&r.custom_bounds&&we(r.custom_bounds)},[r]);const Ee=(t,s)=>{t.preventDefault(),t.stopPropagation(),!(!F||!C.current)&&(Be(s),C.current.getBoundingClientRect(),n({x:t.clientX,y:t.clientY,bounds:{...F}}))},Vt=t=>{if(!qe||!xe||!C.current)return;const s=C.current.getBoundingClientRect(),l=t.clientX-xe.x,h=t.clientY-xe.y,f=l/s.width*100,p=h/s.height*100;let u={...xe.bounds};switch(qe){case"move":u.x=Math.max(0,Math.min(100-u.width,u.x+f)),u.y=Math.max(0,Math.min(100-u.height,u.y+p));break;case"resize-tl":u.x=Math.max(0,Math.min(u.x+u.width-10,u.x+f)),u.y=Math.max(0,Math.min(u.y+u.height-10,u.y+p)),u.width=Math.max(10,Math.min(100-u.x,u.width-f)),u.height=Math.max(10,Math.min(100-u.y,u.height-p));break;case"resize-tr":u.y=Math.max(0,Math.min(u.y+u.height-10,u.y+p)),u.width=Math.max(10,Math.min(100-u.x,u.width+f)),u.height=Math.max(10,Math.min(100-u.y,u.height-p));break;case"resize-bl":u.x=Math.max(0,Math.min(u.x+u.width-10,u.x+f)),u.width=Math.max(10,Math.min(100-u.x,u.width-f)),u.height=Math.max(10,Math.min(100-u.y,u.height+p));break;case"resize-br":u.width=Math.max(10,Math.min(100-u.x,u.width+f)),u.height=Math.max(10,Math.min(100-u.y,u.height+p));break}we(u)},lt=()=>{Be(null),n(null)};return c.useEffect(()=>{const t=()=>{setTimeout(Xe,50)},s=()=>Xe();return C.current&&(C.current.addEventListener("loadedmetadata",s),C.current.addEventListener("loadeddata",s)),window.addEventListener("resize",t),setTimeout(Xe,100),()=>{C.current&&(C.current.removeEventListener("loadedmetadata",s),C.current.removeEventListener("loadeddata",s)),window.removeEventListener("resize",t)}},[a,F]),c.useEffect(()=>{setTimeout(Xe,100)},[z,F]),c.useEffect(()=>{if(!(L!=null&&L.words)||L.words.length===0){$e(new Set);return}const t=new Set;L.words.forEach((s,l)=>{R>=s.start_time&&R<=s.end_time&&t.add(l)}),$e(t)},[R,L==null?void 0:L.words]),e.jsxs("div",{ref:m,className:`bg-background shadow-sm border ${z?"h-screen w-screen flex flex-col":"rounded-lg"}`,children:[e.jsx("canvas",{ref:Ie,style:{display:"none"}}),e.jsx("div",{className:"p-6 border-b bg-gradient-to-r from-muted/50 to-muted/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center justify-between w-full",children:e.jsxs("button",{onClick:Wt,className:"flex items-center gap-2 px-3 py-2 bg-muted hover:bg-muted/80 text-foreground rounded-lg transition-colors",title:z?"Exit fullscreen":"Enter fullscreen",children:[z?e.jsx(Us,{className:"w-4 h-4"}):e.jsx(Ls,{className:"w-4 h-4"}),z?"Exit Fullscreen":"Fullscreen"]})}),!r&&!k&&e.jsx("div",{className:"flex items-center gap-4",children:X?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Is,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("select",{value:$,onChange:t=>oe(t.target.value),className:"px-3 py-2 border border-input rounded-lg bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-purple-500",children:[e.jsx("option",{value:"en",children:"English"}),e.jsx("option",{value:"es",children:"Spanish"}),e.jsx("option",{value:"fr",children:"French"}),e.jsx("option",{value:"de",children:"German"}),e.jsx("option",{value:"it",children:"Italian"}),e.jsx("option",{value:"pt",children:"Portuguese"}),e.jsx("option",{value:"ru",children:"Russian"}),e.jsx("option",{value:"ja",children:"Japanese"}),e.jsx("option",{value:"ko",children:"Korean"}),e.jsx("option",{value:"zh",children:"Chinese"}),Object.entries(v).map(([t,s])=>e.jsx("option",{value:t,children:s.name||t},t))]})]}),e.jsx("button",{onClick:W,disabled:H||!j,className:"flex items-center gap-2 px-6 py-2 bg-purple-600 text-white rounded-lg font-medium hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:H?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ft,{className:"w-5 h-5"}),"Generate Subtitles"]})})]}):e.jsxs("button",{disabled:!0,className:"flex items-center gap-2 px-6 py-2 bg-gray-400 text-gray-200 rounded-lg font-medium cursor-not-allowed opacity-50 transition-all",children:[e.jsx(Ft,{className:"w-7 h-7"}),"Subtitle Generation Coming Soon"]})})]})}),e.jsxs("div",{className:`p-6 ${z?"flex-1 overflow-auto":""}`,children:[(r==null?void 0:r.processing_status)==="processing"&&e.jsxs("div",{className:"bg-blue-950/50 border border-blue-800 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-400 border-t-transparent"}),e.jsxs("span",{className:"font-medium text-blue-200",children:["Processing: ",r.progress.current_step]})]}),e.jsx("div",{className:"w-full bg-blue-900/50 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-400 h-2 rounded-full transition-all duration-300",style:{width:`${r.progress.percentage}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-blue-300",children:[e.jsxs("span",{children:[r.progress.percentage,"% complete"]}),e.jsxs("span",{children:[Se(r.progress.processed_duration)," / ",Se(r.progress.total_duration)]})]})]}),a&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{ref:Fe,className:"relative bg-black rounded-lg overflow-hidden",onMouseMove:qt,onMouseUp:it,onMouseLeave:it,style:{position:"relative"},children:[e.jsx("video",{ref:C,src:(r==null?void 0:r.original_video_path)||a,className:`w-full h-auto ${z?"max-h-[70vh]":"max-h-96"}`,controls:!1,onPlay:()=>me(!0),onPause:()=>me(!1)}),e.jsx("div",{className:"video-subtitle-overlay",style:{top:(D==null?void 0:D.top)||0,left:(D==null?void 0:D.left)||0,width:(D==null?void 0:D.width)||"100%",height:(D==null?void 0:D.height)||"100%"},children:L&&e.jsx("div",{style:{pointerEvents:"auto"},children:e.jsx(en,{subtitle:L,currentTime:R,position:L.position,onMouseDown:t=>Lt(t,L.id),onDoubleClick:()=>at(L.id),editingSubtitle:he===L.id,editingText:Te,onTextChange:ve,onSaveEdit:Pt,onCancelEdit:()=>{pe(null),ve("")}})})}),Ne&&F&&C.current&&e.jsx("div",{className:"bounds-editor-overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"auto"},onMouseMove:Vt,onMouseUp:lt,onMouseLeave:lt,children:e.jsxs("div",{className:"bounds-rectangle",style:{position:"absolute",left:`${F.x}%`,top:`${F.y}%`,width:`${F.width}%`,height:`${F.height}%`,border:"3px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.15)",cursor:"move",boxShadow:"0 0 10px rgba(59, 130, 246, 0.3)",transition:"all 0.2s ease-in-out"},onMouseDown:t=>Ee(t,"move"),children:[e.jsx("div",{className:"resize-handle resize-tl",style:{position:"absolute",top:"-8px",left:"-8px",width:"16px",height:"16px",backgroundColor:"#3b82f6",border:"3px solid white",borderRadius:"50%",cursor:"nw-resize",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"all 0.2s ease-in-out"},onMouseDown:t=>Ee(t,"resize-tl")}),e.jsx("div",{className:"resize-handle resize-tr",style:{position:"absolute",top:"-8px",right:"-8px",width:"16px",height:"16px",backgroundColor:"#3b82f6",border:"3px solid white",borderRadius:"50%",cursor:"ne-resize",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"all 0.2s ease-in-out"},onMouseDown:t=>Ee(t,"resize-tr")}),e.jsx("div",{className:"resize-handle resize-bl",style:{position:"absolute",bottom:"-8px",left:"-8px",width:"16px",height:"16px",backgroundColor:"#3b82f6",border:"3px solid white",borderRadius:"50%",cursor:"sw-resize",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"all 0.2s ease-in-out"},onMouseDown:t=>Ee(t,"resize-bl")}),e.jsx("div",{className:"resize-handle resize-br",style:{position:"absolute",bottom:"-8px",right:"-8px",width:"16px",height:"16px",backgroundColor:"#3b82f6",border:"3px solid white",borderRadius:"50%",cursor:"se-resize",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",transition:"all 0.2s ease-in-out"},onMouseDown:t=>Ee(t,"resize-br")}),e.jsx("div",{className:"center-indicator",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"4px",height:"4px",backgroundColor:"#3b82f6",borderRadius:"50%",border:"2px solid white"}})]})})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:K,className:"flex items-center justify-center w-10 h-10 bg-purple-600 text-white rounded-full hover:bg-purple-700 transition-colors",children:ue?e.jsx(Xs,{className:"w-5 h-5"}):e.jsx(tt,{className:"w-5 h-5 ml-0.5"})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{ref:Pe,className:"h-2 bg-muted rounded-full cursor-pointer",onClick:Ue,children:e.jsx("div",{className:"h-full bg-purple-600 rounded-full transition-all",style:{width:`${R/Z*100}%`}})})}),e.jsxs("span",{className:"text-sm text-muted-foreground min-w-0",children:[Se(R)," / ",Se(Z)]}),e.jsx("button",{onClick:Ot,disabled:P||!j,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",title:"Set current frame as thumbnail",children:P?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Setting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(as,{className:"w-4 h-4"}),"Set Thumbnail"]})})]}),o&&e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-muted rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Subtitle Area:"}),e.jsxs("button",{onClick:()=>{Xt(),Le(!Ne)},className:`flex items-center gap-2 px-3 py-1 rounded-lg text-sm transition-colors ${Ne?"bg-purple-600 text-white":"bg-muted/50 text-foreground hover:bg-muted"}`,children:[e.jsx(Hs,{className:"w-4 h-4"}),Ne?"Finish Editing":"Set Boundary"]}),F&&e.jsxs("button",{onClick:()=>{we(null),Le(!1)},className:"flex items-center gap-2 px-3 py-1 bg-red-950/50 text-red-300 rounded-lg hover:bg-red-900/50 text-sm transition-colors",children:[e.jsx(ke,{className:"w-4 h-4"}),"Reset to Auto"]}),F&&e.jsxs("span",{className:"text-xs text-muted-foreground",children:[Math.round(F.width),"% × ",Math.round(F.height),"%"]})]})]})]}),(r==null?void 0:r.processing_status)==="completed"&&r.subtitles&&e.jsxs("div",{className:"bg-muted rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-medium text-foreground mb-4",children:"Subtitle Timeline"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:r.subtitles.map(t=>e.jsxs("div",{className:`flex items-center gap-4 p-3 border rounded-lg hover:bg-background transition-colors cursor-pointer ${R>=t.start_time&&R<=t.end_time?"border-purple-300 bg-purple-950/20":"border-border bg-background"}`,onClick:()=>{C.current&&(C.current.currentTime=t.start_time)},children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("span",{className:"text-sm font-mono text-muted-foreground",children:[Se(t.start_time)," → ",Se(t.end_time)]})}),e.jsx("div",{className:"flex-grow",children:e.jsx("p",{className:"text-foreground",children:t.text})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[e.jsx("button",{onClick:s=>{s.stopPropagation(),at(t.id)},className:"p-1 text-muted-foreground hover:text-purple-400 transition-colors",title:"Edit subtitle",children:e.jsx(st,{className:"w-4 h-4"})}),e.jsx("button",{onClick:s=>{s.stopPropagation(),fe(t.id)},className:"p-1 text-muted-foreground hover:text-purple-400 transition-colors",title:"Style subtitle",children:e.jsx($t,{className:"w-4 h-4"})})]})]},t.id))})]}),(r==null?void 0:r.processing_status)==="completed"&&N&&e.jsxs("div",{className:"bg-muted rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-medium text-foreground mb-4",children:"Subtitle Style Editor"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h5",{className:"text-sm font-medium text-foreground mb-3",children:"Style Presets"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(d).map(([t,s])=>{var h,f;const l=((f=(h=r.subtitles.find(p=>p.id===N))==null?void 0:h.style)==null?void 0:f.preset)===t;return e.jsx("button",{onClick:()=>{V(N,{...s.style}),de(t)},className:`p-3 border rounded-lg text-sm font-medium transition-all ${l?"border-purple-500 bg-purple-950/20 text-purple-300":"border-border bg-background text-foreground hover:border-purple-300 hover:bg-purple-950/10"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs mb-1 px-2 py-1 rounded",style:{color:s.style.color,backgroundColor:(()=>{const p=s.style.backgroundColor;return p.includes("gradient")?"#FFD700":p==="transparent"?"rgba(0, 0, 0, 0)":p})(),textShadow:s.style.textShadow.includes("0px")?s.style.textShadow:"none",fontFamily:s.style.fontFamily.split(",")[0]},children:"Aa"}),s.name]})},t)})}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{onClick:()=>Dt(le),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:[e.jsx(Zs,{className:"w-4 h-4"}),"Apply to All Subtitles"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Font Family"}),e.jsxs("select",{value:((mt=(ut=(dt=r.subtitles.find(t=>t.id===N))==null?void 0:dt.style)==null?void 0:ut.fontFamily)==null?void 0:mt.split(",")[0])||"Arial",onChange:t=>V(N,{fontFamily:t.target.value+", sans-serif"}),className:"w-full px-3 py-2 border border-input rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent bg-background text-foreground",children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Comic Sans MS",children:"Comic Sans MS"}),e.jsx("option",{value:"Impact",children:"Impact"}),e.jsx("option",{value:"Trebuchet MS",children:"Trebuchet MS"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Font Size"}),e.jsx("input",{type:"range",min:"12",max:"48",value:((pt=(ht=r.subtitles.find(t=>t.id===N))==null?void 0:ht.style)==null?void 0:pt.fontSize)||24,onChange:t=>V(N,{fontSize:parseInt(t.target.value)}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Text Color"}),e.jsx("input",{type:"color",value:Mt(((gt=(xt=r.subtitles.find(t=>t.id===N))==null?void 0:xt.style)==null?void 0:gt.color)||"#FFFFFF"),onChange:t=>V(N,{color:t.target.value}),className:"w-full h-8 rounded border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Background"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:(()=>{var l;const t=r.subtitles.find(h=>h.id===N),s=((l=t==null?void 0:t.style)==null?void 0:l.backgroundColor)||"#000000";return Mt(s)})(),onChange:t=>V(N,{backgroundColor:t.target.value}),className:"flex-1 h-8 rounded border"}),e.jsx("button",{onClick:()=>V(N,{backgroundColor:"transparent"}),className:"px-3 py-1 text-xs border rounded hover:bg-muted text-foreground",title:"Make background transparent",children:"None"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Alignment"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>V(N,{textAlign:"left"}),className:"p-2 border rounded hover:bg-muted text-foreground",children:e.jsx(ks,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(N,{textAlign:"center"}),className:"p-2 border rounded hover:bg-muted text-foreground",children:e.jsx(Ns,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>V(N,{textAlign:"right"}),className:"p-2 border rounded hover:bg-muted text-foreground",children:e.jsx(Ts,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{var t,s;return V(N,{bold:!((s=(t=r.subtitles.find(l=>l.id===N))==null?void 0:t.style)!=null&&s.bold)})},className:`p-2 border rounded hover:bg-muted text-foreground ${(bt=(ft=r.subtitles.find(t=>t.id===N))==null?void 0:ft.style)!=null&&bt.bold?"bg-purple-950/20 border-purple-300":""}`,children:e.jsx(Fs,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var t,s;return V(N,{italic:!((s=(t=r.subtitles.find(l=>l.id===N))==null?void 0:t.style)!=null&&s.italic)})},className:`p-2 border rounded hover:bg-muted text-foreground ${(jt=(yt=r.subtitles.find(t=>t.id===N))==null?void 0:yt.style)!=null&&jt.italic?"bg-purple-950/20 border-purple-300":""}`,children:e.jsx(Os,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var t,s;return V(N,{underline:!((s=(t=r.subtitles.find(l=>l.id===N))==null?void 0:t.style)!=null&&s.underline)})},className:`p-2 border rounded hover:bg-muted text-foreground ${(wt=(vt=r.subtitles.find(t=>t.id===N))==null?void 0:vt.style)!=null&&wt.underline?"bg-purple-950/20 border-purple-300":""}`,children:e.jsx(Ys,{className:"w-4 h-4"})})]})]}),(r==null?void 0:r.processing_status)==="completed"&&e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t",children:[e.jsxs("button",{onClick:Bt,className:"flex items-center gap-2 px-4 py-2 border border-input text-foreground rounded-lg hover:bg-muted transition-colors",children:[e.jsx(Ms,{className:"w-4 h-4"}),"Export Transcript"]}),e.jsx("button",{onClick:Ut,disabled:ee,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:ee?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Rendering Video..."]}):e.jsxs(e.Fragment,{children:[e.jsx(zs,{className:"w-5 h-5"}),"Render & Upload to All Platforms"]})})]})]})]})]})},sn=c.createContext(void 0);function nn(){const a=c.useContext(sn);return a===void 0?{toast:()=>{},dismiss:()=>{},toasts:[]}:a}function rn({videoId:a,videoPath:j,title:_,className:b,onThumbnailSet:k}){const[E,X]=c.useState(null),[r,M]=c.useState(!1),[H,ie]=c.useState(null),[ee,Y]=c.useState("suggestions"),{toast:P}=nn(),Q=async()=>{var x,m;if(!a){P({title:"No Video ID",description:"Please provide a video ID to optimize thumbnails.",variant:"destructive"});return}M(!0);try{const w=await(await fetch("/ai/optimize-thumbnails",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({video_id:a,title:_||"Amazing Video",platforms:["youtube","instagram","tiktok"]})})).json();if(w.success)X(w.data),P({title:"Thumbnail Optimization Complete! 🎨",description:`AI has analyzed your video and extracted ${((m=w.data.extracted_frames)==null?void 0:m.length)||0} thumbnail frames.`});else throw new Error(w.message||"Failed to optimize thumbnails")}catch(v){console.error("Thumbnail optimization error:",v),P({title:"Optimization Failed",description:"Failed to optimize thumbnails. Please try again.",variant:"destructive"})}finally{M(!1)}},z=async(x,m)=>{var v;if(!a){P({title:"Error",description:"Video ID is required to set thumbnail.",variant:"destructive"});return}try{const $=await(await fetch("/ai/set-video-thumbnail",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((v=document.querySelector('meta[name="csrf-token"]'))==null?void 0:v.getAttribute("content"))||""},body:JSON.stringify({video_id:a,frame_id:x,thumbnail_path:m})})).json();if($.success)P({title:"Thumbnail Set Successfully! 🎯",description:"This thumbnail has been set for all platforms."}),k&&k();else throw new Error($.message||"Failed to set thumbnail")}catch(w){console.error("Set thumbnail error:",w),P({title:"Setting Failed",description:"Failed to set thumbnail. Please try again.",variant:"destructive"})}};return!E&&!r?e.jsxs(B,{className:He("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",b),children:[e.jsxs(G,{className:"text-center pb-4",children:[e.jsx("div",{className:"mx-auto p-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full w-fit",children:e.jsx(ge,{className:"w-8 h-8 text-white"})}),e.jsx(J,{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"AI Thumbnail Optimizer"}),e.jsx("p",{className:"text-muted-foreground",children:"Generate eye-catching thumbnails with AI-powered optimization and CTR predictions"})]}),e.jsxs(U,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-background rounded-lg border",children:[e.jsx(cs,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium text-foreground",children:"CTR Prediction"})]}),e.jsxs("div",{className:"p-3 bg-background rounded-lg border",children:[e.jsx(ds,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium text-foreground",children:"Face Detection"})]}),e.jsxs("div",{className:"p-3 bg-background rounded-lg border",children:[e.jsx($t,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium text-foreground",children:"Color Analysis"})]}),e.jsxs("div",{className:"p-3 bg-background rounded-lg border",children:[e.jsx(st,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium text-foreground",children:"Text Optimization"})]})]}),e.jsxs(O,{onClick:Q,disabled:!a,size:"lg",className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(Rt,{className:"w-5 h-5 mr-2"}),"Analyze Video & Extract Thumbnails"]}),!a&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Video ID required for thumbnail analysis"})]})]}):r?e.jsx(B,{className:He("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",b),children:e.jsxs(U,{className:"p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto p-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full w-fit animate-pulse",children:e.jsx(ge,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-foreground mb-2",children:"Optimizing Thumbnails..."}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"AI is analyzing frames, detecting faces, and predicting CTR"}),e.jsx("div",{className:"w-full max-w-md mx-auto bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full animate-pulse",style:{width:"75%"}})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-background rounded-lg",children:[e.jsx(Ke,{className:"w-4 h-4 animate-spin text-purple-600"}),e.jsx("span",{className:"text-foreground",children:"Extracting frames..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-background rounded-lg",children:[e.jsx(Ke,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{className:"text-foreground",children:"Analyzing faces..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-background rounded-lg",children:[e.jsx(Ke,{className:"w-4 h-4 animate-spin text-green-600"}),e.jsx("span",{className:"text-foreground",children:"Predicting CTR..."})]})]})]})}):e.jsxs(B,{className:He("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",b),children:[e.jsx(G,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg",children:e.jsx(ge,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(J,{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Thumbnail Optimization Results"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Score: ",E.overall_score,"/100 • ",E.extracted_frames.length," frames analyzed"]})]})]}),e.jsxs(O,{onClick:Q,disabled:r,size:"sm",variant:"outline",children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Re-analyze"]})]})}),e.jsx(U,{children:e.jsxs(is,{value:ee,onValueChange:Y,className:"w-full",children:[e.jsxs(os,{className:"grid w-full grid-cols-3",children:[e.jsx(Qe,{value:"suggestions",children:"Suggestions"}),e.jsx(Qe,{value:"platforms",children:"Platform Thumbnail Specifications"}),e.jsx(Qe,{value:"testing",children:"A/B Testing"})]}),e.jsx(Ze,{value:"suggestions",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:E.thumbnail_suggestions.slice(0,3).map((x,m)=>e.jsx(B,{className:m===0?"border-2 border-gold":"",children:e.jsx(U,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:x.preview_url,alt:`Thumbnail at ${x.timestamp}s`,className:"w-32 h-18 object-cover rounded-lg border-2 border-gray-200",onError:v=>{var $;const w=v.target;console.error("Thumbnail failed to load:",x.preview_url),w.style.display="none",($=w.nextElementSibling)==null||$.classList.remove("hidden")},onLoad:()=>{console.log("Thumbnail loaded successfully:",x.preview_url)}}),e.jsx("div",{className:"w-32 h-18 bg-gray-200 rounded-lg flex items-center justify-center hidden",children:e.jsx(tt,{className:"w-6 h-6 text-gray-400"})}),m===0&&e.jsxs(ae,{className:"absolute -top-2 -right-2 bg-yellow-500 text-black",children:[e.jsx(us,{className:"w-3 h-3 mr-1"}),"Best"]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("h4",{className:"font-medium",children:["Frame at ",x.timestamp,"s"]}),e.jsxs(ae,{variant:"outline",children:[x.predicted_ctr,"% CTR"]}),e.jsxs(ae,{variant:"outline",children:[x.confidence_score,"% confidence"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Why this frame:"}),e.jsx("ul",{className:"text-sm text-gray-600",children:x.reasons.map((v,w)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),v]},w))})]}),x.design_scores&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Design Feature Scores:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(x.design_scores).map(([v,w])=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-600 capitalize",children:[v.replace("_"," "),":"]}),e.jsx(ae,{variant:"outline",className:He("text-xs px-1.5 py-0.5",w>=80?"border-green-500 text-green-700 bg-green-50":w>=60?"border-yellow-500 text-yellow-700 bg-yellow-50":"border-red-500 text-red-700 bg-red-50"),children:w})]},v))})]})]})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(O,{size:"sm",onClick:()=>z(x.frame_id,x.path),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(Tt,{className:"w-4 h-4 mr-2"}),"Set as Thumbnail"]})})]})})},x.frame_id))})}),e.jsx(Ze,{value:"platforms",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(E.platform_optimizations).map(([x,m])=>e.jsxs(B,{children:[e.jsx(G,{className:"pb-3",children:e.jsxs(J,{className:"text-lg capitalize flex items-center gap-2",children:[e.jsx(Tt,{className:"w-5 h-5"}),x]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Specifications"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["Dimensions: ",m.specifications.width,"×",m.specifications.height]}),e.jsxs("div",{children:["Aspect Ratio: ",m.specifications.aspect_ratio]}),e.jsxs("div",{children:["Max Size: ",m.specifications.max_file_size,"KB"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Optimization Focus"}),e.jsx("div",{className:"text-sm space-y-1",children:m.design_adjustments.map((v,w)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),v]},w))})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expected Improvement:"}),e.jsxs(ae,{className:"bg-green-100 text-green-800",children:[e.jsx(ms,{className:"w-3 h-3 mr-1"}),m.expected_improvement]})]})]})]},x))})}),e.jsx(Ze,{value:"testing",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:E.ab_test_variants.map(x=>e.jsxs(B,{children:[e.jsx(G,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(J,{className:"text-lg flex items-center gap-2",children:[e.jsx(hs,{className:"w-5 h-5"}),x.variant_id.replace("_"," ").toUpperCase()]}),e.jsxs(ae,{variant:"outline",children:[x.confidence_level,"% confidence"]})]})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Test Hypothesis"}),e.jsx("p",{className:"text-sm text-gray-600",children:x.test_hypothesis})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Planned Modifications"}),e.jsx("div",{className:"space-y-1",children:x.modifications.map((m,v)=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),m]},v))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expected CTR Increase:"}),e.jsxs(ae,{className:"bg-blue-100 text-blue-800",children:["+",x.expected_outcome.expected_ctr_increase]})]})]})]},x.variant_id))})})]})})]})}const an=({isOpen:a,onClose:j,videoId:_,videoPath:b,title:k,onThumbnailSet:E})=>{if(!a)return null;const X=()=>{const r=document.createElement("div");r.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",r.textContent="✓ Thumbnail optimized successfully!",document.body.appendChild(r),setTimeout(()=>{document.body.contains(r)&&document.body.removeChild(r)},3e3),E&&E()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-background rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b bg-gradient-to-r from-muted/50 to-muted/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg",children:e.jsx(ge,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"AI Thumbnail Optimizer"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Create and optimize thumbnails for better engagement"})]})]}),e.jsx("button",{onClick:j,className:"flex items-center justify-center w-8 h-8 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full transition-colors",title:"Close",children:e.jsx(ke,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx(rn,{videoId:_,videoPath:b,title:k,onThumbnailSet:X})})]})})},on={youtube:js,instagram:ys,tiktok:Ae,facebook:Ae,snapchat:Ae,pinterest:Ae,x:Ae},ln={pending:bs,processing:zt,success:fs,failed:rs},cn={pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",success:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"},dn=(a,j)=>{if(!a||!j)return{status:"unknown",color:"text-muted-foreground",label:"Unknown"};const _=a*j;return _>=1920*1080?{status:"great",color:"text-green-600",label:"1080p+"}:_>=1280*720?{status:"good",color:"text-orange-500",label:"720p"}:{status:"poor",color:"text-red-600",label:"Low Quality"}};function Vn({video:a}){var xe;const{props:j}=At();(xe=j.app)==null||xe.env;const _=[{title:"My channels",href:"/dashboard"},{title:"Videos",href:"/videos"},{title:a.title,href:`/videos/${a.id}/edit`}],{data:b,setData:k,put:E,errors:X}=Ht({title:a.title||"",description:a.description||"",tags:a.tags||[],thumbnail:null}),[r,M]=c.useState(!1),[H,ie]=c.useState("filmate"),[ee,Y]=c.useState(!1),[P,Q]=c.useState(!1),[z,x]=c.useState(a.thumbnail||null),[m,v]=c.useState([0]),[w,$]=c.useState(null),[oe,N]=c.useState([]),[fe,le]=c.useState(!1),[de,te]=c.useState(!1),[Ce,se]=c.useState(!1),[be,ze]=c.useState(!1),[nt]=c.useState(["youtube","instagram","tiktok","facebook","x","pinterest","snapchat"]),[ue,me]=c.useState([]),[R,Ge]=c.useState({title:a.title||"",description:a.description||"",tags:a.tags||[],thumbnail:a.thumbnail||null,subtitles:!1}),[Z,ye]=c.useState(!1),[rt,Je]=c.useState(!1),[je,$e]=c.useState(null),he=c.useRef(null),pe=dn(a.width,a.height),Te=async()=>{var n;try{const o=await fetch(`/videos/${a.id}/check-unsaved-changes`,{method:"GET",headers:{Accept:"application/json","X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||""}});if(o.ok){const i=await o.json();if(i.has_unsaved_changes){te(!0);const d=(i.changes||[]).map(y=>({...y,timestamp:new Date(y.timestamp)}));me(d),i.latest_data&&(k("title",i.latest_data.title||""),k("description",i.latest_data.description||""),k("tags",i.latest_data.tags||[]),i.latest_data.thumbnail&&x(i.latest_data.thumbnail))}}}catch(o){console.error("Failed to check for unsaved changes:",o)}},ve=async n=>{je&&clearTimeout(je);const o=setTimeout(async()=>{var i;Je(!0);try{const d=await fetch(`/videos/${a.id}/auto-save`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify(n)});if(d.ok){const y=await d.json();te(!0);const g=document.createElement("div");g.className="fixed bottom-4 right-4 bg-blue-500 text-white px-3 py-1 rounded-md shadow-lg z-50 text-sm",g.textContent="💾 Auto-saved",document.body.appendChild(g),setTimeout(()=>{document.body.contains(g)&&document.body.removeChild(g)},2e3)}else console.error("Auto-save failed:",d.statusText)}catch(d){console.error("Auto-save error:",d)}finally{Je(!1)}},1e3);$e(o)},I=(n,o,i,d)=>{const y={type:n,field:o,oldValue:i,newValue:d,timestamp:new Date};me(T=>[...T.filter(W=>W.type!==n),y]);const g={type:n,field:o,value:d,[o]:d};ve(g)},_e=()=>{me([]),te(!1)},Re=n=>{n.preventDefault(),E(`/videos/${a.id}`)},Oe=()=>{M(!0)},C=()=>{Ye.delete(`/videos/${a.id}`,{data:{delete_option:H},onSuccess:()=>{Ye.visit("/videos")}})},Pe=(n,o)=>{confirm(`Are you sure you want to remove this video from ${o}?`)&&Ye.delete(`/video-targets/${n}`,{preserveScroll:!0,onSuccess:()=>{},onError:i=>{console.error("Failed to remove video from platform:",i),alert("Failed to remove video from platform. Please try again.")}})},Fe=n=>{if(n.platform_url)return n.platform_url;switch(n.platform){case"youtube":return n.platform_video_id?`https://youtube.com/watch?v=${n.platform_video_id}`:null;case"instagram":return n.platform_video_id?`https://instagram.com/p/${n.platform_video_id}`:null;case"tiktok":return n.platform_video_id?`https://tiktok.com/@username/video/${n.platform_video_id}`:null;default:return null}},Ie=async()=>{var n;Y(!0);try{const o=await fetch("/ai/generate-video-content",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||""},body:JSON.stringify({video_id:a.id,content_type:"title",current_title:b.title})});if(o.ok){const i=await o.json();if(i.success&&i.data.optimized_title){const d=b.title,y=i.data.optimized_title;k("title",y),I("title","title",d,y);const g=i.data.analysis_summary;let T="Title generated based on video content analysis";if(g){const S=[];g.has_transcript&&S.push("audio transcription"),g.scenes_detected>0&&S.push(`${g.scenes_detected} visual scenes`),g.content_category!=="unknown"&&S.push(`${g.content_category} content`),S.length>0&&(T+=`. Analyzed: ${S.join(", ")}.`)}alert(`✅ AI Title Generated!

${T}`)}}else{const i=await o.json();console.error("Failed to generate AI title:",i),alert(`Failed to generate title: ${i.message||"Unknown error"}`)}}catch(o){console.error("Failed to generate AI title:",o),alert("An error occurred while generating the title. Please try again.")}finally{Y(!1)}},D=async()=>{var n;Q(!0);try{const o=await fetch("/ai/generate-video-content",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||""},body:JSON.stringify({video_id:a.id,content_type:"description",current_description:b.description})});if(o.ok){const i=await o.json();if(i.success&&i.data.optimized_description){const d=b.description,y=i.data.optimized_description;k("description",y),I("description","description",d,y);const g=i.data.analysis_summary;let T="Description generated based on video content analysis";if(g){const S=[];g.has_transcript&&S.push("audio transcription"),g.scenes_detected>0&&S.push(`${g.scenes_detected} visual scenes`),g.content_category!=="unknown"&&S.push(`${g.content_category} content`),S.length>0&&(T+=`. Analyzed: ${S.join(", ")}.`)}alert(`✅ AI Description Generated!

${T}`)}}else{const i=await o.json();console.error("Failed to generate AI description:",i),alert(`Failed to generate description: ${i.message||"Unknown error"}`)}}catch(o){console.error("Failed to generate AI description:",o),alert("An error occurred while generating the description. Please try again.")}finally{Q(!1)}},De=async n=>{var i,d;const o=(i=n.target.files)==null?void 0:i[0];if(o){if(!o.type.startsWith("image/")){alert("Please select a valid image file");return}if(o.size>5*1024*1024){alert("Image size must be less than 5MB");return}ze(!0),$(o);try{const y=new FormData;y.append("thumbnail",o),y.append("video_id",a.id.toString());const g=(d=document.querySelector('meta[name="csrf-token"]'))==null?void 0:d.getAttribute("content");console.log("CSRF Token:",g?"Found":"Missing");const T=await fetch("/ai/upload-custom-thumbnail",{method:"POST",headers:{"X-CSRF-TOKEN":g||"",Accept:"application/json"},body:y});if(console.log("Response status:",T.status),console.log("Response headers:",Object.fromEntries(T.headers.entries())),T.ok){const S=await T.json();if(S.success){const W=z,ce=S.thumbnail_url;x(ce),I("thumbnail","thumbnail",W,ce);const K=document.createElement("div");K.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",K.textContent="✅ Thumbnail uploaded successfully!",document.body.appendChild(K),setTimeout(()=>{document.body.contains(K)&&document.body.removeChild(K)},3e3)}else throw new Error(S.message||"Upload failed")}else{const S=T.headers.get("content-type");if(console.log("Error response content-type:",S),S&&S.includes("application/json")){const W=await T.json();throw new Error(W.message||`HTTP ${T.status}: Upload failed`)}else{const W=await T.text();throw console.log("HTML error response:",W.substring(0,200)),new Error(`HTTP ${T.status}: Server returned HTML instead of JSON - check Laravel logs`)}}}catch(y){console.error("Failed to upload thumbnail:",y);const g=document.createElement("div");g.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",g.textContent=`❌ Upload failed: ${y instanceof Error?y.message:"Unknown error"}`,document.body.appendChild(g),setTimeout(()=>{document.body.contains(g)&&document.body.removeChild(g)},5e3);const T=new FileReader;T.onload=S=>{var K;const W=z,ce=(K=S.target)==null?void 0:K.result;x(ce),I("thumbnail","thumbnail",W,ce)},T.readAsDataURL(o)}finally{ze(!1)}}};c.useEffect(()=>{Te()},[]),c.useEffect(()=>()=>{je&&clearTimeout(je)},[je]),c.useEffect(()=>{te(ue.length>0)},[ue]);const F=async()=>{se(!0);const n=async(o=0)=>{var i,d,y;try{const g=((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||((d=document.querySelector('input[name="_token"]'))==null?void 0:d.getAttribute("value"))||"";if(!g)throw new Error("CSRF token not found");const T=await fetch("/ai/analyze-video-tags",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":g,Accept:"application/json"},body:JSON.stringify({video_id:a.id,title:b.title||"",description:b.description||""})});if(T.status===419&&o===0){console.log("CSRF token expired, refreshing...");const S=await fetch("/");if(S.ok){const W=await S.text(),Ue=(y=new DOMParser().parseFromString(W,"text/html").querySelector('meta[name="csrf-token"]'))==null?void 0:y.getAttribute("content");if(Ue){const We=document.querySelector('meta[name="csrf-token"]');return We&&We.setAttribute("content",Ue),n(1)}}}return T}catch(g){if(o===0)return console.log("Request failed, retrying once...",g),n(1);throw g}};try{const o=await n();if(o.ok){const i=await o.json();if(console.log("Tag generation response:",i),i.success&&i.data&&i.data.analysis.tags){const d=b.tags,y=i.data.analysis.tags;k("tags",y),I("tags","tags",d,y)}else{console.warn("Unexpected response structure:",i);const d=document.createElement("div");d.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",d.textContent="⚠️ Tag generation failed - unexpected response",document.body.appendChild(d),setTimeout(()=>{document.body.contains(d)&&document.body.removeChild(d)},5e3)}}else{const i=await o.text();console.error("HTTP Error:",o.status,o.statusText,i);const d=document.createElement("div");d.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",d.textContent=`⚠️ Tag generation failed - Server error (${o.status})`,document.body.appendChild(d),setTimeout(()=>{document.body.contains(d)&&document.body.removeChild(d)},5e3)}}catch(o){console.error("Failed to generate tags:",o);const i=document.createElement("div");i.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",i.textContent="⚠️ Tag generation failed - Network error",document.body.appendChild(i),setTimeout(()=>{document.body.contains(i)&&document.body.removeChild(i)},5e3)}finally{se(!1)}},we=n=>{if(!b.tags.includes(n)){const o=[...b.tags,n];k("tags",o),I("tags","tags",R.tags,o)}},Ne=n=>{const o=b.tags.filter(i=>i!==n);k("tags",o),I("tags","tags",R.tags,o)},Le=async()=>{var n;ye(!0);try{const o=await fetch(`/videos/${a.id}/publish-changes`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||""}});if(o.ok){const i=await o.json();_e();const d=document.createElement("div");if(d.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",d.textContent=i.message||"✓ Changes published to all platforms successfully!",document.body.appendChild(d),setTimeout(()=>{document.body.contains(d)&&document.body.removeChild(d)},3e3),i.jobs_created>0){const y=document.createElement("div");y.className="fixed top-16 right-4 bg-blue-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",y.textContent=`📋 ${i.jobs_created} update job(s) queued for processing`,document.body.appendChild(y),setTimeout(()=>{document.body.contains(y)&&document.body.removeChild(y)},5e3)}}else{const i=await o.json();console.error("Failed to publish changes:",i);const d=document.createElement("div");d.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",d.textContent=`❌ Failed to publish changes: ${i.message||"Unknown error"}`,document.body.appendChild(d),setTimeout(()=>{document.body.contains(d)&&document.body.removeChild(d)},5e3)}}catch(o){console.error("Failed to publish changes:",o);const i=document.createElement("div");i.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",i.textContent="❌ Network error while publishing changes",document.body.appendChild(i),setTimeout(()=>{document.body.contains(i)&&document.body.removeChild(i)},5e3)}finally{ye(!1)}},qe=async()=>{var n;ye(!0);try{const o=await fetch(`/videos/${a.id}/discard-changes`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((n=document.querySelector('meta[name="csrf-token"]'))==null?void 0:n.getAttribute("content"))||""}});if(o.ok){const i=await o.json();i.original_data&&(k("title",i.original_data.title||""),k("description",i.original_data.description||""),k("tags",i.original_data.tags||[]),x(i.original_data.thumbnail||null)),_e();const d=document.createElement("div");d.className="fixed top-4 right-4 bg-orange-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",d.textContent="↺ All changes discarded and reverted to original version",document.body.appendChild(d),setTimeout(()=>{document.body.contains(d)&&document.body.removeChild(d)},3e3)}else{const i=await o.json();console.error("Failed to discard changes:",i);const d=document.createElement("div");d.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",d.textContent=`❌ Failed to discard changes: ${i.message||"Unknown error"}`,document.body.appendChild(d),setTimeout(()=>{document.body.contains(d)&&document.body.removeChild(d)},5e3)}}catch(o){console.error("Failed to discard changes:",o);const i=document.createElement("div");i.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",i.textContent="❌ Network error while discarding changes",document.body.appendChild(i),setTimeout(()=>{document.body.contains(i)&&document.body.removeChild(i)},5e3)}finally{ye(!1)}},Be=()=>{I("subtitles","subtitles",!1,!0)};return e.jsxs(ns,{breadcrumbs:_,children:[e.jsx(Kt,{title:`Edit: ${a.title}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Gt,{href:"/videos",children:e.jsxs(O,{variant:"outline",size:"sm",children:[e.jsx(ps,{className:"mr-2 h-4 w-4"}),"Back to Videos"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:a.title}),e.jsx("p",{className:"text-muted-foreground",children:"Edit and optimize your video with AI-powered tools"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[rt&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full"}),"Auto-saving..."]}),e.jsxs(O,{variant:"outline",onClick:Oe,className:"text-red-600 hover:text-red-700",children:[e.jsx(xs,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]}),de&&e.jsx(B,{className:"border-orange-200 bg-orange-50",children:e.jsx(U,{className:"p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-orange-500 rounded-full",children:e.jsx(zt,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-orange-800 text-lg",children:"Unsaved Changes Detected"}),e.jsx("p",{className:"text-sm text-orange-700",children:"The following changes have been made to your video:"})]})]}),e.jsx("div",{className:"space-y-2",children:ue.map((n,o)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-background rounded-lg border border-orange-200",children:[e.jsxs("div",{className:"flex-shrink-0",children:[n.type==="title"&&e.jsx(st,{className:"w-4 h-4 text-blue-600"}),n.type==="description"&&e.jsx(gs,{className:"w-4 h-4 text-green-600"}),n.type==="tags"&&e.jsx(Et,{className:"w-4 h-4 text-purple-600"}),n.type==="thumbnail"&&e.jsx(ge,{className:"w-4 h-4 text-pink-600"}),n.type==="subtitles"&&e.jsx(tt,{className:"w-4 h-4 text-indigo-600"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"font-medium text-foreground capitalize",children:[n.type.replace("_"," ")," Updated"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[n.type==="title"&&`"${n.oldValue}" → "${n.newValue}"`,n.type==="description"&&"Description content modified",n.type==="tags"&&`${n.oldValue.length} → ${n.newValue.length} tags`,n.type==="thumbnail"&&"Custom thumbnail uploaded",n.type==="subtitles"&&"Subtitles generated and applied"]})]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:n.timestamp.toLocaleTimeString()})]},o))}),e.jsxs("div",{className:"flex gap-3 pt-2",children:[e.jsxs(O,{onClick:qe,variant:"outline",disabled:Z,className:"border-red-200 text-red-600 hover:bg-red-50",children:[Z?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(ke,{className:"w-4 h-4 mr-2"}),Z?"Discarding...":"Discard All Changes"]}),e.jsxs(O,{onClick:Le,disabled:Z,className:"bg-orange-600 hover:bg-orange-700",children:[Z?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(_t,{className:"w-4 h-4 mr-2"}),Z?"Publishing...":"Publish Changes to All Platforms"]})]})]})})}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(B,{children:[e.jsx(G,{children:e.jsx(J,{className:"flex items-center gap-2",children:"Video Preview"})}),e.jsx(U,{children:e.jsx(ls,{children:e.jsx(tn,{videoPath:a.video_path||a.file_path||"",videoId:a.id,videoTitle:a.title,onSubtitleGenerated:Be,hideSubtitleControls:!0})})})]}),a.targets&&a.targets.length>0&&e.jsxs(B,{children:[e.jsxs(G,{children:[e.jsx(J,{children:"Publishing Status"}),e.jsx(St,{children:"Current status for each platform"})]}),e.jsx(U,{children:e.jsx("div",{className:"space-y-4",children:a.targets.map(n=>{const o=ln[n.status],i=on[n.platform],d=Fe(n);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:n.platform}),n.publish_at&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Scheduled: ",new Date(n.publish_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(ae,{className:cn[n.status],children:[e.jsx(o,{className:"w-3 h-3 mr-1"}),n.status]}),d&&n.status==="success"&&e.jsx("a",{href:d,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:e.jsx(vs,{className:"w-4 h-4"})}),n.status==="success"&&n.platform!=="youtube"&&e.jsxs(O,{size:"sm",variant:"outline",onClick:()=>Pe(n.id,n.platform),className:"text-red-600 hover:text-red-700",children:[e.jsx(ke,{className:"w-3 h-3 mr-1"}),"Remove"]}),n.status==="success"&&n.platform==="youtube"&&e.jsxs(O,{size:"sm",variant:"outline",disabled:!0,className:"text-gray-400",title:"YouTube video removal is not supported",children:[e.jsx(ke,{className:"w-3 h-3 mr-1"}),"Remove"]})]})]},n.id)})})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:Re,className:"space-y-6",children:[e.jsxs(B,{children:[e.jsx(G,{children:e.jsx(J,{children:"Title"})}),e.jsxs(U,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(kt,{value:b.title,onChange:n=>{const o=n.target.value;k("title",o),I("title","title",R.title,o)},placeholder:"Enter video title",className:"flex-1"}),e.jsx(O,{type:"button",variant:"outline",size:"sm",onClick:Ie,disabled:ee,children:ee?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full"}):e.jsxs(e.Fragment,{children:[e.jsx(et,{className:"w-4 h-4"}),"AI Generate"]})})]}),X.title&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:X.title})]})]}),e.jsxs(B,{children:[e.jsx(G,{children:e.jsx(J,{children:"Description"})}),e.jsxs(U,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(Jt,{value:b.description,onChange:n=>{const o=n.target.value;k("description",o),I("description","description",R.description,o)},placeholder:"Enter video description",rows:4}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:D,disabled:P,children:[P?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(et,{className:"w-4 h-4 mr-2"}),"AI Generate"]})})]}),X.description&&e.jsx("p",{className:"text-sm text-red-600",children:X.description})]})]}),e.jsxs(B,{children:[e.jsx(G,{children:e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(Et,{className:"w-5 h-5"}),"Tags"]})}),e.jsx(U,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[b.tags.map((n,o)=>e.jsxs(ae,{variant:"secondary",className:"flex items-center gap-1",children:[n,e.jsx("button",{type:"button",onClick:()=>Ne(n),className:"ml-1 text-xs hover:text-red-600",children:e.jsx(ke,{className:"w-3 h-3"})})]},o)),b.tags.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"No tags added yet"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(kt,{placeholder:"Add a tag...",onKeyDown:n=>{if(n.key==="Enter"){n.preventDefault();const o=n.currentTarget.value.trim();o&&(we(o),n.currentTarget.value="")}},className:"flex-1"}),e.jsx(O,{type:"button",variant:"outline",onClick:F,disabled:Ce,children:Ce?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsxs(e.Fragment,{children:[e.jsx(et,{className:"w-4 h-4 mr-2"}),"AI Generate"]})})]}),b.tags.length>0&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tags help categorize your video and improve discoverability across platforms"})]})})]})]}),e.jsxs(B,{children:[e.jsx(G,{children:e.jsx(J,{children:"Video Details"})}),e.jsxs(U,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Duration"}),e.jsx("p",{className:"text-lg",children:a.formatted_duration})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Resolution"}),e.jsx("p",{className:`text-lg ${pe.color}`,children:a.width&&a.height?`${a.width}x${a.height}`:"Unknown"}),e.jsx("p",{className:`text-sm ${pe.color}`,children:pe.label})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Upload Date"}),e.jsx("p",{className:"text-lg",children:new Date(a.created_at).toLocaleString()})]})]})]}),e.jsxs(B,{children:[e.jsxs(G,{children:[e.jsxs(J,{className:"flex items-center gap-2",children:[e.jsx(ge,{className:"w-5 h-5"}),"Thumbnail Optimization"]}),e.jsx(St,{children:"Set your video thumbnail using AI optimization or custom upload"})]}),e.jsxs(U,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(O,{onClick:()=>le(!0),className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(Rt,{className:"w-4 h-4 mr-2"}),"AI Optimize Thumbnail"]}),e.jsxs(O,{variant:"outline",onClick:()=>{var n;return(n=he.current)==null?void 0:n.click()},disabled:be,children:[be?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(_t,{className:"w-4 h-4 mr-2"}),be?"Uploading...":"Upload Custom Thumbnail"]}),e.jsx("input",{ref:he,type:"file",accept:"image/*",onChange:De,className:"hidden"})]}),z&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-700",children:"✓ Thumbnail has been set for this video"})}),a.thumbnail&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Current Thumbnail:"}),e.jsx("img",{src:`${a.thumbnail}`,alt:"Current thumbnail",className:"w-32 object-cover rounded-lg border",onError:n=>{var i;const o=n.target;o.style.display="none",(i=o.nextElementSibling)==null||i.classList.remove("hidden")}}),e.jsx("div",{className:"w-32 h-20 bg-muted rounded-lg flex items-center justify-center hidden",children:e.jsx(ge,{className:"w-6 h-6 text-muted-foreground"})})]})]})]})]})]})}),e.jsx(Yt,{open:r,onOpenChange:M,children:e.jsxs(Qt,{children:[e.jsxs(Zt,{children:[e.jsx(es,{children:"Delete Video"}),e.jsx(ts,{children:"This action cannot be undone. Choose what you want to delete:"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"delete-filmate",name:"delete-option",value:"filmate",checked:H==="filmate",onChange:n=>ie(n.target.value)}),e.jsx(Ct,{htmlFor:"delete-filmate",children:"Delete only from Filmate (keep on social platforms)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"delete-all",name:"delete-option",value:"all",checked:H==="all",onChange:n=>ie(n.target.value)}),e.jsx(Ct,{htmlFor:"delete-all",children:"Delete from everywhere (Filmate + all social platforms)"})]})]}),e.jsxs(ss,{children:[e.jsx(O,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),e.jsx(O,{variant:"destructive",onClick:C,children:"Delete Video"})]})]})}),e.jsx(an,{isOpen:fe,onClose:()=>le(!1),videoId:a.id,videoPath:a.original_file_path||a.file_path||"",title:b.title,onThumbnailSet:()=>{const n=z,o=`ai_optimized_${Date.now()}`;x(o),I("thumbnail","thumbnail",n,o),le(!1)}})]})]})}export{Vn as default};
