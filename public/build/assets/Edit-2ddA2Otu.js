import{r as h,j as e,v as jt,$ as bt,Y as yt,m as ls}from"./app-DcibEuGL.js";import{a as se,c as le,B as J}from"./button-BpZf_5da.js";import{C as S,b as q,c as W,a as T,d as Ge}from"./card-BG0z5KQl.js";import{I as Is}from"./input-BbA7jSyy.js";import{L as Ds}from"./label-BmUiJXfI.js";import{T as vt}from"./textarea-DpkBJ0Ad.js";import{T as rs,a as ns,b as ge,c as fe}from"./tabs-D82GtVy8.js";import{B}from"./badge-DJIvs1Ah.js";import{D as Hs,b as Xs,c as Ks,d as Js,e as Gs,f as Nt}from"./dialog-CVT_8EyK.js";import{B as Ee,X as es,A as wt}from"./app-layout-DE2A_v8w.js";import{P as Le}from"./progress-XOXw2LGZ.js";import{u as ds}from"./use-toast-D4jbcT3l.js";import{V as Me}from"./video-CmfDjWoY.js";import{F as _t}from"./file-text-DIgzuBTf.js";import{I as Ie,T as qs}from"./tag-DkXyOnfH.js";import{T as Ae,C as ze,a as De,S as St}from"./workflow-JvQOT7b3.js";import{R as xe}from"./refresh-cw-C-DzH9ne.js";import{C as cs}from"./circle-x-Bkxt3pqw.js";import{C as ss}from"./circle-check-big-DY_jYnfr.js";import{E as Re}from"./eye-CdeCWKig.js";import{H as Ys}from"./heart-BmV-dLY3.js";import{C as ts}from"./clock-CcQQZcc1.js";import{C as as}from"./circle-alert-DDP6XDpx.js";import{S as kt,a as Ct,b as Tt,c as Ft,d as Ye}from"./select-Cz15vC6r.js";import{C as At}from"./checkbox-BE7GAtul.js";import{C as Et}from"./calendar-swbp9i0y.js";import{T as Ws}from"./triangle-alert-DiD1Fxue.js";import{A as Bs}from"./arrow-up-DHXl26lS.js";import{A as is}from"./activity-DdQ6cwhm.js";import{L as Mt}from"./lightbulb-y4g-LJT9.js";import{P as zt}from"./pause-CxRlGshT.js";import{P as Qs}from"./play-Bkze8daB.js";import{C as Rt,P as Zs}from"./palette-BtkxmM53.js";import{D as Pt}from"./download-z8h7kSWR.js";import{T as Oe}from"./trash-2-C8GEWAdU.js";import{Z as et}from"./zap-C3tCkGO2.js";import{E as Qe}from"./ErrorBoundary-BEGvWX2Y.js";import{U as $t}from"./user-CfFWdXrK.js";import{S as os}from"./sparkles-DkZ0QRtA.js";import{S as Ot}from"./star-BbGeX38M.js";import{A as It}from"./arrow-left-JnhReCn9.js";import{I as Dt,Y as qt}from"./youtube-BIJS5zAn.js";import{E as Wt}from"./external-link-BkS5zPPc.js";import{U as Bt}from"./upload-6XvvMsu7.js";import"./index-eOuGKQbK.js";import"./index-D5CzHZ6k.js";import"./index-DypdXOD3.js";import"./chevron-down-ZUcGTLf2.js";import"./check-p_3iC08X.js";/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=[["path",{d:"M17 12H7",key:"16if0g"}],["path",{d:"M19 18H5",key:"18s9l3"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Lt=se("AlignCenter",Vt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["path",{d:"M15 12H3",key:"6jk70r"}],["path",{d:"M17 18H3",key:"1amg6g"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Ht=se("AlignLeft",Ut);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=[["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M21 18H7",key:"1ygte8"}],["path",{d:"M21 6H3",key:"1jwq7v"}]],Kt=se("AlignRight",Xt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Vs=se("ArrowDown",Jt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gt=[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]],Yt=se("Bold",Gt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]],Zt=se("Film",Qt);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ea=[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]],sa=se("Italic",ea);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]],aa=se("Languages",ta);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],na=se("Layers",ra);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],ia=se("Maximize",la);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]],Ls=se("Mic",ca);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],da=se("Minimize",oa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],xa=se("Save",ma);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]],Ve=se("Scan",ha);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],st=se("Settings2",ua);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],ga=se("Share2",pa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],Ze=se("TestTube",fa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]],ba=se("TrendingDown",ja);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]],va=se("Trophy",ya);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]],tt=se("Type",Na);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]],_a=se("Underline",wa);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]],ka=se("WandSparkles",Sa);function Ca({videoId:t,videoPath:j,onAnalysisComplete:d,className:a}){var y,Z,Q,L,D,_,K,F,$,A,ae,Y,l,N,z,U,re,ue,oe,je,be,Ne,we,_e,Se,R,ke,ye,Ce,u,c,p;const[m,M]=h.useState(null),[H,O]=h.useState(!1),[ie,V]=h.useState("overview"),{toast:E}=ds(),P=async()=>{var r;if(!t){E({title:"No Video Selected",description:"Please select a video first before analyzing.",variant:"destructive"});return}O(!0);try{const o=await fetch("/ai/analyze-video",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({video_id:t})}),g=await o.json();g.success?(M(g.data),d==null||d(g.data),E({title:"Analysis Complete! 🎬",description:"AI has analyzed your video and extracted valuable insights."})):o.status===404?E({title:"Video File Not Found",description:"The video file associated with this record could not be found. Please re-upload the video.",variant:"destructive"}):E({title:"Analysis Failed",description:g.message||"Failed to analyze video. Please try again.",variant:"destructive"})}catch(o){console.error("Video analysis error:",o),E({title:"Analysis Failed",description:"Failed to analyze video. Please try again.",variant:"destructive"})}finally{O(!1)}},ee=r=>{const o=Math.floor(r/60),g=Math.floor(r%60);return`${o}:${g.toString().padStart(2,"0")}`},G=r=>`${(r/1048576).toFixed(1)} MB`,te=r=>r>=80?"text-green-600 bg-green-100":r>=60?"text-yellow-600 bg-yellow-100":"text-red-600 bg-red-100",I=r=>({positive:"😊",energetic:"⚡",calm:"😌",professional:"💼",casual:"😎",inspirational:"✨",neutral:"😐"})[r]||"😐",w=r=>({educational:"📚",entertainment:"🎭",gaming:"🎮",lifestyle:"🏠",fitness:"💪",food:"🍳",travel:"✈️",tech:"💻",music:"🎵",fashion:"👗",business:"💼",diy:"🔨",general:"📹"})[r]||"📹",X=()=>{if(!(m!=null&&m.quality_score))return!1;const r=m.quality_score.resolution_score||0,o=m.quality_score.audio_score||0,g=m.quality_score.bitrate_score||0;return r<70||o<70||g<70},i=()=>{if(!(m!=null&&m.quality_score))return[];const r=[],o=m.quality_score.resolution_score||0,g=m.quality_score.audio_score||0,k=m.quality_score.bitrate_score||0;return o<70&&r.push({type:"Resolution",score:o,severity:o<40?"high":"medium"}),g<70&&r.push({type:"Audio Quality",score:g,severity:g<40?"high":"medium"}),k<70&&r.push({type:"Bitrate",score:k,severity:k<40?"high":"medium"}),r};return!m&&!H?e.jsxs(S,{className:le("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-blue-50",a),children:[e.jsxs(q,{className:"text-center pb-4",children:[e.jsx("div",{className:"mx-auto p-3 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full w-fit",children:e.jsx(Ee,{className:"w-8 h-8 text-white"})}),e.jsx(W,{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"AI Video Analyzer"}),e.jsx("p",{className:"text-gray-600",children:"Get comprehensive insights about your video content using advanced AI analysis"})]}),e.jsxs(T,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Me,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Video Quality"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(_t,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Transcription"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ie,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Scene Analysis"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ae,{className:"w-6 h-6 text-pink-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Engagement Prediction"})]})]}),e.jsxs(J,{onClick:P,disabled:!j,size:"lg",className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700",children:[e.jsx(Ee,{className:"w-5 h-5 mr-2"}),"Start AI Analysis"]}),!j&&e.jsx("p",{className:"text-sm text-gray-500",children:"Upload a video first to enable AI analysis"})]})]}):H?e.jsx(S,{className:le("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-blue-50",a),children:e.jsxs(T,{className:"p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto p-4 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full w-fit animate-pulse",children:e.jsx(Ee,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Analyzing Your Video..."}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Our AI is processing your video to extract valuable insights"}),e.jsx(Le,{value:75,className:"w-full max-w-md mx-auto"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-purple-600"}),e.jsx("span",{children:"Extracting audio..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{children:"Analyzing scenes..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-green-600"}),e.jsx("span",{children:"Predicting engagement..."})]})]})]})}):!m||!m.basic_info?e.jsx(S,{className:le("border-2 border-red-200 bg-red-50",a),children:e.jsxs(T,{className:"p-8 text-center",children:[e.jsx(cs,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-red-800 mb-2",children:"Analysis Error"}),e.jsx("p",{className:"text-red-600 mb-4",children:"The video analysis data is incomplete or corrupted."}),e.jsxs(J,{onClick:P,variant:"outline",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})}):e.jsxs(S,{className:le("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-blue-50",a),children:[e.jsx(q,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-600 to-blue-600 rounded-lg",children:e.jsx(Ee,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(W,{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent",children:"AI Video Analysis Results"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Comprehensive insights powered by artificial intelligence"})]})]}),e.jsxs(J,{onClick:P,disabled:H,size:"sm",variant:"outline",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Re-analyze"]})]})}),e.jsxs(T,{children:[e.jsxs(rs,{value:ie,onValueChange:V,className:"w-full",children:[e.jsxs(ns,{className:"grid w-full grid-cols-3",children:[e.jsx(ge,{value:"overview",children:"Overview"}),e.jsx(ge,{value:"engagement",children:"Engagement"}),e.jsx(ge,{value:"chapters",children:"Chapters"})]}),e.jsxs(fe,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),"Video Information"]})}),e.jsxs(T,{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsx("span",{className:"font-medium",children:ee(((y=m.basic_info)==null?void 0:y.duration)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Resolution:"}),e.jsxs("span",{className:"font-medium",children:[((Z=m.basic_info)==null?void 0:Z.width)||0,"×",((Q=m.basic_info)==null?void 0:Q.height)||0]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"File Size:"}),e.jsx("span",{className:"font-medium",children:G(((L=m.basic_info)==null?void 0:L.file_size)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Audio:"}),e.jsx(B,{variant:(D=m.basic_info)!=null&&D.has_audio?"default":"destructive",children:(_=m.basic_info)!=null&&_.has_audio?"Present":"Missing"})]})]})]}),e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5"}),"Content Analysis"]})}),e.jsxs(T,{className:"space-y-3",children:[m.content_category&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Category:"}),e.jsxs(B,{className:"bg-blue-100 text-blue-800",children:[w(m.content_category.primary_category)," ",m.content_category.primary_category]})]}),m.mood_analysis&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Mood:"}),e.jsxs(B,{className:"bg-green-100 text-green-800",children:[I(m.mood_analysis.dominant_mood)," ",m.mood_analysis.dominant_mood]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Transcript:"}),e.jsx(B,{variant:(K=m.transcript)!=null&&K.success?"default":"destructive",children:(F=m.transcript)!=null&&F.success?e.jsxs(e.Fragment,{children:[e.jsx(ss,{className:"w-3 h-3 mr-1"}),"Available"]}):e.jsxs(e.Fragment,{children:[e.jsx(cs,{className:"w-3 h-3 mr-1"}),"Failed"]})})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Content Tags:"}),e.jsxs("span",{className:"font-medium",children:[(($=m.content_tags)==null?void 0:$.length)||0," tags"]})]})]})]})]}),e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(ze,{className:"w-5 h-5"}),"Overall Scores"]})}),e.jsx(T,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:le("text-3xl font-bold p-4 rounded-lg mb-2",te(((A=m.quality_score)==null?void 0:A.overall_score)||0)),children:[((ae=m.quality_score)==null?void 0:ae.overall_score)||0,"/100"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Video Quality"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:le("text-3xl font-bold p-4 rounded-lg mb-2",te(((Y=m.engagement_predictions)==null?void 0:Y.engagement_score)||0)),children:[((l=m.engagement_predictions)==null?void 0:l.engagement_score)||0,"/100"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Engagement Score"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-bold p-4 bg-purple-100 text-purple-800 rounded-lg mb-2",children:((N=m.engagement_predictions)==null?void 0:N.virality_potential)||"Unknown"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Virality Potential"})]})]})})]})]}),e.jsx(fe,{value:"engagement",className:"space-y-4",children:e.jsxs(S,{children:[e.jsx(q,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Engagement Predictions"]})}),e.jsxs(T,{className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx(Re,{className:"w-8 h-8 text-blue-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:(((U=(z=m.engagement_predictions)==null?void 0:z.predicted_views)==null?void 0:U.expected)||0).toLocaleString()}),e.jsx("p",{className:"text-sm text-blue-600",children:"Expected Views"})]}),e.jsxs("div",{className:"text-center p-4 bg-pink-50 rounded-lg",children:[e.jsx(Ys,{className:"w-8 h-8 text-pink-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-pink-800",children:(((ue=(re=m.engagement_predictions)==null?void 0:re.predicted_likes)==null?void 0:ue.expected)||0).toLocaleString()}),e.jsx("p",{className:"text-sm text-pink-600",children:"Expected Likes"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(ga,{className:"w-8 h-8 text-green-600 mx-auto mb-2"}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:(((je=(oe=m.engagement_predictions)==null?void 0:oe.predicted_shares)==null?void 0:je.expected)||0).toLocaleString()}),e.jsx("p",{className:"text-sm text-green-600",children:"Expected Shares"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"font-medium",children:"Prediction Ranges"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Views"}),e.jsxs("span",{children:[(((Ne=(be=m.engagement_predictions)==null?void 0:be.predicted_views)==null?void 0:Ne.conservative)||0).toLocaleString()," - ",(((_e=(we=m.engagement_predictions)==null?void 0:we.predicted_views)==null?void 0:_e.optimistic)||0).toLocaleString()]})]}),e.jsx(Le,{value:60,className:"h-2"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:"Likes"}),e.jsxs("span",{children:[(((R=(Se=m.engagement_predictions)==null?void 0:Se.predicted_likes)==null?void 0:R.conservative)||0).toLocaleString()," - ",(((ye=(ke=m.engagement_predictions)==null?void 0:ke.predicted_likes)==null?void 0:ye.optimistic)||0).toLocaleString()]})]}),e.jsx(Le,{value:60,className:"h-2"})]})]})]})]})]})}),e.jsx(fe,{value:"chapters",className:"space-y-4",children:e.jsxs(S,{children:[e.jsx(q,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(ts,{className:"w-5 h-5"}),"Auto-Generated Chapters"]})}),e.jsx(T,{children:(((Ce=m.auto_chapters)==null?void 0:Ce.length)||0)===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ts,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{children:"No chapters detected"}),e.jsx("p",{className:"text-sm",children:"Video may be too short or lack clear segment divisions"})]}):e.jsx("div",{className:"space-y-3",children:(m.auto_chapters||[]).map((r,o)=>e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(B,{variant:"outline",className:"mt-1",children:ee(r.start_time)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:r.title}),e.jsx("p",{className:"text-sm text-gray-600",children:r.description})]})]},o))})})]})})]}),X()&&e.jsxs("div",{className:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(as,{className:"w-5 h-5 text-orange-600"}),e.jsx("h4",{className:"font-medium text-orange-800",children:"Video Quality Suggestions"})]}),e.jsxs("div",{className:"space-y-3",children:[i().map((r,o)=>e.jsxs("div",{className:le("flex items-center justify-between p-3 rounded-lg",r.severity==="high"?"bg-red-100 border border-red-200":"bg-yellow-100 border border-yellow-200"),children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:le("w-2 h-2 rounded-full",r.severity==="high"?"bg-red-500":"bg-yellow-500")}),e.jsxs("span",{className:le("font-medium",r.severity==="high"?"text-red-800":"text-yellow-800"),children:[r.type," needs improvement"]})]}),e.jsxs(B,{variant:"outline",className:le(r.severity==="high"?"border-red-300 text-red-700":"border-yellow-300 text-yellow-700"),children:["Score: ",r.score,"/100"]})]},o)),(((u=m.quality_score)==null?void 0:u.suggestions)||[]).length>0&&e.jsxs("div",{className:"mt-4 pt-3 border-t border-orange-200",children:[e.jsx("h5",{className:"font-medium text-orange-800 mb-2",children:"Recommendations:"}),e.jsx("div",{className:"space-y-2",children:(((c=m.quality_score)==null?void 0:c.suggestions)||[]).map((r,o)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm text-orange-700",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full mt-2 flex-shrink-0"}),e.jsx("span",{children:r})]},o))})]})]})]}),m.status==="partial_analysis"&&((p=m.errors)==null?void 0:p.length)&&e.jsxs("div",{className:"mt-4 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{className:"w-5 h-5 text-yellow-600"}),e.jsx("h4",{className:"font-medium text-yellow-800",children:"Partial Analysis"})]}),e.jsx("div",{className:"space-y-1",children:(m.errors||[]).map((r,o)=>e.jsx("p",{className:"text-sm text-yellow-700",children:r},o))})]})]})]})}function Ta({videoId:t,className:j}){var Z,Q,L,D,_,K,F,$,A,ae,Y,l,N,z,U,re,ue,oe,je,be,Ne,we,_e,Se,R,ke,ye,Ce;const[d,a]=h.useState(null),[m,M]=h.useState(!1),[H,O]=h.useState("overview"),[ie,V]=h.useState(!1),[E,P]=h.useState(null),{toast:ee}=ds(),G=async()=>{var u;if(!t){ee({title:"No Video Selected",description:"Please select a video to analyze performance.",variant:"destructive"});return}M(!0);try{const p=await(await fetch("/ai/analyze-video-performance",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((u=document.querySelector('meta[name="csrf-token"]'))==null?void 0:u.getAttribute("content"))||""},body:JSON.stringify({video_id:t})})).json();if(p.success)a(p.data),ee({title:"Performance Analysis Complete! 📊",description:"AI has analyzed your video performance across all platforms."});else throw new Error(p.message||"Failed to analyze performance")}catch(c){console.error("Performance analysis error:",c),ee({title:"Analysis Failed",description:"Failed to analyze video performance. Please try again.",variant:"destructive"})}finally{M(!1)}},te=async u=>{var c;try{const r=await(await fetch("/ai/create-ab-test",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((c=document.querySelector('meta[name="csrf-token"]'))==null?void 0:c.getAttribute("content"))||""},body:JSON.stringify({video_id:t,...u})})).json();if(r.success)ee({title:"A/B Test Created! 🧪",description:"Your A/B test has been set up and will start collecting data."}),V(!1);else throw new Error(r.message||"Failed to create A/B test")}catch(p){console.error("A/B test creation error:",p),ee({title:"A/B Test Failed",description:"Failed to create A/B test. Please try again.",variant:"destructive"})}},I=u=>u>=1e6?`${(u/1e6).toFixed(1)}M`:u>=1e3?`${(u/1e3).toFixed(1)}K`:u.toString(),w=u=>{switch(u){case"excellent":return"text-green-600 bg-green-100";case"good":return"text-blue-600 bg-blue-100";case"average":return"text-yellow-600 bg-yellow-100";case"needs_improvement":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},X=u=>{switch(u){case"increasing":return e.jsx(Ae,{className:"w-4 h-4 text-green-600"});case"decreasing":return e.jsx(ba,{className:"w-4 h-4 text-red-600"});default:return e.jsx(is,{className:"w-4 h-4 text-blue-600"})}},i=u=>({youtube:"📺",instagram:"📷",tiktok:"🎵",x:"𝕏",facebook:"👥"})[u]||"📱",y=u=>{switch(u){case"high":return"text-red-600 bg-red-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return!d&&!m?e.jsxs(S,{className:le("border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50",j),children:[e.jsxs(q,{className:"text-center pb-4",children:[e.jsx("div",{className:"mx-auto p-3 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full w-fit",children:e.jsx(ze,{className:"w-8 h-8 text-white"})}),e.jsx(W,{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"AI Performance Optimizer"}),e.jsx("p",{className:"text-gray-600",children:"Analyze your video performance and get AI-powered optimization recommendations"})]}),e.jsxs(T,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ae,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Performance Analysis"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(De,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Optimization Tips"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Ze,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"A/B Testing"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Et,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Timing Optimization"})]})]}),e.jsxs(J,{onClick:G,disabled:!t,size:"lg",className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:[e.jsx(ze,{className:"w-5 h-5 mr-2"}),"Start Performance Analysis"]}),!t&&e.jsx("p",{className:"text-sm text-gray-500",children:"Select a video first to enable performance analysis"})]})]}):m?e.jsx(S,{className:le("border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50",j),children:e.jsxs(T,{className:"p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto p-4 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full w-fit animate-pulse",children:e.jsx(ze,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Analyzing Performance..."}),e.jsx("p",{className:"text-gray-600 mb-4",children:"AI is analyzing your video performance across all platforms"}),e.jsx(Le,{value:85,className:"w-full max-w-md mx-auto"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{children:"Analyzing metrics..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-purple-600"}),e.jsx("span",{children:"Finding opportunities..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-green-600"}),e.jsx("span",{children:"Generating recommendations..."})]})]})]})}):!d||!d.overall_performance||!d.comparative_analysis||!d.platform_breakdown||!d.trend_analysis?e.jsx(S,{className:le("border-2 border-red-200 bg-gradient-to-br from-red-50 to-orange-50",j),children:e.jsxs(T,{className:"p-8 text-center space-y-4",children:[e.jsx(Ws,{className:"w-12 h-12 text-red-500 mx-auto"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-red-700 mb-2",children:"Analysis Data Incomplete"}),e.jsx("p",{className:"text-red-600 mb-4",children:"The performance analysis data is incomplete or missing."}),e.jsxs(J,{onClick:G,variant:"outline",className:"border-red-300 text-red-700",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Try Again"]})]})]})}):e.jsxs(S,{className:le("border-2 border-blue-200 bg-gradient-to-br from-blue-50 to-purple-50",j),children:[e.jsx(q,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg",children:e.jsx(ze,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(W,{className:"text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent",children:"Performance Analysis Results"}),e.jsx("p",{className:"text-sm text-gray-600",children:"AI-powered performance insights and optimization recommendations"})]})]}),e.jsxs(J,{onClick:G,disabled:m,size:"sm",variant:"outline",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Re-analyze"]})]})}),e.jsxs(T,{children:[e.jsxs(rs,{value:H,onValueChange:O,className:"w-full",children:[e.jsxs(ns,{className:"grid w-full grid-cols-6",children:[e.jsx(ge,{value:"overview",children:"Overview"}),e.jsx(ge,{value:"platforms",children:"Platforms"}),e.jsx(ge,{value:"opportunities",children:"Opportunities"}),e.jsx(ge,{value:"trends",children:"Trends"}),e.jsx(ge,{value:"timing",children:"Timing"}),e.jsx(ge,{value:"testing",children:"A/B Testing"})]}),e.jsxs(fe,{value:"overview",className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5"}),"Total Performance"]})}),e.jsxs(T,{className:"space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[d.performance_score,"/100"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Performance Score"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Total Views:"}),e.jsx("span",{className:"font-medium",children:I(((Z=d.overall_performance)==null?void 0:Z.total_views)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Engagement Rate:"}),e.jsxs("span",{className:"font-medium",children:[((Q=d.overall_performance)==null?void 0:Q.engagement_rate)||0,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Performance Tier:"}),e.jsx(B,{className:w(((L=d.overall_performance)==null?void 0:L.performance_tier)||"unknown"),children:(((D=d.overall_performance)==null?void 0:D.performance_tier)||"unknown").replace("_"," ")})]})]})]}),e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Industry Comparison"]})}),e.jsxs(T,{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Views vs Industry:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[(((K=(_=d.comparative_analysis)==null?void 0:_.views_vs_industry)==null?void 0:K.performance)||"below_average")==="above_average"?e.jsx(Bs,{className:"w-3 h-3 text-green-600"}):e.jsx(Vs,{className:"w-3 h-3 text-red-600"}),e.jsxs("span",{className:le("text-sm font-medium",((($=(F=d.comparative_analysis)==null?void 0:F.views_vs_industry)==null?void 0:$.performance)||"below_average")==="above_average"?"text-green-600":"text-red-600"),children:[Math.abs(((ae=(A=d.comparative_analysis)==null?void 0:A.views_vs_industry)==null?void 0:ae.difference_percentage)||0),"%"]})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Engagement vs Industry:"}),e.jsxs("div",{className:"flex items-center gap-1",children:[(((l=(Y=d.comparative_analysis)==null?void 0:Y.engagement_vs_industry)==null?void 0:l.performance)||"below_average")==="above_average"?e.jsx(Bs,{className:"w-3 h-3 text-green-600"}):e.jsx(Vs,{className:"w-3 h-3 text-red-600"}),e.jsxs("span",{className:le("text-sm font-medium",(((z=(N=d.comparative_analysis)==null?void 0:N.engagement_vs_industry)==null?void 0:z.performance)||"below_average")==="above_average"?"text-green-600":"text-red-600"),children:[Math.abs(((re=(U=d.comparative_analysis)==null?void 0:U.engagement_vs_industry)==null?void 0:re.difference_percentage)||0),"%"]})]})]})]}),e.jsxs("div",{className:"pt-2 border-t",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Growth Potential:"}),e.jsxs("div",{className:"text-lg font-medium text-purple-600",children:[I(((oe=(ue=d.comparative_analysis)==null?void 0:ue.growth_potential)==null?void 0:oe.views_growth_potential)||0)," more views"]})]})]})]}),e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5"}),"Improvement Potential"]})}),e.jsxs(T,{className:"space-y-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[d.improvement_potential,"%"]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Improvement Potential"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Platforms:"}),e.jsx("span",{className:"font-medium",children:((je=d.overall_performance)==null?void 0:je.platform_count)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Days Since Upload:"}),e.jsx("span",{className:"font-medium",children:((be=d.overall_performance)==null?void 0:be.days_since_upload)||0})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Lifecycle Stage:"}),e.jsx(B,{variant:"outline",children:((Ne=d.trend_analysis)==null?void 0:Ne.lifecycle_stage)||"unknown"})]})]})]})]}),e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(is,{className:"w-5 h-5"}),"Platform Performance Overview"]})}),e.jsx(T,{children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(d.platform_breakdown||{}).map(([u,c])=>e.jsxs("div",{className:"text-center p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl mb-2",children:i(u)}),e.jsx("div",{className:"font-medium capitalize mb-1",children:u}),e.jsxs("div",{className:"text-sm text-gray-600",children:["#",(c==null?void 0:c.ranking)||0]}),e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[(c==null?void 0:c.performance_score)||0,"/100"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[I((c==null?void 0:c.views)||0)," views"]})]},u))})})]})]}),e.jsx(fe,{value:"platforms",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(d.platform_breakdown||{}).map(([u,c])=>e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:i(u)}),e.jsx("span",{className:"capitalize",children:u}),e.jsxs(B,{className:"ml-2",children:["#",(c==null?void 0:c.ranking)||0]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[(c==null?void 0:c.performance_score)||0,"/100"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Performance Score"})]})]})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-3 bg-blue-50 rounded-lg",children:[e.jsx(Re,{className:"w-6 h-6 text-blue-600 mx-auto mb-1"}),e.jsx("div",{className:"text-lg font-bold",children:I((c==null?void 0:c.views)||0)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Views"})]}),e.jsxs("div",{className:"text-center p-3 bg-green-50 rounded-lg",children:[e.jsx(Ys,{className:"w-6 h-6 text-green-600 mx-auto mb-1"}),e.jsx("div",{className:"text-lg font-bold",children:I((c==null?void 0:c.engagement)||0)}),e.jsx("div",{className:"text-xs text-gray-600",children:"Total Engagement"})]}),e.jsxs("div",{className:"text-center p-3 bg-purple-50 rounded-lg",children:[e.jsx(Ae,{className:"w-6 h-6 text-purple-600 mx-auto mb-1"}),e.jsxs("div",{className:"text-lg font-bold",children:[(c==null?void 0:c.engagement_rate)||0,"%"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Engagement Rate"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[((c==null?void 0:c.strengths)||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-green-700 mb-2 flex items-center gap-2",children:[e.jsx(va,{className:"w-4 h-4"}),"Strengths"]}),e.jsx("ul",{className:"space-y-1",children:((c==null?void 0:c.strengths)||[]).map((p,r)=>e.jsxs("li",{className:"text-sm text-green-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-green-400 rounded-full mt-2 flex-shrink-0"}),p]},r))})]}),((c==null?void 0:c.weaknesses)||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-red-700 mb-2 flex items-center gap-2",children:[e.jsx(Ws,{className:"w-4 h-4"}),"Areas for Improvement"]}),e.jsx("ul",{className:"space-y-1",children:((c==null?void 0:c.weaknesses)||[]).map((p,r)=>e.jsxs("li",{className:"text-sm text-red-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-red-400 rounded-full mt-2 flex-shrink-0"}),p]},r))})]})]}),((c==null?void 0:c.recommendations)||[]).length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium text-blue-700 mb-2 flex items-center gap-2",children:[e.jsx(Mt,{className:"w-4 h-4"}),"Recommendations"]}),e.jsx("div",{className:"space-y-2",children:((c==null?void 0:c.recommendations)||[]).map((p,r)=>e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx("span",{className:"text-sm text-blue-800",children:p})},r))})]})]})]},u))})}),e.jsx(fe,{value:"opportunities",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(d.optimization_opportunities||{}).map(([u,c])=>e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:i(u)}),e.jsxs("span",{className:"capitalize",children:[u," Opportunities"]})]})}),e.jsx(T,{className:"space-y-4",children:(c||[]).map((p,r)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(De,{className:"w-4 h-4"}),(p==null?void 0:p.title)||"Untitled"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(p==null?void 0:p.description)||"No description available"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{className:y((p==null?void 0:p.priority)||"low"),children:(p==null?void 0:p.priority)||"low"}),e.jsxs(B,{variant:"outline",children:[(p==null?void 0:p.potential_impact)||"unknown"," impact"]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Action Steps:"}),e.jsx("div",{className:"space-y-1",children:((p==null?void 0:p.actions)||[]).map((o,g)=>e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),o]},g))})]})]},r))})]},u))})}),e.jsx(fe,{value:"trends",className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(is,{className:"w-5 h-5"}),"Trend Analysis"]})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Trend Direction:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[X(((we=d.trend_analysis)==null?void 0:we.trend_direction)||"stable"),e.jsx("span",{className:"font-medium capitalize",children:((_e=d.trend_analysis)==null?void 0:_e.trend_direction)||"stable"})]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Daily Avg Views:"}),e.jsx("span",{className:"font-medium",children:I(((Se=d.trend_analysis)==null?void 0:Se.daily_average_views)||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Momentum Score:"}),e.jsxs("span",{className:"font-medium",children:[((R=d.trend_analysis)==null?void 0:R.momentum_score)||0,"/100"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Lifecycle Stage:"}),e.jsx(B,{variant:"outline",children:((ke=d.trend_analysis)==null?void 0:ke.lifecycle_stage)||"unknown"})]})]})]}),e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"Performance Projections"]})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:I(((ye=d.trend_analysis)==null?void 0:ye.projected_30_day_views)||0)}),e.jsx("div",{className:"text-sm text-blue-600",children:"Projected 30-Day Views"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Peak Performance Day:"}),e.jsxs("span",{className:"font-medium",children:["Day ",((Ce=d.trend_analysis)==null?void 0:Ce.peak_performance_day)||0]})]})]})]})]})}),e.jsx(fe,{value:"timing",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(d.posting_time_optimization||{}).map(([u,c])=>e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx("span",{className:"text-xl",children:i(u)}),e.jsxs("span",{className:"capitalize",children:[u," Timing Optimization"]})]})}),e.jsx(T,{className:"space-y-4",children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Current Status"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Posted at:"}),e.jsx("span",{className:"font-medium",children:(c==null?void 0:c.current_posting_time)||"Unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Day type:"}),e.jsx("span",{className:"font-medium",children:(c==null?void 0:c.current_day_type)||"unknown"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Improvement potential:"}),e.jsx(B,{className:y((c==null?void 0:c.improvement_potential)||"low"),children:(c==null?void 0:c.improvement_potential)||"low"})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Optimal Times"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Best time:"}),e.jsx("span",{className:"font-medium text-green-600",children:(c==null?void 0:c.best_time)||"unknown"})]}),e.jsx("div",{className:"text-sm text-gray-600",children:"All optimal times:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:((c==null?void 0:c.optimal_times)||[]).map((p,r)=>e.jsx(B,{variant:"outline",className:"text-xs",children:p},r))})]})]})]})})]},u))})}),e.jsx(fe,{value:"testing",className:"space-y-4",children:e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ze,{className:"w-5 h-5"}),"A/B Testing Suggestions"]})}),e.jsx(T,{className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:(d.ab_test_suggestions||[]).map((u,c)=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium flex items-center gap-2",children:[e.jsx(Ze,{className:"w-4 h-4"}),(u==null?void 0:u.title)||"Untitled Test"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:(u==null?void 0:u.description)||"No description available"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{className:y((u==null?void 0:u.priority)||"low"),children:(u==null?void 0:u.priority)||"low"}),e.jsx(J,{size:"sm",onClick:()=>{P(u),V(!0)},children:"Start Test"})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Test Variations:"}),e.jsx("div",{className:"space-y-1",children:((u==null?void 0:u.test_variations)||[]).map((p,r)=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),p]},r))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-sm mb-2",children:"Success Metrics:"}),e.jsx("div",{className:"space-y-1",children:((u==null?void 0:u.success_metrics)||[]).map((p,r)=>e.jsx(B,{variant:"outline",className:"text-xs mr-1",children:p.replace("_"," ")},r))}),e.jsxs("div",{className:"text-xs text-gray-500 mt-2",children:["Duration: ",(u==null?void 0:u.duration)||"Unknown"]})]})]})]},c))})})]})})]}),e.jsx(Hs,{open:ie,onOpenChange:V,children:e.jsxs(Xs,{className:"max-w-md",children:[e.jsxs(Ks,{children:[e.jsx(Js,{children:"Create A/B Test"}),e.jsxs(Gs,{children:['Set up an A/B test for "',E==null?void 0:E.title,'"']})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Test Duration (days)"}),e.jsxs(kt,{defaultValue:"14",children:[e.jsx(Ct,{children:e.jsx(Tt,{})}),e.jsxs(Ft,{children:[e.jsx(Ye,{value:"7",children:"7 days"}),e.jsx(Ye,{value:"14",children:"14 days"}),e.jsx(Ye,{value:"21",children:"21 days"}),e.jsx(Ye,{value:"30",children:"30 days"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Success Metrics"}),e.jsx("div",{className:"space-y-2",children:((E==null?void 0:E.success_metrics)||[]).map((u,c)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(At,{id:`metric-${c}`,defaultChecked:!0}),e.jsx("label",{htmlFor:`metric-${c}`,className:"text-sm",children:u.replace("_"," ")})]},c))})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(J,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),e.jsx(J,{onClick:()=>te({test_type:E==null?void 0:E.test_type,test_variations:E==null?void 0:E.test_variations,success_metrics:E==null?void 0:E.success_metrics,test_duration_days:14}),children:"Create Test"})]})]})]})})]})]})}const Fa=(t,j,d)=>{const a=document.createElement("div");a.style.position="absolute",a.style.left=`${t}px`,a.style.top=`${j}px`,a.style.width="6px",a.style.height="6px",a.style.backgroundColor=d,a.style.borderRadius="50%",a.style.pointerEvents="none",a.style.zIndex="1000";const m=(Math.random()-.5)*100,M=(Math.random()-.5)*100;return a.animate([{transform:"translate(0, 0) rotate(0deg)",opacity:1},{transform:`translate(${m}px, ${M}px) rotate(360deg)`,opacity:0}],{duration:800,easing:"ease-out"}).onfinish=()=>{a.parentNode&&a.parentNode.removeChild(a)},a},Aa=({subtitle:t,currentTime:j,position:d,onMouseDown:a,onDoubleClick:m,editingSubtitle:M,editingText:H,onTextChange:O,onSaveEdit:ie,onCancelEdit:V})=>{var w,X;const E=h.useRef(null),[P,ee]=h.useState(new Set);h.useEffect(()=>{var i,y;console.log("AdvancedSubtitleRenderer: Complete subtitle object:",t),console.log("AdvancedSubtitleRenderer: Subtitle words:",t.words),console.log("AdvancedSubtitleRenderer: Words array length:",((i=t.words)==null?void 0:i.length)||0),console.log("AdvancedSubtitleRenderer: Subtitle text:",t.text),console.log("AdvancedSubtitleRenderer: Subtitle style preset:",(y=t.style)==null?void 0:y.preset),console.log("AdvancedSubtitleRenderer: Subtitle time range:",t.start_time,"-",t.end_time),console.log("AdvancedSubtitleRenderer: Current time:",j),console.log("AdvancedSubtitleRenderer: Is subtitle active?",j>=t.start_time&&j<=t.end_time)},[t,j]),h.useEffect(()=>{var Z,Q,L,D,_,K;const i=j>=t.start_time&&j<=t.end_time;if(!i){ee(new Set);return}if(!t.words||t.words.length===0){console.log("AdvancedSubtitleRenderer: No word data available for subtitle:",t.text),console.log("AdvancedSubtitleRenderer: Using fallback word timing simulation");return}(((Z=t.style)==null?void 0:Z.preset)==="bubbles"||((Q=t.style)==null?void 0:Q.preset)==="confetti")&&(console.log(`${t.style.preset} effect - Current time:`,j),console.log(`${t.style.preset} effect - Words:`,t.words),console.log(`${t.style.preset} effect - Words count:`,t.words.length),console.log(`${t.style.preset} effect - Subtitle time range:`,t.start_time,"-",t.end_time),console.log(`${t.style.preset} effect - Subtitle is active:`,i));const y=new Set;if(((L=t.style)==null?void 0:L.preset)==="confetti"){let F=-1;for(let $=0;$<t.words.length;$++){const A=t.words[$];j>=A.start_time&&j<=A.end_time-.05&&(F=$,console.log(`Confetti - Word ${$} "${A.word}" is active at time ${j} (${A.start_time}-${A.end_time})`))}if(F>=0&&(y.add(F),!P.has(F)&&E.current)){console.log("Triggering confetti for word:",t.words[F].word);const A=E.current.getBoundingClientRect(),ae=["#FFD700","#FF69B4","#00CED1","#FF4500","#9370DB"];for(let Y=0;Y<8;Y++)setTimeout(()=>{const l=ae[Math.floor(Math.random()*ae.length)],N=A.left+A.width*Math.random(),z=A.top+A.height*Math.random(),U=Fa(N,z,l);document.body.appendChild(U)},Y*30)}}else if(((D=t.style)==null?void 0:D.preset)==="bubbles"){let F=-1;for(let $=0;$<t.words.length;$++){const A=t.words[$];j>=A.start_time&&j<=A.end_time-.05&&(F=$,console.log(`Bubbles - Word ${$} "${A.word}" is active at time ${j} (${A.start_time}-${A.end_time})`))}F>=0&&y.add(F)}else t.words.forEach((F,$)=>{j>=F.start_time&&j<=F.end_time&&y.add($)});(((_=t.style)==null?void 0:_.preset)==="bubbles"||((K=t.style)==null?void 0:K.preset)==="confetti")&&y.size>0&&console.log(`${t.style.preset} effect - Active words count:`,y.size,"Active words:",Array.from(y)),ee(y)},[j,t.words,(w=t.style)==null?void 0:w.preset]);const G=()=>{var i,y,Z;if(!t.words||t.words.length===0){if(((i=t.style)==null?void 0:i.preset)==="bubbles"||((y=t.style)==null?void 0:y.preset)==="confetti"){console.log("Using fallback word timing for preset:",t.style.preset);const Q=t.text.split(" "),L=Q.length/(t.end_time-t.start_time);let D=-1;for(let _=0;_<Q.length;_++){const K=t.start_time+_/L,F=t.start_time+(_+1)/L;if(j>=K&&j<=F-.05){D=_;break}}return Q.map((_,K)=>{var A,ae,Y,l,N;const F=K===D;if(F&&((A=t.style)==null?void 0:A.preset)==="bubbles"){const z=t.start_time+K/L,U=t.start_time+(K+1)/L;console.log(`Fallback bubbles - Active word ${K}: "${_}" (${z.toFixed(2)}-${U.toFixed(2)})`)}const $={display:"inline-block",margin:"0 0.1em",flexShrink:0};return((ae=t.style)==null?void 0:ae.preset)==="confetti"?e.jsx("span",{style:{...$,opacity:F?1:.4,transform:F?"scale(1.3)":"scale(1)",transition:F?"all 0.1s ease-out":"all 0.05s ease-in",fontWeight:"bold",color:"#FFFFFF",textShadow:F?"0 0 15px #FFD700, 0 0 25px #FFD700, 2px 2px 4px rgba(0, 0, 0, 0.8)":"2px 2px 4px rgba(0, 0, 0, 0.8)"},children:_},K):((Y=t.style)==null?void 0:Y.preset)==="bubbles"?e.jsx("span",{style:{...$,color:F?"#FF1493":((l=t.style)==null?void 0:l.color)||"#FFFFFF",transform:F?"scale(1.4)":"scale(1)",transition:F?"all 0.1s cubic-bezier(0.68, -0.55, 0.265, 1.55)":"all 0.05s ease-in",textShadow:F?"0 0 15px #FF1493, 0 0 25px #FF1493, 0 0 35px #FF1493":((N=t.style)==null?void 0:N.textShadow)||"3px 3px 6px rgba(0, 0, 0, 0.8)",fontWeight:F?"bold":"normal"},children:_},K):e.jsx("span",{style:$,children:_},K)})}return t.text}return console.log("Using actual word timing data for preset:",(Z=t.style)==null?void 0:Z.preset),t.words.map((Q,L)=>{var K,F,$,A;const D=P.has(L),_={display:"inline-block",margin:"0 0.1em",flexShrink:0};return((K=t.style)==null?void 0:K.preset)==="confetti"?e.jsx("span",{style:{..._,opacity:D?1:.4,transform:D?"scale(1.3)":"scale(1)",transition:D?"all 0.1s ease-out":"all 0.05s ease-in",fontWeight:"bold",color:"#FFFFFF",textShadow:D?"0 0 15px #FFD700, 0 0 25px #FFD700, 2px 2px 4px rgba(0, 0, 0, 0.8)":"2px 2px 4px rgba(0, 0, 0, 0.8)"},children:Q.word},L):((F=t.style)==null?void 0:F.preset)==="bubbles"?(D&&console.log(`Rendering active bubble word: "${Q.word}"`),e.jsx("span",{style:{..._,color:D?"#FF1493":(($=t.style)==null?void 0:$.color)||"#FFFFFF",transform:D?"scale(1.4)":"scale(1)",transition:D?"all 0.1s cubic-bezier(0.68, -0.55, 0.265, 1.55)":"all 0.05s ease-in",textShadow:D?"0 0 15px #FF1493, 0 0 25px #FF1493, 0 0 35px #FF1493":((A=t.style)==null?void 0:A.textShadow)||"3px 3px 6px rgba(0, 0, 0, 0.8)",fontWeight:D?"bold":"normal"},children:Q.word},L)):e.jsx("span",{style:_,children:Q.word},L)})},te=()=>{const i=Math.max(10,Math.min(90,d.x)),y=Math.max(10,Math.min(90,d.y));return{x:i,y}},I=()=>{var Q,L;const i=t.style||{},y=te(),Z=Math.max(16,Math.min(48,i.fontSize||24));return{position:"absolute",left:`${y.x}%`,top:`${y.y}%`,transform:"translate(-50%, -50%)",fontFamily:i.fontFamily||"Arial, sans-serif",fontSize:`${Z}px`,fontWeight:i.fontWeight||"bold",color:i.color||"#FFFFFF",background:(Q=i.backgroundColor)!=null&&Q.includes("gradient")?i.backgroundColor:void 0,backgroundColor:(L=i.backgroundColor)!=null&&L.includes("gradient")?void 0:i.backgroundColor||"rgba(0, 0, 0, 0.7)",textAlign:i.textAlign||"center",borderRadius:`${i.borderRadius||4}px`,padding:`${i.padding||8}px`,textShadow:i.textShadow||"2px 2px 4px rgba(0, 0, 0, 0.5)",fontStyle:i.italic?"italic":"normal",textDecoration:i.underline?"underline":"none",cursor:"move",userSelect:"none",boxShadow:(i==null?void 0:i.preset)==="neon"?"none":void 0,whiteSpace:"normal",wordWrap:"break-word",overflowWrap:"break-word",maxWidth:"85%",minWidth:"200px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",maxHeight:"30%",overflow:"hidden",lineHeight:"1.2"}};return e.jsx("div",{ref:E,style:I(),onMouseDown:a,onDoubleClick:m,className:`subtitle-container ${((X=t.style)==null?void 0:X.preset)||""}`,children:M?e.jsx("textarea",{value:H||"",onChange:i=>O==null?void 0:O(i.target.value),onKeyDown:i=>{i.key==="Enter"&&!i.shiftKey?(i.preventDefault(),ie==null||ie()):i.key==="Escape"&&(V==null||V())},onBlur:ie,className:"subtitle-editor",style:{background:"transparent",border:"none",outline:"none",textAlign:"center",color:"inherit",fontSize:"inherit",fontFamily:"inherit",fontWeight:"inherit",width:"100%",minWidth:"200px",resize:"none",overflow:"hidden",whiteSpace:"normal",wordWrap:"break-word",lineHeight:"inherit"},rows:2,autoFocus:!0}):e.jsx("div",{className:"subtitle-content",style:{textAlign:"inherit",width:"100%",display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:"0.2em"},children:G()})})},Us=t=>{if(t==="transparent")return"#000000";if(t.startsWith("rgba(")){const d=t.match(/rgba?\((\d+),\s*(\d+),\s*(\d+)/);if(d){const a=parseInt(d[1]).toString(16).padStart(2,"0"),m=parseInt(d[2]).toString(16).padStart(2,"0"),M=parseInt(d[3]).toString(16).padStart(2,"0");return`#${a}${m}${M}`}}if(t.startsWith("rgb(")){const d=t.match(/rgb\((\d+),\s*(\d+),\s*(\d+)/);if(d){const a=parseInt(d[1]).toString(16).padStart(2,"0"),m=parseInt(d[2]).toString(16).padStart(2,"0"),M=parseInt(d[3]).toString(16).padStart(2,"0");return`#${a}${m}${M}`}}const j={black:"#000000",white:"#ffffff",red:"#ff0000",green:"#008000",blue:"#0000ff",yellow:"#ffff00",cyan:"#00ffff",magenta:"#ff00ff",silver:"#c0c0c0",gray:"#808080",maroon:"#800000",olive:"#808000",lime:"#00ff00",aqua:"#00ffff",teal:"#008080",navy:"#000080",fuchsia:"#ff00ff",purple:"#800080"};return j[t.toLowerCase()]?j[t.toLowerCase()]:t.startsWith("#")&&/^#[0-9A-Fa-f]{6}$/.test(t)?t:"#000000"},Ea=({videoPath:t,videoId:j,videoTitle:d})=>{var gs,fs,js,bs,ys,vs,Ns,ws,_s,Ss,ks,Cs,Ts,Fs,As,Es,Ms,zs,Rs,Ps,$s;const[a,m]=h.useState(null),[M,H]=h.useState(!1),[O,ie]=h.useState(!1),[V,E]=h.useState(!1),[P,ee]=h.useState(!1),G=h.useRef(null),[te,I]=h.useState({}),[w,X]=h.useState("en"),[i,y]=h.useState(null),[Z,Q]=h.useState("standard"),[L,D]=h.useState(null),[_,K]=h.useState(null),[F,$]=h.useState(null),[A,ae]=h.useState(!1),[Y,l]=h.useState(0),[N,z]=h.useState(0),[U,re]=h.useState(!1),[ue,oe]=h.useState(null),[je,be]=h.useState(""),[Ne,we]=h.useState(null),[_e,Se]=h.useState({x:0,y:0}),R=h.useRef(null),ke=h.useRef(null),ye=h.useRef(null),Ce=h.useRef(null),[u,c]=h.useState(null),[p,r]=h.useState(null),[o,g]=h.useState(!1),[k,ce]=h.useState(null),[v,de]=h.useState(null),he={standard:{name:"Standard",style:{fontFamily:"Arial, sans-serif",fontSize:32,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"rgba(0, 0, 0, 0.7)",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:4,padding:8,textShadow:"2px 2px 4px rgba(0, 0, 0, 0.5)",preset:"standard"}},"no-background":{name:"No Background",style:{fontFamily:"Arial, sans-serif",fontSize:36,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"3px 3px 6px rgba(0, 0, 0, 0.8)",preset:"no-background"}},neon:{name:"Neon",style:{fontFamily:"Impact, Arial Black, sans-serif",fontSize:40,fontWeight:"bold",color:"#00FFFF",backgroundColor:"rgba(0, 20, 40, 0.8)",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:8,padding:12,textShadow:"0 0 10px #00FFFF, 0 0 20px #00FFFF",preset:"neon"}},confetti:{name:"Confetti",style:{fontFamily:"Comic Sans MS, cursive",fontSize:38,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"2px 2px 0px #000000, -2px -2px 0px #000000, 2px -2px 0px #000000, -2px 2px 0px #000000",preset:"confetti"}},bubbles:{name:"Bubbles",style:{fontFamily:"Trebuchet MS, sans-serif",fontSize:36,fontWeight:"bold",color:"#FFFFFF",backgroundColor:"transparent",textAlign:"center",bold:!0,italic:!1,underline:!1,borderRadius:0,padding:4,textShadow:"3px 3px 6px rgba(0, 0, 0, 0.8)",preset:"bubbles"}}},me=he.standard.style;h.useEffect(()=>(He(),()=>{L&&clearInterval(L)}),[]),h.useEffect(()=>{j&&(console.log("Checking existing subtitles for video ID:",j),ms())},[j]);const ms=async()=>{var s,n;if(!j){console.log("No video ID available, skipping subtitle check");return}console.log("Checking for existing subtitles for video:",j);try{const f=await(await fetch("/ai/subtitle-check",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({video_id:j})})).json();if(console.log("Subtitle check response:",f),f.success&&f.data&&f.data.processing_status==="completed"){console.log("Found existing subtitles, loading them:",f.data);const b=((n=f.data.subtitles)==null?void 0:n.map(C=>({...C,style:C.style||me,position:C.position||{x:50,y:85}})))||[];m({...f.data,original_video_path:t,subtitles:b}),console.log("Loaded subtitles with styles:",b),f.data.generation_id&&Ue(f.data.generation_id)}else console.log("No existing subtitles found for this video")}catch(x){console.error("Error checking existing subtitles:",x)}},Ue=async s=>{try{console.log("Loading word timing data for generation:",s);const n=await fetch(`/ai/word-timing/${s}`,{method:"GET",headers:{Accept:"application/json"}});if(n.ok){const x=await n.json();x.success&&x.data?(console.log("Word timing data loaded:",x.data),$(x.data),m(f=>{var Te,Fe,Je,Be;if(!f||!f.subtitles)return f;const b=new Map;x.data.words.forEach(pe=>{b.has(pe.subtitle_id)||b.set(pe.subtitle_id,[]),b.get(pe.subtitle_id).push({word:pe.word,start_time:pe.start_time,end_time:pe.end_time,confidence:pe.confidence})});const C=f.subtitles.map(pe=>{const Os=b.get(pe.id)||[];return console.log(`Merging words for subtitle ${pe.id}: ${Os.length} words`),{...pe,words:Os}});console.log("Updated subtitles with word timing:",C),console.log("First subtitle word count after merge:",((Fe=(Te=C[0])==null?void 0:Te.words)==null?void 0:Fe.length)||0),console.log("First subtitle words sample:",(Be=(Je=C[0])==null?void 0:Je.words)==null?void 0:Be.slice(0,3));const ne=C.filter(pe=>pe.words&&pe.words.length>0);return console.log(`Subtitles with word timing: ${ne.length}/${C.length}`),{...f,subtitles:C}})):console.log("No word timing data available")}else console.log("Word timing data not found or not accessible")}catch(n){console.error("Error loading word timing data:",n)}};h.useEffect(()=>{if(a&&a.processing_status==="processing"){const s=setInterval(()=>{at()},2e3);return D(s),()=>clearInterval(s)}else L&&(clearInterval(L),D(null))},[a==null?void 0:a.processing_status]),h.useEffect(()=>{const s=R.current;if(!s)return;const n=()=>{l(s.currentTime)},x=()=>{z(s.duration)};return s.addEventListener("timeupdate",n),s.addEventListener("loadedmetadata",x),()=>{s.removeEventListener("timeupdate",n),s.removeEventListener("loadedmetadata",x)}},[]);const He=async()=>{try{const n=await(await fetch("/ai/subtitle-languages")).json();n.success&&I(n.data)}catch(s){console.error("Error loading languages:",s)}},Xe=async()=>{var s;if(!j){alert("No video ID available for subtitle generation. Please ensure the video is properly uploaded.");return}H(!0);try{const x=await(await fetch("/ai/subtitle-generate",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({video_id:j,language:w})})).json();x.success?m({...x.data,original_video_path:t}):(console.error("Generation failed:",x.message),alert(`Subtitle generation failed: ${x.message}`))}catch(n){console.error("Error starting generation:",n)}finally{H(!1)}},at=async()=>{var s;if(a!=null&&a.generation_id)try{const x=await(await fetch("/ai/subtitle-progress",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id})})).json();x.success&&m(f=>{const b={...f,...x.data,original_video_path:(f==null?void 0:f.original_video_path)||t};return x.data.processing_status==="completed"&&x.data.generation_id&&!F&&Ue(x.data.generation_id),b})}catch(n){console.error("Error polling progress:",n)}},rt=()=>{const s=R.current;s&&(A?s.pause():s.play(),ae(!A))},nt=s=>{const n=R.current,x=ke.current;if(!n||!x)return;const f=x.getBoundingClientRect(),C=(s.clientX-f.left)/f.width*N;n.currentTime=C,l(C)},Ke=()=>a!=null&&a.subtitles&&a.subtitles.find(s=>Y>=s.start_time&&Y<=s.end_time)||null,lt=async()=>{var x;const s=R.current,n=Ce.current;if(!s||!n||!j){alert("Unable to capture frame. Please ensure video is loaded.");return}E(!0);try{n.width=s.videoWidth,n.height=s.videoHeight;const f=n.getContext("2d");if(!f)throw new Error("Unable to get canvas context");f.drawImage(s,0,0,n.width,n.height);const b=await new Promise((Fe,Je)=>{n.toBlob(Be=>{Be?Fe(Be):Je(new Error("Failed to create blob from canvas"))},"image/jpeg",.8)}),C=new FormData;C.append("video_id",j.toString()),C.append("frame_id",`frame_${Date.now()}`),C.append("thumbnail",b,"thumbnail.jpg"),C.append("current_time",Y.toString());const Te=await(await fetch("/ai/set-video-thumbnail-from-frame",{method:"POST",headers:{"X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:C})).json();if(Te.success){const Fe=document.createElement("div");Fe.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",Fe.textContent="✓ Thumbnail set successfully!",document.body.appendChild(Fe),setTimeout(()=>{document.body.removeChild(Fe)},3e3)}else alert(`Failed to set thumbnail: ${Te.message}`)}catch(f){console.error("Error setting thumbnail:",f),alert("Failed to capture and set thumbnail. Please try again.")}finally{E(!1)}},xs=s=>{const n=a==null?void 0:a.subtitles.find(x=>x.id===s);n&&(oe(s),be(n.text))},it=async()=>{var s;if(!(!ue||!a))try{if((await(await fetch("/ai/subtitle-update-text",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,subtitle_id:ue,text:je})})).json()).success){const f=a.subtitles.map(b=>b.id===ue?{...b,text:je}:b);m({...a,subtitles:f}),oe(null),be("")}}catch(n){console.error("Error updating subtitle:",n)}},ve=async(s,n)=>{var x;if(a)try{if((await(await fetch("/ai/subtitle-update-style",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,subtitle_id:s,style:n})})).json()).success){const C=a.subtitles.map(ne=>ne.id===s?{...ne,style:{...ne.style,...n}}:ne);m({...a,subtitles:C})}}catch(f){console.error("Error updating subtitle style:",f)}},ct=async(s,n)=>{var x;if(a)try{if((await(await fetch("/ai/subtitle-update-position",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,subtitle_id:s,position:n})})).json()).success){const C=a.subtitles.map(ne=>ne.id===s?{...ne,position:n}:ne);m({...a,subtitles:C})}}catch(f){console.error("Error updating subtitle position:",f)}},ot=async s=>{var x;if(!a)return;const n=he[s];if(n)try{(await(await fetch("/ai/apply-style-to-all-subtitles",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((x=document.querySelector('meta[name="csrf-token"]'))==null?void 0:x.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,style:n.style})})).json()).success&&(m(C=>C?{...C,subtitles:C.subtitles.map(ne=>({...ne,style:{...n.style}}))}:null),Q(s))}catch(f){console.error("Failed to apply style to all subtitles:",f)}},dt=(s,n)=>{if(s.preventDefault(),!(a==null?void 0:a.subtitles.find(Te=>Te.id===n))||!R.current)return;we(n),R.current.getBoundingClientRect();const b=s.target.getBoundingClientRect(),C=b.left+b.width/2,ne=b.top+b.height/2;Se({x:s.clientX-C,y:s.clientY-ne})},mt=s=>{if(!Ne||!R.current)return;const n=R.current.getBoundingClientRect(),x=s.clientX-_e.x,f=s.clientY-_e.y,b=(x-n.left)/n.width*100,C=(f-n.top)/n.height*100,ne=Math.max(5,Math.min(95,b)),Te=Math.max(5,Math.min(95,C));ct(Ne,{x:ne,y:Te})},hs=()=>{we(null),Se({x:0,y:0})},xt=async()=>{var s;if(a!=null&&a.generation_id)try{const x=await(await fetch("/ai/subtitle-export",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,format:"srt"})})).json();x.success&&window.open(x.data.file_url,"_blank")}catch(n){console.error("Error exporting transcript:",n)}},us=async()=>{var s;if(j)try{const x=await(await fetch("/ai/rendered-video-status",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({video_id:j})})).json();x.success&&K({status:x.status,rendered_video_path:x.rendered_video_path})}catch{}};h.useEffect(()=>{let s=null;return(_==null?void 0:_.status)==="processing"&&(s=setInterval(us,3e3)),()=>{s&&clearInterval(s)}},[_==null?void 0:_.status,j]),h.useEffect(()=>{us()},[j]);const ht=async()=>{var s;if(a!=null&&a.generation_id){ie(!0);try{const x=await(await fetch("/ai/subtitle-render-video",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,video_id:j})})).json();x.success?K({status:"processing",rendered_video_path:null}):alert(`Failed to render video: ${x.message}`)}catch(n){console.error("Error rendering video:",n),alert("An error occurred while rendering the video. Please try again.")}finally{ie(!1)}}},Pe=s=>{const n=Math.floor(s/60),x=Math.floor(s%60);return`${n}:${x.toString().padStart(2,"0")}`},ut=async()=>{var s,n,x;try{P?document.exitFullscreen?await document.exitFullscreen():document.webkitExitFullscreen?await document.webkitExitFullscreen():document.msExitFullscreen&&await document.msExitFullscreen():(s=G.current)!=null&&s.requestFullscreen?await G.current.requestFullscreen():(n=G.current)!=null&&n.webkitRequestFullscreen?await G.current.webkitRequestFullscreen():(x=G.current)!=null&&x.msRequestFullscreen&&await G.current.msRequestFullscreen()}catch(f){console.error("Error toggling fullscreen:",f)}};h.useEffect(()=>{const s=()=>{const n=!!(document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement);ee(n)};return document.addEventListener("fullscreenchange",s),document.addEventListener("webkitfullscreenchange",s),document.addEventListener("msfullscreenchange",s),()=>{document.removeEventListener("fullscreenchange",s),document.removeEventListener("webkitfullscreenchange",s),document.removeEventListener("msfullscreenchange",s)}},[]);const $e=Ke(),qe=()=>{var s;if(R.current){const n=R.current.getBoundingClientRect(),x=(s=ye.current)==null?void 0:s.getBoundingClientRect();if(x){const f={width:n.width,height:n.height,top:n.top-x.top,left:n.left-x.left};c(p?{width:f.width*(p.width/100),height:f.height*(p.height/100),top:f.top+f.height*(p.y/100),left:f.left+f.width*(p.x/100)}:f)}}},pt=()=>{p||r({x:10,y:20,width:80,height:60})},gt=async()=>{var s;if(!(!p||!(a!=null&&a.generation_id)))try{(await fetch("/ai/subtitle-update-bounds",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((s=document.querySelector('meta[name="csrf-token"]'))==null?void 0:s.getAttribute("content"))||""},body:JSON.stringify({generation_id:a.generation_id,custom_bounds:p})})).ok&&console.log("Custom bounds saved successfully")}catch(n){console.error("Error saving custom bounds:",n)}};h.useEffect(()=>{a!=null&&a.custom_bounds&&r(a.custom_bounds)},[a]);const We=(s,n)=>{!p||!R.current||(s.preventDefault(),s.stopPropagation(),ce(n),de({x:s.clientX,y:s.clientY,bounds:{...p}}))},ft=s=>{if(!k||!v||!R.current)return;const n=R.current.getBoundingClientRect(),x=(s.clientX-v.x)/n.width*100,f=(s.clientY-v.y)/n.height*100;let b={...v.bounds};switch(k){case"move":b.x=Math.max(0,Math.min(100-b.width,v.bounds.x+x)),b.y=Math.max(0,Math.min(100-b.height,v.bounds.y+f));break;case"resize-tl":const C=Math.max(10,v.bounds.width-x),ne=Math.max(10,v.bounds.height-f);b.x=Math.max(0,v.bounds.x+(v.bounds.width-C)),b.y=Math.max(0,v.bounds.y+(v.bounds.height-ne)),b.width=C,b.height=ne;break;case"resize-tr":b.width=Math.max(10,Math.min(100-b.x,v.bounds.width+x)),b.height=Math.max(10,v.bounds.height-f),b.y=Math.max(0,v.bounds.y+(v.bounds.height-b.height));break;case"resize-bl":b.width=Math.max(10,v.bounds.width-x),b.height=Math.max(10,Math.min(100-b.y,v.bounds.height+f)),b.x=Math.max(0,v.bounds.x+(v.bounds.width-b.width));break;case"resize-br":b.width=Math.max(10,Math.min(100-b.x,v.bounds.width+x)),b.height=Math.max(10,Math.min(100-b.y,v.bounds.height+f));break}r(b)},ps=()=>{ce(null),de(null),qe(),gt()};return h.useEffect(()=>{const s=()=>{setTimeout(qe,50)},n=()=>qe();return R.current&&(R.current.addEventListener("loadedmetadata",n),R.current.addEventListener("loadeddata",n)),window.addEventListener("resize",s),setTimeout(qe,100),()=>{R.current&&(R.current.removeEventListener("loadedmetadata",n),R.current.removeEventListener("loadeddata",n)),window.removeEventListener("resize",s)}},[t,p]),h.useEffect(()=>{setTimeout(qe,100)},[P,p]),e.jsxs("div",{ref:G,className:`bg-white shadow-sm border ${P?"h-screen w-screen flex flex-col":"rounded-lg"}`,children:[e.jsx("canvas",{ref:Ce,style:{display:"none"}}),e.jsx("div",{className:"p-6 border-b bg-gradient-to-r from-purple-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center justify-between w-full",children:e.jsxs("button",{onClick:ut,className:"flex items-center gap-2 px-3 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-colors",title:P?"Exit fullscreen":"Enter fullscreen",children:[P?e.jsx(da,{className:"w-4 h-4"}):e.jsx(ia,{className:"w-4 h-4"}),P?"Exit Fullscreen":"Fullscreen"]})}),!a&&e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(aa,{className:"w-4 h-4 inline mr-2"}),"Language"]}),e.jsx("select",{value:w,onChange:s=>X(s.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-purple-500 focus:border-transparent",disabled:M,children:Object.entries(te).map(([s,n])=>e.jsxs("option",{value:s,children:[n.name," (",n.accuracy,"% accuracy)"]},s))})]}),e.jsx("button",{onClick:Xe,disabled:M||!j,className:"flex items-center gap-2 px-6 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg font-medium hover:from-purple-700 hover:to-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:M?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Generating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ls,{className:"w-4 h-4"}),"Generate Subtitles"]})})]})]})}),e.jsxs("div",{className:`p-6 ${P?"flex-1 overflow-auto":""}`,children:[(a==null?void 0:a.processing_status)==="processing"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),e.jsxs("span",{className:"font-medium text-blue-900",children:["Processing: ",a.progress.current_step]})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${a.progress.percentage}%`}})}),e.jsxs("div",{className:"flex justify-between text-sm text-blue-700",children:[e.jsxs("span",{children:[a.progress.percentage,"% complete"]}),e.jsxs("span",{children:[Pe(a.progress.processed_duration)," / ",Pe(a.progress.total_duration)]})]})]}),t&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("div",{ref:ye,className:"relative bg-black rounded-lg overflow-hidden",onMouseMove:mt,onMouseUp:hs,onMouseLeave:hs,style:{position:"relative"},children:[e.jsx("video",{ref:R,src:(a==null?void 0:a.original_video_path)||t,className:`w-full h-auto ${P?"max-h-[70vh]":"max-h-96"}`,controls:!1,onPlay:()=>ae(!0),onPause:()=>ae(!1)}),e.jsx("div",{className:"video-subtitle-overlay",style:{top:(u==null?void 0:u.top)||0,left:(u==null?void 0:u.left)||0,width:(u==null?void 0:u.width)||"100%",height:(u==null?void 0:u.height)||"100%"},children:$e&&e.jsx("div",{style:{pointerEvents:"auto"},children:e.jsx(Aa,{subtitle:$e,currentTime:Y,position:$e.position,onMouseDown:s=>dt(s,$e.id),onDoubleClick:()=>xs($e.id),editingSubtitle:ue===$e.id,editingText:je,onTextChange:be,onSaveEdit:it,onCancelEdit:()=>{oe(null),be("")}})})}),o&&p&&R.current&&e.jsx("div",{className:"bounds-editor-overlay",style:{top:R.current.getBoundingClientRect().top-((gs=ye.current)==null?void 0:gs.getBoundingClientRect().top)||0,left:R.current.getBoundingClientRect().left-((fs=ye.current)==null?void 0:fs.getBoundingClientRect().left)||0,width:R.current.getBoundingClientRect().width,height:R.current.getBoundingClientRect().height},onMouseMove:ft,onMouseUp:ps,onMouseLeave:ps,children:e.jsxs("div",{className:"bounds-rectangle",style:{left:`${p.x}%`,top:`${p.y}%`,width:`${p.width}%`,height:`${p.height}%`},onMouseDown:s=>We(s,"move"),children:[e.jsx("div",{className:"bounds-handle cursor-nw-resize",style:{top:"-6px",left:"-6px"},onMouseDown:s=>We(s,"resize-tl")}),e.jsx("div",{className:"bounds-handle cursor-ne-resize",style:{top:"-6px",right:"-6px"},onMouseDown:s=>We(s,"resize-tr")}),e.jsx("div",{className:"bounds-handle cursor-sw-resize",style:{bottom:"-6px",left:"-6px"},onMouseDown:s=>We(s,"resize-bl")}),e.jsx("div",{className:"bounds-handle cursor-se-resize",style:{bottom:"-6px",right:"-6px"},onMouseDown:s=>We(s,"resize-br")}),e.jsxs("div",{className:"bounds-label",children:["Subtitle Area (",Math.round(p.width),"% × ",Math.round(p.height),"%)"]})]})})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:rt,className:"flex items-center justify-center w-10 h-10 bg-purple-600 text-white rounded-full hover:bg-purple-700 transition-colors",children:A?e.jsx(zt,{className:"w-5 h-5"}):e.jsx(Qs,{className:"w-5 h-5 ml-0.5"})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{ref:ke,className:"h-2 bg-gray-200 rounded-full cursor-pointer",onClick:nt,children:e.jsx("div",{className:"h-full bg-purple-600 rounded-full transition-all",style:{width:`${Y/N*100}%`}})})}),e.jsxs("span",{className:"text-sm text-gray-600 min-w-0",children:[Pe(Y)," / ",Pe(N)]}),e.jsx("button",{onClick:lt,disabled:V||!j,className:"flex items-center gap-2 px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors text-sm",title:"Set current frame as thumbnail",children:V?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),"Setting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Rt,{className:"w-4 h-4"}),"Set Thumbnail"]})})]}),e.jsxs("div",{className:"flex items-center gap-4 p-3 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Subtitle Area:"}),e.jsxs("button",{onClick:()=>{pt(),g(!o)},className:`flex items-center gap-2 px-3 py-1 rounded-lg text-sm transition-colors ${o?"bg-purple-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[e.jsx(st,{className:"w-4 h-4"}),o?"Finish Editing":"Edit Bounds"]}),p&&e.jsxs("button",{onClick:()=>{r(null),g(!1)},className:"flex items-center gap-2 px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 text-sm transition-colors",children:[e.jsx(es,{className:"w-4 h-4"}),"Reset to Auto"]}),p&&e.jsxs("span",{className:"text-xs text-gray-500",children:[Math.round(p.width),"% × ",Math.round(p.height),"%"]})]})]})]}),(a==null?void 0:a.processing_status)==="completed"&&a.subtitles&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Subtitle Timeline"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:a.subtitles.map(s=>e.jsxs("div",{className:`flex items-center gap-4 p-3 border rounded-lg hover:bg-white transition-colors cursor-pointer ${Y>=s.start_time&&Y<=s.end_time?"border-purple-300 bg-purple-50":"border-gray-200 bg-white"}`,onClick:()=>{R.current&&(R.current.currentTime=s.start_time)},children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("span",{className:"text-sm font-mono text-gray-500",children:[Pe(s.start_time)," → ",Pe(s.end_time)]})}),e.jsx("div",{className:"flex-grow",children:e.jsx("p",{className:"text-gray-900",children:s.text})}),e.jsxs("div",{className:"flex-shrink-0 flex items-center gap-2",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),xs(s.id)},className:"p-1 text-gray-400 hover:text-purple-600 transition-colors",title:"Edit subtitle",children:e.jsx(tt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:n=>{n.stopPropagation(),y(s.id)},className:"p-1 text-gray-400 hover:text-purple-600 transition-colors",title:"Style subtitle",children:e.jsx(Zs,{className:"w-4 h-4"})})]})]},s.id))})]}),i&&(a==null?void 0:a.subtitles)&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-4",children:"Subtitle Style"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Style Presets"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-3",children:Object.entries(he).map(([s,n])=>{var b;const x=a.subtitles.find(C=>C.id===i),f=((b=x==null?void 0:x.style)==null?void 0:b.preset)===s;return e.jsx("button",{onClick:()=>{ve(i,{...n.style}),Q(s)},className:`p-3 border rounded-lg text-sm font-medium transition-all ${f?"border-purple-500 bg-purple-50 text-purple-700":"border-gray-200 bg-white text-gray-700 hover:border-purple-300 hover:bg-purple-50"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xs mb-1 px-2 py-1 rounded",style:{color:n.style.color,backgroundColor:(()=>{const C=n.style.backgroundColor;return C.includes("gradient")?"#FFD700":C==="transparent"?"rgba(0, 0, 0, 0)":C})(),textShadow:n.style.textShadow.includes("0px")?n.style.textShadow:"none",fontFamily:n.style.fontFamily.split(",")[0]},children:"Aa"}),n.name]})},s)})}),e.jsx("div",{className:"mt-3 flex justify-end",children:e.jsxs("button",{onClick:()=>ot(Z),className:"flex items-center gap-2 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:[e.jsx(ka,{className:"w-4 h-4"}),"Apply to All Subtitles"]})})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Family"}),e.jsxs("select",{value:((ys=(bs=(js=a.subtitles.find(s=>s.id===i))==null?void 0:js.style)==null?void 0:bs.fontFamily)==null?void 0:ys.split(",")[0])||"Arial",onChange:s=>ve(i,{fontFamily:s.target.value+", sans-serif"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent",children:[e.jsx("option",{value:"Arial",children:"Arial"}),e.jsx("option",{value:"Comic Sans MS",children:"Comic Sans MS"}),e.jsx("option",{value:"Impact",children:"Impact"}),e.jsx("option",{value:"Trebuchet MS",children:"Trebuchet MS"}),e.jsx("option",{value:"Times New Roman",children:"Times New Roman"}),e.jsx("option",{value:"Courier New",children:"Courier New"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Font Size"}),e.jsx("input",{type:"range",min:"12",max:"48",value:((Ns=(vs=a.subtitles.find(s=>s.id===i))==null?void 0:vs.style)==null?void 0:Ns.fontSize)||me.fontSize,onChange:s=>ve(i,{fontSize:parseInt(s.target.value)}),className:"w-full"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Text Color"}),e.jsx("input",{type:"color",value:Us(((_s=(ws=a.subtitles.find(s=>s.id===i))==null?void 0:ws.style)==null?void 0:_s.color)||me.color),onChange:s=>ve(i,{color:s.target.value}),className:"w-full h-8 rounded border"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Background"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"color",value:(()=>{var x;const s=a.subtitles.find(f=>f.id===i),n=((x=s==null?void 0:s.style)==null?void 0:x.backgroundColor)||"#000000";return Us(n)})(),onChange:s=>ve(i,{backgroundColor:s.target.value}),className:"flex-1 h-8 rounded border"}),e.jsx("button",{onClick:()=>ve(i,{backgroundColor:"transparent"}),className:"px-3 py-1 text-xs border rounded hover:bg-gray-100",title:"Make background transparent",children:"None"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alignment"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>ve(i,{textAlign:"left"}),className:"p-2 border rounded hover:bg-gray-100",children:e.jsx(Ht,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ve(i,{textAlign:"center"}),className:"p-2 border rounded hover:bg-gray-100",children:e.jsx(Lt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>ve(i,{textAlign:"right"}),className:"p-2 border rounded hover:bg-gray-100",children:e.jsx(Kt,{className:"w-4 h-4"})})]})]})]}),e.jsxs("div",{className:"mt-4 flex gap-2",children:[e.jsx("button",{onClick:()=>{var s,n;return ve(i,{bold:!((n=(s=a.subtitles.find(x=>x.id===i))==null?void 0:s.style)!=null&&n.bold)})},className:`p-2 border rounded hover:bg-gray-100 ${(ks=(Ss=a.subtitles.find(s=>s.id===i))==null?void 0:Ss.style)!=null&&ks.bold?"bg-purple-100 border-purple-300":""}`,children:e.jsx(Yt,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var s,n;return ve(i,{italic:!((n=(s=a.subtitles.find(x=>x.id===i))==null?void 0:s.style)!=null&&n.italic)})},className:`p-2 border rounded hover:bg-gray-100 ${(Ts=(Cs=a.subtitles.find(s=>s.id===i))==null?void 0:Cs.style)!=null&&Ts.italic?"bg-purple-100 border-purple-300":""}`,children:e.jsx(sa,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{var s,n;return ve(i,{underline:!((n=(s=a.subtitles.find(x=>x.id===i))==null?void 0:s.style)!=null&&n.underline)})},className:`p-2 border rounded hover:bg-gray-100 ${(As=(Fs=a.subtitles.find(s=>s.id===i))==null?void 0:Fs.style)!=null&&As.underline?"bg-purple-100 border-purple-300":""}`,children:e.jsx(_a,{className:"w-4 h-4"})})]})]}),(a==null?void 0:a.processing_status)==="completed"&&e.jsxs("div",{className:"flex items-center justify-between pt-6 border-t",children:[e.jsxs("button",{onClick:xt,className:"flex items-center gap-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(Pt,{className:"w-4 h-4"}),"Export Transcript"]}),e.jsx("button",{onClick:ht,disabled:O,className:"flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-green-600 to-emerald-600 text-white rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:O?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}),"Rendering Video..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Zt,{className:"w-5 h-5"}),"Render & Upload to All Platforms"]})})]}),(_==null?void 0:_.status)==="processing"&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-blue-600 border-t-transparent"}),e.jsx("span",{className:"font-medium text-blue-900",children:"Rendering video with subtitles..."})]}),e.jsx("div",{className:"w-full bg-blue-200 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:"100%"}})}),e.jsx("div",{className:"flex justify-between text-sm text-blue-700",children:e.jsx("span",{children:"Rendering in progress..."})})]}),(_==null?void 0:_.status)==="completed"&&(_==null?void 0:_.rendered_video_path)&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4 mb-6",children:[e.jsx("div",{className:"flex items-center gap-3 mb-3",children:e.jsx("span",{className:"font-medium text-green-900",children:"Video rendered successfully!"})}),e.jsx("a",{href:_.rendered_video_path,target:"_blank",rel:"noopener noreferrer",className:"text-green-700 underline",children:"Download or view rendered video"})]}),a&&e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded text-xs space-y-2",children:[e.jsx("p",{children:e.jsx("strong",{children:"Debug Info:"})}),e.jsxs("p",{children:["Generation ID: ",(a==null?void 0:a.generation_id)||"None"]}),e.jsxs("p",{children:["Status: ",(a==null?void 0:a.processing_status)||"None"]}),e.jsxs("p",{children:["Subtitles: ",((Es=a==null?void 0:a.subtitles)==null?void 0:Es.length)||0]}),e.jsxs("p",{children:["Video Time: ",Y.toFixed(2),"s"]}),e.jsxs("p",{children:["Active Subtitle: ",((Ms=Ke())==null?void 0:Ms.text)||"None"]}),e.jsxs("p",{children:["Active Subtitle Words: ",((Rs=(zs=Ke())==null?void 0:zs.words)==null?void 0:Rs.length)||0]}),e.jsxs("p",{children:["Current Style: ",(($s=(Ps=Ke())==null?void 0:Ps.style)==null?void 0:$s.preset)||"None"]}),(a==null?void 0:a.generation_id)&&e.jsx("button",{onClick:()=>{console.log("Manual word timing reload triggered"),Ue(a.generation_id)},className:"mt-2 px-2 py-1 bg-blue-500 text-white rounded text-xs",children:"Reload Word Timing"})]})]}),!t&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ls,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Video Available"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Upload a video to start using the subtitle generator."})]})]})]})},Ma=({videoPath:t,onRemovalComplete:j,className:d})=>{const[a,m]=h.useState("detection"),[M,H]=h.useState(!1),[O,ie]=h.useState(null),[V,E]=h.useState(null),[P,ee]=h.useState([]),[G,te]=h.useState(!1),[I,w]=h.useState({method:"inpainting",quality_preset:"balanced",sensitivity:"medium",detection_mode:"balanced"}),X=[{id:"detection",label:"Detection",icon:Ve},{id:"removal",label:"Removal",icon:Oe},{id:"progress",label:"Progress",icon:ze},{id:"quality",label:"Quality",icon:Re},{id:"settings",label:"Settings",icon:St}],i=[{id:"inpainting",name:"AI Inpainting",accuracy:95,speed:"Slow",description:"Advanced neural network fills watermark area"},{id:"content_aware",name:"Content-Aware Fill",accuracy:88,speed:"Medium",description:"Intelligent background reconstruction"},{id:"temporal_coherence",name:"Temporal Coherence",accuracy:92,speed:"Slow",description:"Frame-by-frame consistency analysis"},{id:"frequency_domain",name:"Frequency Domain",accuracy:85,speed:"Fast",description:"Spectral analysis and filtering"}],y=async()=>{var l,N;if(!t){alert("No video path provided");return}te(!0),H(!0);try{const U=await(await fetch("/ai/watermark-detect",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({video_path:t,sensitivity:I.sensitivity,detection_mode:"thorough"})})).json();if(!U.success)throw new Error(U.message||"Watermark detection failed");ie(U.data);const re=U.data.detected_watermarks||[];if(re.length===0){alert("🎉 No watermarks detected in your video! Your video is clean."),te(!1),H(!1);return}ee(re.map(je=>je.id)),m("progress");const oe=await(await fetch("/ai/watermark-remove",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((N=document.querySelector('meta[name="csrf-token"]'))==null?void 0:N.getAttribute("content"))||""},body:JSON.stringify({video_path:t,watermarks:re,method:I.method,quality_preset:"high"})})).json();if(!oe.success)throw new Error(oe.message||"Watermark removal failed");E(oe.data),L(oe.data.removal_id)}catch(z){console.error("Auto watermark removal failed:",z),alert(`Failed to remove watermarks: ${z instanceof Error?z.message:"Unknown error"}`),te(!1),H(!1)}},Z=async()=>{var l;if(t){H(!0);try{const z=await(await fetch("/ai/watermark-detect",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({video_path:t,sensitivity:I.sensitivity,detection_mode:I.detection_mode})})).json();z.success?(ie(z.data),ee(z.data.detected_watermarks.map(U=>U.id))):(console.error("Watermark detection failed:",z.error),alert(`Detection failed: ${z.message||"Unknown error"}`))}catch(N){console.error("Error detecting watermarks:",N),alert("An error occurred while detecting watermarks. Please try again.")}finally{H(!1)}}},Q=async()=>{var l;if(!(!O||P.length===0)){H(!0);try{const N=O.detected_watermarks.filter(re=>P.includes(re.id)),U=await(await fetch("/ai/watermark-remove",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content"))||""},body:JSON.stringify({video_path:t,watermarks:N,method:I.method,quality_preset:I.quality_preset})})).json();U.success?(E(U.data),m("progress"),L(U.data.removal_id)):(console.error("Watermark removal failed:",U.error),alert(`Removal failed: ${U.message||"Unknown error"}`))}catch(N){console.error("Error removing watermarks:",N),alert("An error occurred while removing watermarks. Please try again.")}finally{H(!1)}}},L=async l=>{const N=async()=>{var z;try{const re=await(await fetch("/ai/watermark-progress",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((z=document.querySelector('meta[name="csrf-token"]'))==null?void 0:z.getAttribute("content"))||""},body:JSON.stringify({removal_id:l})})).json();if(re.success){if(E(re.data),re.data.processing_status==="completed"){te(!1),H(!1),j==null||j(re.data);return}if(re.data.processing_status==="failed"){te(!1),H(!1),alert("Watermark removal failed. Please try again.");return}re.data.processing_status==="processing"&&setTimeout(N,3e3)}}catch(U){console.error("Error polling progress:",U),te(!1),H(!1)}};N()},D=l=>{switch(l){case"easy":return"text-green-600 bg-green-100";case"medium":return"text-yellow-600 bg-yellow-100";case"hard":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},_=l=>{switch(l){case"inpainting":return"text-purple-600 bg-purple-100";case"content_aware":return"text-blue-600 bg-blue-100";case"temporal_coherence":return"text-green-600 bg-green-100";case"frequency_domain":return"text-orange-600 bg-orange-100";default:return"text-gray-600 bg-gray-100"}},K=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Watermark Detection"}),e.jsx("p",{className:"text-blue-100",children:"AI-powered watermark detection and analysis"})]}),e.jsx("div",{className:"text-6xl opacity-20",children:e.jsx(Ve,{})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(J,{onClick:Z,disabled:M||!t,className:"bg-white text-blue-600 hover:bg-blue-50",children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),M?"Detecting...":"Detect Watermarks"]})})]}),O&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Detection Results"}),e.jsxs(B,{className:"bg-green-100 text-green-800",children:[O.detected_watermarks.length," watermarks found"]})]}),O.detected_watermarks.length===0?e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Ve,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Watermarks Detected"}),e.jsx("p",{className:"text-gray-600",children:"The video appears to be clean of watermarks."})]}):e.jsx("div",{className:"space-y-4",children:O.detected_watermarks.map((l,N)=>e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsx("input",{type:"checkbox",checked:P.includes(l.id),onChange:z=>{z.target.checked?ee([...P,l.id]):ee(P.filter(U=>U!==l.id))},className:"w-4 h-4 text-blue-600 rounded"}),e.jsxs("h4",{className:"font-medium capitalize",children:[l.type," Watermark #",N+1]}),e.jsx(B,{className:D(l.removal_difficulty),children:l.removal_difficulty})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Confidence:"}),e.jsxs("div",{className:"font-medium",children:[l.confidence,"%"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Location:"}),e.jsxs("div",{className:"font-medium",children:[l.location.x,", ",l.location.y]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Size:"}),e.jsxs("div",{className:"font-medium",children:[l.location.width,"×",l.location.height]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Frames:"}),e.jsx("div",{className:"font-medium",children:l.frames_detected})]})]})]}),e.jsxs("div",{className:"text-2xl",children:[l.type==="logo"&&"🎨",l.type==="text"&&"📝",l.type==="brand"&&"🏷️",l.type==="channel"&&"📺"]})]})},l.id))})]})]}),F=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Removal Method"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:i.map(l=>e.jsxs("div",{className:`p-4 rounded-lg border-2 cursor-pointer transition-colors ${I.method===l.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,onClick:()=>w(N=>({...N,method:l.id})),children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h4",{className:"font-medium",children:l.name}),e.jsxs(B,{className:_(l.id),children:[l.accuracy,"% accuracy"]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:l.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-500",children:["Speed: ",l.speed]}),e.jsx("div",{className:"flex items-center",children:e.jsx("div",{className:"flex space-x-1",children:[...Array(5)].map((N,z)=>e.jsx("div",{className:`w-2 h-2 rounded-full ${z<Math.floor(l.accuracy/20)?"bg-green-500":"bg-gray-300"}`},z))})})]})]},l.id))})]}),O&&P.length>0&&e.jsxs("div",{className:"bg-white rounded-lg p-6 border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Selected for Removal"}),e.jsx("div",{className:"space-y-3",children:O.detected_watermarks.filter(l=>P.includes(l.id)).map((l,N)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"text-xl",children:[l.type==="logo"&&"🎨",l.type==="text"&&"📝",l.type==="brand"&&"🏷️",l.type==="channel"&&"📺"]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium capitalize",children:[l.type," Watermark"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[l.confidence,"% confidence"]})]})]}),e.jsx(B,{className:D(l.removal_difficulty),children:l.removal_difficulty})]},l.id))})]}),e.jsxs("div",{className:"bg-gradient-to-r from-red-600 to-pink-600 rounded-xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Start Removal"}),e.jsxs("p",{className:"text-red-100",children:["Remove ",P.length," selected watermark",P.length!==1?"s":""]})]}),e.jsx("div",{className:"text-6xl opacity-20",children:e.jsx(Oe,{})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs(J,{onClick:Q,disabled:M||P.length===0,className:"bg-white text-red-600 hover:bg-red-50",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),M?"Processing...":"Remove Watermarks"]})})]})]}),$=()=>e.jsx("div",{className:"space-y-6",children:V?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 rounded-xl p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Removal Progress"}),e.jsx("p",{className:"text-green-100",children:V.processing_status==="completed"?"Completed":V.processing_status==="processing"?"Processing...":V.processing_status})]}),e.jsx("div",{className:"text-6xl opacity-20",children:V.processing_status==="completed"?e.jsx(ss,{}):e.jsx(xe,{})})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm",children:"Progress"}),e.jsxs("span",{className:"text-sm",children:[V.progress.percentage,"%"]})]}),e.jsx(Le,{value:V.progress.percentage,className:"h-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ts,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Current Step"}),e.jsx("p",{className:"font-medium capitalize",children:V.progress.current_step})]})]})}),e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(na,{className:"w-8 h-8 text-purple-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Frames Processed"}),e.jsxs("p",{className:"font-medium",children:[V.progress.frames_processed," / ",V.progress.total_frames]})]})]})}),e.jsx(S,{className:"p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(et,{className:"w-8 h-8 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Est. Time"}),e.jsxs("p",{className:"font-medium",children:[Math.round(V.progress.estimated_time/60)," min"]})]})]})})]}),V.removal_results&&V.removal_results.length>0&&e.jsxs("div",{className:"bg-white rounded-lg p-6 border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Removal Results"}),e.jsx("div",{className:"space-y-3",children:V.removal_results.map((l,N)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[l.removal_success?e.jsx(ss,{className:"w-5 h-5 text-green-600"}):e.jsx(as,{className:"w-5 h-5 text-red-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Watermark ",N+1]}),e.jsx("p",{className:"text-sm text-gray-600",children:l.removal_success?"Successfully removed":"Removal failed"})]})]}),e.jsxs(B,{className:l.removal_success?"bg-green-100 text-green-800":"bg-red-100 text-red-800",children:[l.confidence,"% confidence"]})]},N))})]})]}):e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(ze,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Active Removal"}),e.jsx("p",{className:"text-gray-600",children:"Start watermark removal to see progress here."})]})}),A=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:[e.jsx(Re,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Quality Analysis"}),e.jsx("p",{className:"text-gray-600",children:"Complete watermark removal to see quality analysis."})]})}),ae=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-6 border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Detection Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sensitivity"}),e.jsxs("select",{value:I.sensitivity,onChange:l=>w(N=>({...N,sensitivity:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"low",children:"Low - Detect obvious watermarks"}),e.jsx("option",{value:"medium",children:"Medium - Balanced detection"}),e.jsx("option",{value:"high",children:"High - Detect subtle watermarks"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Detection Mode"}),e.jsxs("select",{value:I.detection_mode,onChange:l=>w(N=>({...N,detection_mode:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"fast",children:"Fast - Quick detection"}),e.jsx("option",{value:"balanced",children:"Balanced - Good accuracy and speed"}),e.jsx("option",{value:"thorough",children:"Thorough - Maximum accuracy"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-6 border",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Removal Settings"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quality Preset"}),e.jsxs("select",{value:I.quality_preset,onChange:l=>w(N=>({...N,quality_preset:l.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"fast",children:"Fast - Quick processing"}),e.jsx("option",{value:"balanced",children:"Balanced - Good quality and speed"}),e.jsx("option",{value:"high",children:"High - Best quality"}),e.jsx("option",{value:"ultra",children:"Ultra - Maximum quality"})]})]})})]})]}),Y=()=>{switch(a){case"detection":return K();case"removal":return F();case"progress":return $();case"quality":return A();case"settings":return ae();default:return K()}};return!O&&!G?e.jsxs("div",{className:`space-y-4 ${d}`,children:[e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Oe,{className:"w-8 h-8 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:"Remove Watermarks"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically detect and remove watermarks from your video using AI"})]}),e.jsx(J,{onClick:y,disabled:M||!t,size:"lg",className:"bg-red-600 hover:bg-red-700 text-white",children:M?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"w-4 h-4 mr-2 animate-spin"}),"Processing..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-4 h-4 mr-2"}),"Find and Remove Watermarks"]})}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"This will scan your entire video and automatically remove detected watermarks"})]}),e.jsxs("details",{className:"mt-6",children:[e.jsx("summary",{className:"cursor-pointer text-sm font-medium text-muted-foreground hover:text-foreground",children:"Advanced Options"}),e.jsxs("div",{className:"mt-3 space-y-3 p-3 border rounded-lg bg-muted/30",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Detection Sensitivity"}),e.jsxs("select",{value:I.sensitivity,onChange:l=>w({...I,sensitivity:l.target.value}),className:"w-full mt-1 px-3 py-2 border rounded-md text-sm",children:[e.jsx("option",{value:"low",children:"Low - Fast detection"}),e.jsx("option",{value:"medium",children:"Medium - Balanced"}),e.jsx("option",{value:"high",children:"High - Thorough detection"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"Removal Method"}),e.jsx("select",{value:I.method,onChange:l=>w({...I,method:l.target.value}),className:"w-full mt-1 px-3 py-2 border rounded-md text-sm",children:i.map(l=>e.jsxs("option",{value:l.id,children:[l.name," - ",l.description]},l.id))})]})]})]})]}):e.jsxs("div",{className:`max-w-6xl mx-auto p-6 ${d}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"AI Watermark Remover"}),e.jsx("p",{className:"text-gray-600",children:"Detect and remove watermarks from your videos"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{className:"bg-blue-100 text-blue-800",children:"AI Powered"}),e.jsx(B,{className:"bg-green-100 text-green-800",children:"High Quality"})]})]}),e.jsx("div",{className:"flex space-x-1 mb-6 bg-gray-100 p-1 rounded-lg",children:X.map(l=>{const N=l.icon;return e.jsxs("button",{onClick:()=>m(l.id),className:`flex items-center px-4 py-2 rounded-md text-sm font-medium transition-colors ${a===l.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[e.jsx(N,{className:"w-4 h-4 mr-2"}),l.label]},l.id)})}),e.jsx("div",{className:"animate-in fade-in slide-in-from-bottom-4 duration-300",children:Y()})]})};function za({videoId:t,videoPath:j,title:d,className:a,onThumbnailSet:m}){const[M,H]=h.useState(null),[O,ie]=h.useState(!1),[V,E]=h.useState(null),[P,ee]=h.useState("suggestions"),{toast:G}=ds(),te=async()=>{var w,X;if(!t){G({title:"No Video ID",description:"Please provide a video ID to optimize thumbnails.",variant:"destructive"});return}ie(!0);try{const y=await(await fetch("/ai/optimize-thumbnails",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((w=document.querySelector('meta[name="csrf-token"]'))==null?void 0:w.getAttribute("content"))||""},body:JSON.stringify({video_id:t,title:d||"Amazing Video",platforms:["youtube","instagram","tiktok"]})})).json();if(y.success)H(y.data),G({title:"Thumbnail Optimization Complete! 🎨",description:`AI has analyzed your video and extracted ${((X=y.data.extracted_frames)==null?void 0:X.length)||0} thumbnail frames.`});else throw new Error(y.message||"Failed to optimize thumbnails")}catch(i){console.error("Thumbnail optimization error:",i),G({title:"Optimization Failed",description:"Failed to optimize thumbnails. Please try again.",variant:"destructive"})}finally{ie(!1)}},I=async(w,X)=>{var i;if(!t){G({title:"Error",description:"Video ID is required to set thumbnail.",variant:"destructive"});return}try{const Z=await(await fetch("/ai/set-video-thumbnail",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((i=document.querySelector('meta[name="csrf-token"]'))==null?void 0:i.getAttribute("content"))||""},body:JSON.stringify({video_id:t,frame_id:w,thumbnail_path:X})})).json();if(Z.success)G({title:"Thumbnail Set Successfully! 🎯",description:"This thumbnail has been set for all platforms."}),m&&m();else throw new Error(Z.message||"Failed to set thumbnail")}catch(y){console.error("Set thumbnail error:",y),G({title:"Setting Failed",description:"Failed to set thumbnail. Please try again.",variant:"destructive"})}};return!M&&!O?e.jsxs(S,{className:le("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",a),children:[e.jsxs(q,{className:"text-center pb-4",children:[e.jsx("div",{className:"mx-auto p-3 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full w-fit",children:e.jsx(Ie,{className:"w-8 h-8 text-white"})}),e.jsx(W,{className:"text-2xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"AI Thumbnail Optimizer"}),e.jsx("p",{className:"text-gray-600",children:"Generate eye-catching thumbnails with AI-powered optimization and CTR predictions"})]}),e.jsxs(T,{className:"text-center space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Re,{className:"w-6 h-6 text-purple-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"CTR Prediction"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx($t,{className:"w-6 h-6 text-blue-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Face Detection"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(Zs,{className:"w-6 h-6 text-green-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Color Analysis"})]}),e.jsxs("div",{className:"p-3 bg-white rounded-lg border",children:[e.jsx(tt,{className:"w-6 h-6 text-orange-600 mx-auto mb-2"}),e.jsx("p",{className:"font-medium",children:"Text Optimization"})]})]}),e.jsxs(J,{onClick:te,disabled:!t,size:"lg",className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(os,{className:"w-5 h-5 mr-2"}),"Analyze Video & Extract Thumbnails"]}),!t&&e.jsx("p",{className:"text-sm text-gray-500",children:"Video ID required for thumbnail analysis"})]})]}):O?e.jsx(S,{className:le("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",a),children:e.jsxs(T,{className:"p-8 text-center space-y-6",children:[e.jsx("div",{className:"mx-auto p-4 bg-gradient-to-r from-purple-600 to-pink-600 rounded-full w-fit animate-pulse",children:e.jsx(Ie,{className:"w-10 h-10 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Optimizing Thumbnails..."}),e.jsx("p",{className:"text-gray-600 mb-4",children:"AI is analyzing frames, detecting faces, and predicting CTR"}),e.jsx("div",{className:"w-full max-w-md mx-auto bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 h-2 rounded-full animate-pulse",style:{width:"75%"}})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-purple-600"}),e.jsx("span",{children:"Extracting frames..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-blue-600"}),e.jsx("span",{children:"Analyzing faces..."})]}),e.jsxs("div",{className:"flex items-center justify-center gap-2 p-3 bg-white rounded-lg",children:[e.jsx(xe,{className:"w-4 h-4 animate-spin text-green-600"}),e.jsx("span",{children:"Predicting CTR..."})]})]})]})}):e.jsxs(S,{className:le("border-2 border-purple-200 bg-gradient-to-br from-purple-50 to-pink-50",a),children:[e.jsx(q,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-600 to-pink-600 rounded-lg",children:e.jsx(Ie,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx(W,{className:"text-xl font-bold bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent",children:"Thumbnail Optimization Results"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Score: ",M.overall_score,"/100 • ",M.extracted_frames.length," frames analyzed"]})]})]}),e.jsxs(J,{onClick:te,disabled:O,size:"sm",variant:"outline",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Re-analyze"]})]})}),e.jsx(T,{children:e.jsxs(rs,{value:P,onValueChange:ee,className:"w-full",children:[e.jsxs(ns,{className:"grid w-full grid-cols-3",children:[e.jsx(ge,{value:"suggestions",children:"Suggestions"}),e.jsx(ge,{value:"platforms",children:"Platform Thumbnail Specifications"}),e.jsx(ge,{value:"testing",children:"A/B Testing"})]}),e.jsx(fe,{value:"suggestions",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:M.thumbnail_suggestions.slice(0,3).map((w,X)=>e.jsx(S,{className:X===0?"border-2 border-gold":"",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:w.preview_url,alt:`Thumbnail at ${w.timestamp}s`,className:"w-32 h-18 object-cover rounded-lg border-2 border-gray-200",onError:i=>{var Z;const y=i.target;y.style.display="none",(Z=y.nextElementSibling)==null||Z.classList.remove("hidden")}}),e.jsx("div",{className:"w-32 h-18 bg-gray-200 rounded-lg flex items-center justify-center hidden",children:e.jsx(Qs,{className:"w-6 h-6 text-gray-400"})}),X===0&&e.jsxs(B,{className:"absolute -top-2 -right-2 bg-yellow-500 text-black",children:[e.jsx(Ot,{className:"w-3 h-3 mr-1"}),"Best"]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("h4",{className:"font-medium",children:["Frame at ",w.timestamp,"s"]}),e.jsxs(B,{variant:"outline",children:[w.predicted_ctr,"% CTR"]}),e.jsxs(B,{variant:"outline",children:[w.confidence_score,"% confidence"]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-1",children:"Why this frame:"}),e.jsx("ul",{className:"text-sm text-gray-600",children:w.reasons.map((i,y)=>e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),i]},y))})]}),w.design_scores&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-medium text-gray-700 mb-2",children:"Design Feature Scores:"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(w.design_scores).map(([i,y])=>e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("span",{className:"text-gray-600 capitalize",children:[i.replace("_"," "),":"]}),e.jsx(B,{variant:"outline",className:le("text-xs px-1.5 py-0.5",y>=80?"border-green-500 text-green-700 bg-green-50":y>=60?"border-yellow-500 text-yellow-700 bg-yellow-50":"border-red-500 text-red-700 bg-red-50"),children:y})]},i))})]})]})]}),e.jsx("div",{className:"flex flex-col gap-2",children:e.jsxs(J,{size:"sm",onClick:()=>I(w.frame_id,w.path),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),"Set as Thumbnail"]})})]})})},w.frame_id))})}),e.jsx(fe,{value:"platforms",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:Object.entries(M.platform_optimizations).map(([w,X])=>e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs(W,{className:"text-lg capitalize flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5"}),w]})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Specifications"}),e.jsxs("div",{className:"text-sm space-y-1",children:[e.jsxs("div",{children:["Dimensions: ",X.specifications.width,"×",X.specifications.height]}),e.jsxs("div",{children:["Aspect Ratio: ",X.specifications.aspect_ratio]}),e.jsxs("div",{children:["Max Size: ",X.specifications.max_file_size,"KB"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Optimization Focus"}),e.jsx("div",{className:"text-sm space-y-1",children:X.design_adjustments.map((i,y)=>e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-purple-400 rounded-full mt-2 flex-shrink-0"}),i]},y))})]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expected Improvement:"}),e.jsxs(B,{className:"bg-green-100 text-green-800",children:[e.jsx(Ae,{className:"w-3 h-3 mr-1"}),X.expected_improvement]})]})]})]},w))})}),e.jsx(fe,{value:"testing",className:"space-y-4",children:e.jsx("div",{className:"grid gap-4",children:M.ab_test_variants.map(w=>e.jsxs(S,{children:[e.jsx(q,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(W,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ze,{className:"w-5 h-5"}),w.variant_id.replace("_"," ").toUpperCase()]}),e.jsxs(B,{variant:"outline",children:[w.confidence_level,"% confidence"]})]})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Test Hypothesis"}),e.jsx("p",{className:"text-sm text-gray-600",children:w.test_hypothesis})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Planned Modifications"}),e.jsx("div",{className:"space-y-1",children:w.modifications.map((X,i)=>e.jsxs("div",{className:"text-sm text-gray-600 flex items-start gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-blue-400 rounded-full mt-2 flex-shrink-0"}),X]},i))})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Expected CTR Increase:"}),e.jsxs(B,{className:"bg-blue-100 text-blue-800",children:["+",w.expected_outcome.expected_ctr_increase]})]})]})]},w.variant_id))})})]})})]})}const Ra=({isOpen:t,onClose:j,videoId:d,videoPath:a,title:m,onThumbnailSet:M})=>{if(!t)return null;const H=()=>{const O=document.createElement("div");O.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",O.textContent="✓ Thumbnail optimized successfully!",document.body.appendChild(O),setTimeout(()=>{document.body.contains(O)&&document.body.removeChild(O)},3e3),M&&M()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"p-6 border-b bg-gradient-to-r from-purple-50 to-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-gradient-to-r from-purple-500 to-blue-500 rounded-lg",children:e.jsx(Ie,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"AI Thumbnail Optimizer"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Create and optimize thumbnails for better engagement"})]})]}),e.jsx("button",{onClick:j,className:"flex items-center justify-center w-8 h-8 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-full transition-colors",title:"Close",children:e.jsx(es,{className:"w-4 h-4"})})]})}),e.jsx("div",{className:"p-6",children:e.jsx(za,{videoId:d,videoPath:a,title:m,onThumbnailSet:H})})]})})},Pa={youtube:qt,instagram:Dt,tiktok:Me,facebook:Me,snapchat:Me,pinterest:Me,x:Me},$a={pending:ts,processing:as,success:ss,failed:cs},Oa={pending:"bg-yellow-100 text-yellow-800",processing:"bg-blue-100 text-blue-800",success:"bg-green-100 text-green-800",failed:"bg-red-100 text-red-800"},Ia=(t,j)=>{if(!t||!j)return{status:"unknown",color:"text-gray-500",label:"Unknown"};const d=t*j;return d>=1920*1080?{status:"great",color:"text-green-600",label:"1080p+"}:d>=1280*720?{status:"good",color:"text-orange-500",label:"720p"}:{status:"poor",color:"text-red-600",label:"Low Quality"}};function Rr({video:t}){const j=[{title:"My channels",href:"/dashboard"},{title:"Videos",href:"/videos"},{title:t.title,href:`/videos/${t.id}/edit`}],{data:d,setData:a,put:m,processing:M,errors:H}=jt({title:t.title||"",description:t.description||"",tags:t.tags||[],thumbnail:null}),[O,ie]=h.useState("overview"),[V,E]=h.useState(!1),[P,ee]=h.useState("tikomat"),[G,te]=h.useState(!1),[I,w]=h.useState(!1),[X,i]=h.useState(t.thumbnail||null),[y,Z]=h.useState([0]),[Q,L]=h.useState(null),[D,_]=h.useState(null),[K,F]=h.useState([]),[$,A]=h.useState(!1),[ae,Y]=h.useState(!1),[l,N]=h.useState(!1),[z,U]=h.useState(!1),[re]=h.useState(["youtube","instagram","tiktok","facebook","x","pinterest","snapchat"]),ue=h.useRef(null),oe=Ia(t.width,t.height),je=r=>{r.preventDefault(),m(`/videos/${t.id}`)},be=()=>{E(!0)},Ne=()=>{ls.delete(`/videos/${t.id}`,{data:{delete_option:P},onSuccess:()=>{ls.visit("/videos")}})},we=(r,o)=>{confirm(`Are you sure you want to remove this video from ${o}?`)&&ls.delete(`/video-targets/${r}`,{preserveScroll:!0,onSuccess:()=>{},onError:g=>{console.error("Failed to remove video from platform:",g),alert("Failed to remove video from platform. Please try again.")}})},_e=r=>{if(r.platform_url)return r.platform_url;switch(r.platform){case"youtube":return r.platform_video_id?`https://youtube.com/watch?v=${r.platform_video_id}`:null;case"instagram":return r.platform_video_id?`https://instagram.com/p/${r.platform_video_id}`:null;case"tiktok":return r.platform_video_id?`https://tiktok.com/@username/video/${r.platform_video_id}`:null;default:return null}},Se=async()=>{var r;te(!0);try{const o=await fetch("/ai/generate-video-content",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({video_id:t.id,content_type:"title",current_title:d.title})});if(o.ok){const g=await o.json();if(g.success&&g.data.optimized_title){a("title",g.data.optimized_title);const k=g.data.analysis_summary;let ce="Title generated based on video content analysis";if(k){const v=[];k.has_transcript&&v.push("audio transcription"),k.scenes_detected>0&&v.push(`${k.scenes_detected} visual scenes`),k.content_category!=="unknown"&&v.push(`${k.content_category} content`),v.length>0&&(ce+=`. Analyzed: ${v.join(", ")}.`)}alert(`✅ AI Title Generated!

${ce}`)}}else{const g=await o.json();console.error("Failed to generate AI title:",g),alert(`Failed to generate title: ${g.message||"Unknown error"}`)}}catch(o){console.error("Failed to generate AI title:",o),alert("An error occurred while generating the title. Please try again.")}finally{te(!1)}},R=async()=>{var r;w(!0);try{const o=await fetch("/ai/generate-video-content",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({video_id:t.id,content_type:"description",current_description:d.description})});if(o.ok){const g=await o.json();if(g.success&&g.data.optimized_description){a("description",g.data.optimized_description);const k=g.data.analysis_summary;let ce="Description generated based on video content analysis";if(k){const v=[];k.has_transcript&&v.push("audio transcription"),k.scenes_detected>0&&v.push(`${k.scenes_detected} visual scenes`),k.content_category!=="unknown"&&v.push(`${k.content_category} content`),v.length>0&&(ce+=`. Analyzed: ${v.join(", ")}.`)}alert(`✅ AI Description Generated!

${ce}`)}}else{const g=await o.json();console.error("Failed to generate AI description:",g),alert(`Failed to generate description: ${g.message||"Unknown error"}`)}}catch(o){console.error("Failed to generate AI description:",o),alert("An error occurred while generating the description. Please try again.")}finally{w(!1)}},ke=async r=>{var g,k;const o=(g=r.target.files)==null?void 0:g[0];if(o){if(!o.type.startsWith("image/")){alert("Please select a valid image file");return}if(o.size>5*1024*1024){alert("Image size must be less than 5MB");return}U(!0),L(o);try{const ce=new FormData;ce.append("thumbnail",o),ce.append("video_id",t.id.toString());const v=(k=document.querySelector('meta[name="csrf-token"]'))==null?void 0:k.getAttribute("content");console.log("CSRF Token:",v?"Found":"Missing");const de=await fetch("/ai/upload-custom-thumbnail",{method:"POST",headers:{"X-CSRF-TOKEN":v||"",Accept:"application/json"},body:ce});if(console.log("Response status:",de.status),console.log("Response headers:",Object.fromEntries(de.headers.entries())),de.ok){const he=await de.json();if(he.success){i(he.thumbnail_url);const me=document.createElement("div");me.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",me.textContent="✅ Thumbnail uploaded successfully!",document.body.appendChild(me),setTimeout(()=>{document.body.contains(me)&&document.body.removeChild(me)},3e3)}else throw new Error(he.message||"Upload failed")}else{const he=de.headers.get("content-type");if(console.log("Error response content-type:",he),he&&he.includes("application/json")){const me=await de.json();throw new Error(me.message||`HTTP ${de.status}: Upload failed`)}else{const me=await de.text();throw console.log("HTML error response:",me.substring(0,200)),new Error(`HTTP ${de.status}: Server returned HTML instead of JSON - check Laravel logs`)}}}catch(ce){console.error("Failed to upload thumbnail:",ce);const v=document.createElement("div");v.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",v.textContent=`❌ Upload failed: ${ce instanceof Error?ce.message:"Unknown error"}`,document.body.appendChild(v),setTimeout(()=>{document.body.contains(v)&&document.body.removeChild(v)},5e3);const de=new FileReader;de.onload=he=>{var me;i((me=he.target)==null?void 0:me.result)},de.readAsDataURL(o)}finally{U(!1)}}},ye=r=>{_(r)};h.useEffect(()=>{const r={title:t.title||"",description:t.description||"",tags:t.tags||[]},o=JSON.stringify(d)!==JSON.stringify(r);Y(o)},[d,t]);const Ce=async()=>{N(!0);const r=async(o=0)=>{var g,k,ce;try{const v=((g=document.querySelector('meta[name="csrf-token"]'))==null?void 0:g.getAttribute("content"))||((k=document.querySelector('input[name="_token"]'))==null?void 0:k.getAttribute("value"))||"";if(!v)throw new Error("CSRF token not found");const de=await fetch("/ai/analyze-video-tags",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":v,Accept:"application/json"},body:JSON.stringify({video_id:t.id,title:d.title||"",description:d.description||""})});if(de.status===419&&o===0){console.log("CSRF token expired, refreshing...");const he=await fetch("/");if(he.ok){const me=await he.text(),He=(ce=new DOMParser().parseFromString(me,"text/html").querySelector('meta[name="csrf-token"]'))==null?void 0:ce.getAttribute("content");if(He){const Xe=document.querySelector('meta[name="csrf-token"]');return Xe&&Xe.setAttribute("content",He),r(1)}}}return de}catch(v){if(o===0)return console.log("Request failed, retrying once...",v),r(1);throw v}};try{const o=await r();if(o.ok){const g=await o.json();if(console.log("Tag generation response:",g),g.success&&g.data&&g.data.analysis.tags)a("tags",g.data.analysis.tags);else{console.warn("Unexpected response structure:",g);const k=document.createElement("div");k.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",k.textContent="⚠️ Tag generation failed - unexpected response",document.body.appendChild(k),setTimeout(()=>{document.body.contains(k)&&document.body.removeChild(k)},5e3)}}else{const g=await o.text();console.error("HTTP Error:",o.status,o.statusText,g);const k=document.createElement("div");k.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",k.textContent=`⚠️ Tag generation failed - Server error (${o.status})`,document.body.appendChild(k),setTimeout(()=>{document.body.contains(k)&&document.body.removeChild(k)},5e3)}}catch(o){console.error("Failed to generate tags:",o);const g=document.createElement("div");g.className="fixed top-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",g.textContent="⚠️ Tag generation failed - Network error",document.body.appendChild(g),setTimeout(()=>{document.body.contains(g)&&document.body.removeChild(g)},5e3)}finally{N(!1)}},u=r=>{d.tags.includes(r)||a("tags",[...d.tags,r])},c=r=>{a("tags",d.tags.filter(o=>o!==r))},p=async()=>{var r;try{if((await fetch(`/videos/${t.id}/update-platforms`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"))||""},body:JSON.stringify({title:d.title,description:d.description,tags:d.tags})})).ok){Y(!1);const g=document.createElement("div");g.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",g.textContent="✓ All platforms updated successfully!",document.body.appendChild(g),setTimeout(()=>{document.body.contains(g)&&document.body.removeChild(g)},3e3)}}catch(o){console.error("Failed to update platforms:",o)}};return e.jsxs(wt,{breadcrumbs:j,children:[e.jsx(bt,{title:`Edit: ${t.title}`}),e.jsxs("div",{className:"flex h-full flex-1 flex-col gap-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(yt,{href:"/videos",children:e.jsxs(J,{variant:"outline",size:"sm",children:[e.jsx(It,{className:"mr-2 h-4 w-4"}),"Back to Videos"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:t.title}),e.jsx("p",{className:"text-muted-foreground",children:"Edit and optimize your video with AI-powered tools"})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(J,{variant:"outline",onClick:be,className:"text-red-600 hover:text-red-700",children:[e.jsx(Oe,{className:"mr-2 h-4 w-4"}),"Delete"]})})]}),ae&&e.jsx(S,{className:"border-blue-200 bg-blue-50",children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500 rounded-full",children:e.jsx(xe,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Unsaved Changes Detected"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Update all connected platforms with your changes"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(J,{onClick:p,className:"bg-blue-600 hover:bg-blue-700",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),"Update All Platforms"]}),e.jsxs(J,{variant:"outline",onClick:()=>{},children:[e.jsx(st,{className:"w-4 h-4 mr-2"}),"Manage Platforms"]})]})]})})}),e.jsxs(rs,{value:O,onValueChange:ie,className:"w-full",children:[e.jsxs(ns,{className:"grid w-full grid-cols-2",children:[e.jsx(ge,{value:"overview",children:"Overview/Edit"}),e.jsx(ge,{value:"performance",children:"Performance"})]}),e.jsx(fe,{value:"overview",className:"space-y-6",children:e.jsxs("div",{className:"grid lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(S,{children:[e.jsx(q,{children:e.jsx(W,{className:"flex items-center gap-2",children:"Video Editor"})}),e.jsx(T,{children:e.jsx(Qe,{children:e.jsx(Ea,{videoPath:t.video_path||t.file_path||"",videoId:t.id,videoTitle:t.title})})})]}),e.jsxs(S,{children:[e.jsxs(q,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Oe,{className:"w-5 h-5"}),"Watermark Removal"]}),e.jsx(Ge,{children:"Automatically detect and remove watermarks from your video"})]}),e.jsx(T,{children:e.jsx(Qe,{children:e.jsx(Ma,{videoPath:t.original_file_path||t.file_path||"",onRemovalComplete:r=>{console.log("Watermark removal completed:",r);const o=document.createElement("div");o.className="fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-lg shadow-lg z-50",o.textContent="✅ Watermarks removed successfully!",document.body.appendChild(o),setTimeout(()=>{document.body.contains(o)&&document.body.removeChild(o)},5e3)}})})})]}),e.jsxs(S,{children:[e.jsx(q,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(De,{className:"w-5 h-5"}),"AI Analysis"]})}),e.jsxs(T,{children:[e.jsx(Qe,{children:e.jsx(Ca,{videoId:t.id,videoPath:t.original_file_path||t.file_path,onAnalysisComplete:ye})}),D&&e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Category"}),e.jsx("p",{className:"text-lg",children:D.category||"Entertainment"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Mood"}),e.jsx("p",{className:"text-lg",children:D.mood||"Positive"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"AI Tags"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:(D.tags||["creative","engaging","trending"]).map((r,o)=>e.jsx(B,{variant:"secondary",className:"text-xs",children:r},o))})]})]})]})]}),e.jsxs(S,{children:[e.jsxs(q,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(et,{className:"w-5 h-5"}),"AI Suggestions"]}),e.jsx(Ge,{children:"Most important optimization recommendations"})]}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"p-4 border border-orange-200 bg-orange-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Ae,{className:"w-5 h-5 text-orange-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-orange-900",children:"Increase Engagement"}),e.jsx("p",{className:"text-sm text-orange-700",children:"Add a call-to-action in the first 5 seconds to boost viewer retention."})]})]})}),e.jsx("div",{className:"p-4 border border-blue-200 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(Re,{className:"w-5 h-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Optimize Thumbnail"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Consider adding text overlay to your thumbnail to increase click-through rate."})]})]})}),e.jsx("div",{className:"p-4 border border-green-200 bg-green-50 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(qs,{className:"w-5 h-5 text-green-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-green-900",children:"Add More Tags"}),e.jsx("p",{className:"text-sm text-green-700",children:"Include platform-specific hashtags to improve discoverability."})]})]})})]})})]}),t.targets&&t.targets.length>0&&e.jsxs(S,{children:[e.jsxs(q,{children:[e.jsx(W,{children:"Publishing Status"}),e.jsx(Ge,{children:"Current status for each platform"})]}),e.jsx(T,{children:e.jsx("div",{className:"space-y-4",children:t.targets.map(r=>{const o=$a[r.status],g=Pa[r.platform],k=_e(r);return e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"h-5 w-5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium capitalize",children:r.platform}),r.publish_at&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Scheduled: ",new Date(r.publish_at).toLocaleString()]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(B,{className:Oa[r.status],children:[e.jsx(o,{className:"w-3 h-3 mr-1"}),r.status]}),k&&r.status==="success"&&e.jsx("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700",children:e.jsx(Wt,{className:"w-4 h-4"})}),r.status==="success"&&e.jsxs(J,{size:"sm",variant:"outline",onClick:()=>we(r.id,r.platform),className:"text-red-600 hover:text-red-700",children:[e.jsx(es,{className:"w-3 h-3 mr-1"}),"Remove"]})]})]},r.id)})})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("form",{onSubmit:je,className:"space-y-6",children:[e.jsxs(S,{children:[e.jsx(q,{children:e.jsx(W,{children:"Title"})}),e.jsxs(T,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Is,{value:d.title,onChange:r=>a("title",r.target.value),placeholder:"Enter video title",className:"flex-1"}),e.jsx(J,{type:"button",variant:"outline",size:"sm",onClick:Se,disabled:G,children:G?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full"}):e.jsx(Ee,{className:"w-4 h-4"})})]}),H.title&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:H.title})]})]}),e.jsxs(S,{children:[e.jsx(q,{children:e.jsx(W,{children:"Description"})}),e.jsxs(T,{children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(vt,{value:d.description,onChange:r=>a("description",r.target.value),placeholder:"Enter video description",rows:4}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(J,{type:"button",variant:"outline",size:"sm",onClick:R,disabled:I,children:[I?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(Ee,{className:"w-4 h-4 mr-2"}),"AI Generate"]})})]}),H.description&&e.jsx("p",{className:"text-sm text-red-600",children:H.description})]})]}),e.jsxs(S,{children:[e.jsx(q,{children:e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(qs,{className:"w-5 h-5"}),"Tags"]})}),e.jsx(T,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[d.tags.map((r,o)=>e.jsxs(B,{variant:"secondary",className:"flex items-center gap-1",children:[r,e.jsx("button",{type:"button",onClick:()=>c(r),className:"ml-1 text-xs hover:text-red-600",children:e.jsx(es,{className:"w-3 h-3"})})]},o)),d.tags.length===0&&e.jsx("p",{className:"text-sm text-gray-500",children:"No tags added yet"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Is,{placeholder:"Add a tag...",onKeyDown:r=>{if(r.key==="Enter"){r.preventDefault();const o=r.currentTarget.value.trim();o&&(u(o),r.currentTarget.value="")}},className:"flex-1"}),e.jsxs(J,{type:"button",variant:"outline",onClick:Ce,disabled:l,children:[l?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(os,{className:"w-4 h-4 mr-2"}),"AI Generate"]})]}),d.tags.length>0&&e.jsx("p",{className:"text-xs text-gray-500",children:"Tags help categorize your video and improve discoverability across platforms"})]})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(J,{type:"submit",disabled:M,children:[M?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(xa,{className:"w-4 h-4 mr-2"}),"Save Changes"]})})]}),e.jsxs(S,{children:[e.jsx(q,{children:e.jsx(W,{children:"Video Details"})}),e.jsxs(T,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Duration"}),e.jsx("p",{className:"text-lg",children:t.formatted_duration})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Resolution"}),e.jsx("p",{className:`text-lg ${oe.color}`,children:t.width&&t.height?`${t.width}x${t.height}`:"Unknown"}),e.jsx("p",{className:`text-sm ${oe.color}`,children:oe.label})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Upload Date"}),e.jsx("p",{className:"text-lg",children:new Date(t.created_at).toLocaleString()})]})]})]}),e.jsxs(S,{children:[e.jsxs(q,{children:[e.jsxs(W,{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"w-5 h-5"}),"Thumbnail Optimization"]}),e.jsx(Ge,{children:"Set your video thumbnail using AI optimization or custom upload"})]}),e.jsxs(T,{children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(J,{onClick:()=>A(!0),className:"bg-purple-600 hover:bg-purple-700",children:[e.jsx(os,{className:"w-4 h-4 mr-2"}),"AI Optimize Thumbnail"]}),e.jsxs(J,{variant:"outline",onClick:()=>{var r;return(r=ue.current)==null?void 0:r.click()},disabled:z,children:[z?e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-current border-t-transparent rounded-full mr-2"}):e.jsx(Bt,{className:"w-4 h-4 mr-2"}),z?"Uploading...":"Upload Custom Thumbnail"]}),e.jsx("input",{ref:ue,type:"file",accept:"image/*",onChange:ke,className:"hidden"})]}),X&&e.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-green-700",children:"✓ Thumbnail has been set for this video"})}),t.thumbnail&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-2",children:"Current Thumbnail:"}),e.jsx("img",{src:`${t.thumbnail}`,alt:"Current thumbnail",className:"w-32 h-20 object-cover rounded-lg border"})]})]})]})]})]})}),e.jsx(fe,{value:"performance",className:"space-y-6",children:e.jsx(Qe,{children:e.jsx(Ta,{videoId:t.id})})})]}),e.jsx(Hs,{open:V,onOpenChange:E,children:e.jsxs(Xs,{children:[e.jsxs(Ks,{children:[e.jsx(Js,{children:"Delete Video"}),e.jsx(Gs,{children:"This action cannot be undone. Choose what you want to delete:"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"delete-tikomat",name:"delete-option",value:"tikomat",checked:P==="tikomat",onChange:r=>ee(r.target.value)}),e.jsx(Ds,{htmlFor:"delete-tikomat",children:"Delete only from Tikomat (keep on social platforms)"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",id:"delete-all",name:"delete-option",value:"all",checked:P==="all",onChange:r=>ee(r.target.value)}),e.jsx(Ds,{htmlFor:"delete-all",children:"Delete from everywhere (Tikomat + all social platforms)"})]})]}),e.jsxs(Nt,{children:[e.jsx(J,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),e.jsx(J,{variant:"destructive",onClick:Ne,children:"Delete Video"})]})]})}),e.jsx(Ra,{isOpen:$,onClose:()=>A(!1),videoId:t.id,videoPath:t.original_file_path||t.file_path||"",title:d.title,onThumbnailSet:()=>{i("optimized"),A(!1)}})]})]})}export{Rr as default};
